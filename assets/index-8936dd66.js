import{r as tt,o as x,c as k,a as t,F as Y,b as K,d as U,w as Z,t as f,u as N,e as dt,f as mt,g as nt,n as j,T as pt,h as bt,i as vt,C as ft,A as yt,p as gt,j as ht,k as xt,B as _t,P as kt,L as $t,l as wt,m as T,q as F,s as Q,v as L,x as E,y as ot,z as St,D as Dt,E as Ct,G as Pt,H as rt,I as it,J as V,K as M,M as Tt,N as qt,O as zt,Q as Ft}from"./vendor-fc4b5792.js";(function(){const b=document.createElement("link").relList;if(b&&b.supports&&b.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))y(c);new MutationObserver(c=>{for(const o of c)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&y(d)}).observe(document,{childList:!0,subtree:!0});function w(c){const o={};return c.integrity&&(o.integrity=c.integrity),c.referrerPolicy&&(o.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?o.credentials="include":c.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function y(c){if(c.ep)return;c.ep=!0;const o=w(c);fetch(c.href,o)}})();const et="investment-tracker-stocks",st="investment-tracker-realized";function G(){const p=()=>{try{const r=localStorage.getItem(et);return r?JSON.parse(r):[]}catch(r){return console.error("無法讀取持股資料",r),[]}},b=r=>{try{localStorage.setItem(et,JSON.stringify(r))}catch(n){console.error("無法儲存持股資料",n)}},w=r=>{const n=p();n.push(r),b(n)},y=(r,n)=>{const _=p();_[r]=n,b(_)},c=r=>{const n=p();n.splice(r,1),b(n)},o=()=>{try{const r=localStorage.getItem(st);return r?JSON.parse(r):[]}catch(r){return console.error("無法讀取已實現收益資料",r),[]}},d=r=>{try{localStorage.setItem(st,JSON.stringify(r))}catch(n){console.error("無法儲存已實現收益資料",n)}};return{getStocks:p,setStocks:b,addStock:w,updateStock:y,deleteStock:c,getRealizedTrades:o,setRealizedTrades:d,addRealizedTrade:r=>{const n=o();n.push(r),d(n)},updateRealizedTrade:(r,n)=>{const _=o();_[r]=n,d(_)},deleteRealizedTrade:r=>{const n=o();n.splice(r,1),d(n)}}}const Vt={class:"min-h-screen"},At={class:"bg-primary text-white p-4 shadow-md"},It={class:"container mx-auto flex justify-between items-center"},Rt={class:"flex space-x-2"},Mt={class:"btn bg-secondary text-white text-sm px-3 py-1 cursor-pointer"},Ot={class:"bg-white shadow-sm"},jt={class:"container mx-auto"},Et={class:"flex"},Nt={class:"container mx-auto p-4"},Lt={class:"bg-gray-100 text-gray-600 p-4 text-center text-sm"},Wt={__name:"App",setup(p){const{getStocks:b,getRealizedTrades:w,setStocks:y,setRealizedTrades:c}=G(),o=[{name:"持股管理",path:"/"},{name:"已實現收益",path:"/realized"},{name:"圖表分析",path:"/charts"}],d=()=>{const g=N.book_new(),a=b(),r=w(),n=a.map(S=>({股票代碼:S.symbol,股票名稱:S.name,市場:S.market,成本價:S.cost,數量:S.quantity,購買日期:S.purchaseDate})),_=r.map(S=>({股票代碼:S.symbol,股票名稱:S.name,賣出價格:S.sellPrice,數量:S.quantity,成本:S.cost,實現損益:S.profit,日期:S.date})),A=N.json_to_sheet(n),q=N.json_to_sheet(_);N.book_append_sheet(g,A,"持股紀錄"),N.book_append_sheet(g,q,"已實現收益"),dt(g,"投資損益資料.xlsx")},$=g=>{const a=g.target.files[0];if(!a)return;const r=new FileReader;r.onload=n=>{const _=new Uint8Array(n.target.result),A=mt(_,{type:"array"}),q=A.Sheets.持股紀錄;if(q){const I=N.sheet_to_json(q).map(C=>({symbol:C.股票代碼,name:C.股票名稱,market:C.市場,cost:parseFloat(C.成本價),quantity:parseInt(C.數量),purchaseDate:C.購買日期}));y(I)}const S=A.Sheets.已實現收益;if(S){const I=N.sheet_to_json(S).map(C=>({symbol:C.股票代碼,name:C.股票名稱,sellPrice:parseFloat(C.賣出價格),quantity:parseInt(C.數量),cost:parseFloat(C.成本),profit:parseFloat(C.實現損益),date:C.日期}));c(I)}g.target.value="",alert("資料匯入成功！")},r.readAsArrayBuffer(a)};return(g,a)=>{const r=tt("router-link"),n=tt("router-view");return x(),k("div",Vt,[t("header",At,[t("div",It,[a[3]||(a[3]=t("h1",{class:"text-xl md:text-2xl font-bold"},"投資損益小幫手",-1)),t("div",Rt,[t("button",{onClick:d,class:"btn bg-secondary text-white text-sm px-3 py-1"},a[0]||(a[0]=[t("span",{class:"hidden md:inline"},"匯出資料",-1),t("span",{class:"md:hidden"},"匯出",-1)])),t("label",Mt,[a[1]||(a[1]=t("span",{class:"hidden md:inline"},"匯入資料",-1)),a[2]||(a[2]=t("span",{class:"md:hidden"},"匯入",-1)),t("input",{type:"file",accept:".xlsx",class:"hidden",onChange:$},null,32)])])])]),t("nav",Ot,[t("div",jt,[t("ul",Et,[(x(),k(Y,null,K(o,_=>t("li",{key:_.path},[U(r,{to:_.path,class:j(["block px-4 py-3 hover:bg-gray-100 transition-colors border-b-2",g.$route.path===_.path?"border-primary text-primary font-medium":"border-transparent"])},{default:Z(()=>[nt(f(_.name),1)]),_:2},1032,["to","class"])])),64))])])]),t("main",Nt,[U(n,null,{default:Z(({Component:_})=>[U(pt,{name:"fade",mode:"out-in"},{default:Z(()=>[(x(),bt(vt(_)))]),_:2},1024)]),_:1})]),t("footer",Lt,[t("p",null,"投資損益小幫手 © "+f(new Date().getFullYear()),1)])])}}};const Ut={class:"mb-6"},Bt={class:"flex flex-wrap space-x-2"},Yt=["onClick"],Kt={class:"card"},Ht={key:0,class:"p-4"},Jt={key:0,class:"text-center py-6 text-gray-500"},Gt={key:1,class:"flex flex-col md:flex-row"},Zt={class:"w-full md:w-1/2 min-h-[300px]"},Qt={class:"w-full md:w-1/2 p-4"},Xt={class:"flex-1"},te={class:"text-right"},ee={key:1,class:"p-4"},se={key:0,class:"text-center py-6 text-gray-500"},le={key:1,class:"min-h-[300px]"},ae={key:2,class:"p-4"},ne={key:0,class:"text-center py-6 text-gray-500"},oe={key:1,class:"min-h-[300px]"},re={__name:"ChartsView",setup(p){ft.register(yt,gt,ht,xt,LinearScale,_t,kt,$t,wt);const{getStocks:b,getRealizedTrades:w}=G(),y=T("allocation"),c=T([]),o=T([]),d=T({}),$=[{id:"allocation",name:"持股分配"},{id:"profit",name:"總體損益"},{id:"realized",name:"已實現收益趨勢"}],g=["#4CAF50","#2196F3","#F44336","#FF9800","#9C27B0","#3F51B5","#009688","#795548","#607D8B","#E91E63"],a=F(()=>c.value.length>0),r=F(()=>o.value.length>0),n=F(()=>a.value||r.value),_=F(()=>{if(!a.value)return[];const m=c.value.map(v=>{var D;const e=(((D=d.value[v.symbol])==null?void 0:D.price)||v.cost)*v.quantity;return{...v,marketValue:e}}),h=m.reduce((v,i)=>v+i.marketValue,0);return m.map(v=>({...v,percentage:v.marketValue/h*100})).sort((v,i)=>i.marketValue-v.marketValue)}),A=F(()=>a.value?{labels:_.value.map(m=>m.name),datasets:[{data:_.value.map(m=>m.marketValue),backgroundColor:_.value.map((m,h)=>g[h%g.length]),hoverOffset:4}]}:{datasets:[]}),q=F(()=>{const m=["未實現損益","已實現收益","總體損益"],h=c.value.reduce((D,l)=>{var z;const P=(((z=d.value[l.symbol])==null?void 0:z.price)||l.cost)*l.quantity,u=l.cost*l.quantity;return D+(P-u)},0),v=o.value.reduce((D,l)=>D+l.profit,0),i=h+v,e=[h,v,i];return{labels:m,datasets:[{label:"損益金額",data:e,backgroundColor:e.map(D=>D>=0?"rgba(76, 175, 80, 0.6)":"rgba(244, 67, 54, 0.6)"),borderColor:e.map(D=>D>=0?"rgb(76, 175, 80)":"rgb(244, 67, 54)"),borderWidth:1}]}}),S=F(()=>{if(!r.value)return{datasets:[]};const m=[...o.value].sort((e,D)=>new Date(e.date)-new Date(D.date));let h=0;const v=[],i=[];return m.forEach(e=>{h+=e.profit,v.push(h),i.push(ot(e.date).format("YYYY/MM/DD"))}),{labels:i,datasets:[{label:"累計已實現收益",data:v,borderColor:"rgb(54, 162, 235)",backgroundColor:"rgba(54, 162, 235, 0.5)",tension:.1,pointBackgroundColor:v.map(e=>e>=0?"rgb(76, 175, 80)":"rgb(244, 67, 54)")}]}}),O={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(m){const h=m.label||"",v=m.raw||0,i=v/m.dataset.data.reduce((e,D)=>e+D,0)*100;return`${h}: ${R(v)} (${i.toFixed(2)}%)`}}}}},I={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(m){return`${m.dataset.label}: ${R(m.raw)}`}}}},scales:{y:{beginAtZero:!0,ticks:{callback:function(m){return R(m)}}}}},C={responsive:!0,maintainAspectRatio:!1,plugins:{tooltip:{callbacks:{label:function(m){return`${m.dataset.label}: ${R(m.raw)}`}}}},scales:{y:{ticks:{callback:function(m){return R(m)}}}}},R=m=>new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0,maximumFractionDigits:0}).format(m),W=()=>{c.value=b(),o.value=w();const m={};c.value.forEach(h=>{m[h.symbol]={price:h.cost,change:0,changePercent:0}}),d.value=m;try{const h=localStorage.getItem("investment-tracker-prices");h&&(d.value={...d.value,...JSON.parse(h)})}catch(h){console.error("無法讀取價格資料",h)}};return Q(()=>{W(),window.addEventListener("storage",m=>{(m.key==="investment-tracker-stocks"||m.key==="investment-tracker-realized"||m.key==="investment-tracker-prices")&&W()})}),(m,h)=>(x(),k("div",null,[h[4]||(h[4]=t("h2",{class:"text-xl font-bold mb-4"},"圖表分析",-1)),t("div",Ut,[t("div",Bt,[(x(),k(Y,null,K($,v=>t("button",{key:v.id,onClick:i=>y.value=v.id,class:j(["px-4 py-2 rounded-md transition-colors mb-2",y.value===v.id?"bg-primary text-white":"bg-gray-100 text-gray-700"])},f(v.name),11,Yt)),64))])]),t("div",Kt,[y.value==="allocation"?(x(),k("div",Ht,[h[1]||(h[1]=t("h3",{class:"text-lg font-medium mb-4"},"持股分配",-1)),a.value?(x(),k("div",Gt,[t("div",Zt,[U(L(St),{"chart-data":A.value,"chart-options":O},null,8,["chart-data"])]),t("div",Qt,[h[0]||(h[0]=t("h4",{class:"text-md font-medium mb-2"},"持股比例",-1)),(x(!0),k(Y,null,K(_.value,(v,i)=>(x(),k("div",{key:i,class:"flex items-center mb-2"},[t("div",{class:"w-4 h-4 rounded-full mr-2",style:Dt({backgroundColor:g[i%g.length]})},null,4),t("div",Xt,f(v.name)+" ("+f(v.symbol)+")",1),t("div",te,f(v.percentage.toFixed(2))+"%",1)]))),128))])])):(x(),k("div",Jt," 尚未新增持股資料，請先在持股管理頁面新增股票。 "))])):E("",!0),y.value==="profit"?(x(),k("div",ee,[h[2]||(h[2]=t("h3",{class:"text-lg font-medium mb-4"},"總體損益",-1)),n.value?(x(),k("div",le,[U(L(Ct),{"chart-data":q.value,"chart-options":I},null,8,["chart-data"])])):(x(),k("div",se," 尚未有足夠資料，請先新增持股或已實現收益。 "))])):E("",!0),y.value==="realized"?(x(),k("div",ae,[h[3]||(h[3]=t("h3",{class:"text-lg font-medium mb-4"},"已實現收益分析",-1)),r.value?(x(),k("div",oe,[U(L(Pt),{"chart-data":S.value,"chart-options":C},null,8,["chart-data"])])):(x(),k("div",ne," 尚未新增已實現收益資料，請先在已實現收益頁面新增資料。 "))])):E("",!0)])]))}};async function ie(p){var b,w,y,c;try{const o=new Date().getTime(),d=await fetch(`https://query1.finance.yahoo.com/v8/finance/chart/${p}?interval=1d&t=${o}`,{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36",Accept:"application/json","Cache-Control":"no-cache"},mode:"cors"});if(!d.ok)return console.warn(`API 請求失敗: ${d.status} ${d.statusText}`),J(p);const $=await d.json();if((b=$.chart)!=null&&b.error)return console.error("獲取股票價格出錯",$.chart.error),J(p);if(!((c=(y=(w=$.chart)==null?void 0:w.result)==null?void 0:y[0])!=null&&c.meta))return console.warn("API 返回結構異常",$),J(p);const g=$.chart.result[0];return{price:g.meta.regularMarketPrice,change:g.meta.regularMarketChange,changePercent:g.meta.regularMarketChangePercent,time:new Date(g.meta.regularMarketTime*1e3)}}catch(o){return console.error("獲取股票價格出錯",o),J(p)}}async function ue(p){try{const b=[];for(let y=0;y<p.length;y+=3){const o=p.slice(y,y+3).map($=>ie($)),d=await Promise.allSettled(o);b.push(...d),y+3<p.length&&await new Promise($=>setTimeout($,1e3))}return b.map((y,c)=>y.status==="fulfilled"&&y.value?{symbol:p[c],...y.value}:{symbol:p[c],price:null,error:!0})}catch(b){return console.error("獲取多個股票價格出錯",b),p.map(w=>({symbol:w,price:null,error:!0}))}}function J(p){const b=ce(p)%1e3+100,w=(Math.random()*10-5)/100,y=b*w,c=b+y;return console.log(`使用模擬數據 ${p}: ${c.toFixed(2)}`),{price:c,change:y,changePercent:w,time:new Date,simulated:!0}}function ce(p){let b=0;if(p.length===0)return b;for(let w=0;w<p.length;w++){const y=p.charCodeAt(w);b=(b<<5)-b+y,b=b&b}return Math.abs(b)}function lt(p,b=2){return p==null?"-":p.toFixed(b)}function at(p){return p==null?"":p>0?"positive":p<0?"negative":""}const de={class:"card bg-white p-4 mb-6"},me={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},pe={class:"p-3 bg-gray-50 rounded-lg"},be={class:"text-lg font-semibold"},ve={class:"p-3 bg-gray-50 rounded-lg"},fe={class:"text-lg font-semibold"},ye={class:"p-3 bg-gray-50 rounded-lg"},ge={class:"text-sm"},he={class:"flex justify-between items-center mb-4"},xe={key:0,class:"inline-block animate-spin"},_e={class:"card"},ke={key:0,class:"text-center py-6 text-gray-500"},$e={key:1,class:"table-container"},we={class:"table"},Se={class:"flex space-x-2"},De=["onClick"],Ce=["onClick"],Pe={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10"},Te={class:"bg-white rounded-lg p-6 max-w-md w-full"},qe={class:"text-lg font-bold mb-4"},ze={class:"mb-4"},Fe={class:"mb-4"},Ve={class:"mb-4"},Ae={class:"mb-4"},Ie={class:"mb-4"},Re={class:"mb-4"},Me={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10"},Oe={class:"bg-white rounded-lg p-6 max-w-md w-full"},je={class:"mb-4"},Ee={class:"flex justify-end space-x-3"},Ne={__name:"HomeView",setup(p){const{getStocks:b,addStock:w,updateStock:y,deleteStock:c}=G(),o=T([]),d=T({}),$=T(!1),g=T(null),a=T(null),r=T(!1),n=rt({symbol:"",name:"",market:"台股",cost:0,quantity:0,purchaseDate:new Date().toISOString().split("T")[0]}),_=F(()=>o.value.reduce((l,s)=>l+s.cost*s.quantity,0)),A=F(()=>o.value.reduce((l,s)=>{var u;const P=((u=d.value[s.symbol])==null?void 0:u.price)||0;return l+P*s.quantity},0)),q=F(()=>A.value-_.value),S=F(()=>_.value===0?0:q.value/_.value*100),O=()=>{o.value=b(),o.value.length>0&&I()},I=async()=>{if(o.value.length!==0){r.value=!0;try{const l=o.value.map(u=>u.symbol),s=await ue(l),P={};s.forEach(u=>{P[u.symbol]=u}),d.value=P}catch(l){console.error("更新價格出錯",l)}finally{r.value=!1}}},C=l=>{const s=o.value[l];g.value=l,n.symbol=s.symbol,n.name=s.name,n.market=s.market,n.cost=s.cost,n.quantity=s.quantity,n.purchaseDate=s.purchaseDate||"",$.value=!0},R=l=>{a.value=l},W=()=>{a.value!==null&&(c(a.value),O(),a.value=null)},m=()=>{const l={symbol:n.symbol,name:n.name,market:n.market,cost:n.cost,quantity:n.quantity,purchaseDate:n.purchaseDate};g.value!==null?y(g.value,l):w(l),O(),g.value=null,$.value=!1,v()},h=()=>{$.value=!1,g.value=null,v()},v=()=>{n.symbol="",n.name="",n.market="台股",n.cost=0,n.quantity=0,n.purchaseDate=new Date().toISOString().split("T")[0]},i=l=>new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0,maximumFractionDigits:0}).format(l),e=(l,s)=>{if(!s)return"載入中...";const P=l.cost*l.quantity,z=s*l.quantity-P,H=P>0?z/P*100:0,B=z>=0?"+":"";return`${B}${i(z)} (${B}${H.toFixed(2)}%)`},D=(l,s)=>{if(!s)return"";const P=l.cost*l.quantity,z=s*l.quantity-P;return z>0?"positive":z<0?"negative":""};return Q(()=>{O();const l=setInterval(I,5*60*1e3);return()=>clearInterval(l)}),(l,s)=>{var P;return x(),k("div",null,[s[23]||(s[23]=t("h2",{class:"text-xl font-bold mb-4"},"持股管理",-1)),t("div",de,[t("div",me,[t("div",pe,[s[9]||(s[9]=t("h3",{class:"text-gray-500 text-sm"},"總投資成本",-1)),t("p",be,f(i(_.value)),1)]),t("div",ve,[s[10]||(s[10]=t("h3",{class:"text-gray-500 text-sm"},"目前總市值",-1)),t("p",fe,f(i(A.value)),1)]),t("div",ye,[s[11]||(s[11]=t("h3",{class:"text-gray-500 text-sm"},"未實現損益",-1)),t("p",{class:j(["text-lg font-semibold",L(at)(q.value)])},[nt(f(q.value>0?"+":"")+f(i(q.value))+" ",1),t("span",ge," ("+f(S.value>0?"+":"")+f(S.value.toFixed(2))+"%) ",1)],2)])])]),t("div",he,[t("button",{onClick:s[0]||(s[0]=u=>$.value=!0),class:"btn btn-primary"}," + 新增持股 "),t("button",{onClick:I,class:"btn bg-gray-100 text-gray-700 flex items-center"},[s[12]||(s[12]=t("span",{class:"mr-1"},"更新價格",-1)),r.value?(x(),k("span",xe,"⟳")):E("",!0)])]),t("div",_e,[o.value.length===0?(x(),k("div",ke," 尚未新增持股資料，請點擊「新增持股」按鈕開始追蹤。 ")):(x(),k("div",$e,[t("table",we,[s[13]||(s[13]=t("thead",null,[t("tr",null,[t("th",null,"代碼"),t("th",null,"名稱"),t("th",null,"市場"),t("th",null,"持有股數"),t("th",null,"成本價"),t("th",null,"目前價格"),t("th",null,"市值"),t("th",null,"損益"),t("th",null,"操作")])],-1)),t("tbody",null,[(x(!0),k(Y,null,K(o.value,(u,z)=>{var H,B,X;return x(),k("tr",{key:z},[t("td",null,f(u.symbol),1),t("td",null,f(u.name),1),t("td",null,f(u.market),1),t("td",null,f(u.quantity),1),t("td",null,f(L(lt)(u.cost)),1),t("td",{class:j(L(at)((H=d.value[u.symbol])==null?void 0:H.change))},f(d.value[u.symbol]?L(lt)(d.value[u.symbol].price):"載入中..."),3),t("td",null,f(d.value[u.symbol]?i(u.quantity*d.value[u.symbol].price):"載入中..."),1),t("td",{class:j(D(u,(B=d.value[u.symbol])==null?void 0:B.price))},f(e(u,(X=d.value[u.symbol])==null?void 0:X.price)),3),t("td",null,[t("div",Se,[t("button",{onClick:ct=>C(z),class:"text-primary text-sm"}," 編輯 ",8,De),t("button",{onClick:ct=>R(z),class:"text-danger text-sm"}," 刪除 ",8,Ce)])])])}),128))])])]))]),$.value?(x(),k("div",Pe,[t("div",Te,[t("h3",qe,f(g.value===null?"新增持股":"編輯持股"),1),t("form",{onSubmit:it(m,["prevent"])},[t("div",ze,[s[14]||(s[14]=t("label",{class:"block text-sm font-medium mb-1"},"股票代碼",-1)),V(t("input",{"onUpdate:modelValue":s[1]||(s[1]=u=>n.symbol=u),required:"",class:"input w-full",placeholder:"例如：2330.TW 或 AAPL"},null,512),[[M,n.symbol]])]),t("div",Fe,[s[15]||(s[15]=t("label",{class:"block text-sm font-medium mb-1"},"股票名稱",-1)),V(t("input",{"onUpdate:modelValue":s[2]||(s[2]=u=>n.name=u),required:"",class:"input w-full",placeholder:"例如：台積電 或 蘋果"},null,512),[[M,n.name]])]),t("div",Ve,[s[17]||(s[17]=t("label",{class:"block text-sm font-medium mb-1"},"市場",-1)),V(t("select",{"onUpdate:modelValue":s[3]||(s[3]=u=>n.market=u),required:"",class:"input w-full"},s[16]||(s[16]=[t("option",{value:"台股"},"台股",-1),t("option",{value:"美股"},"美股",-1),t("option",{value:"其他"},"其他",-1)]),512),[[Tt,n.market]])]),t("div",Ae,[s[18]||(s[18]=t("label",{class:"block text-sm font-medium mb-1"},"成本價",-1)),V(t("input",{"onUpdate:modelValue":s[4]||(s[4]=u=>n.cost=u),type:"number",step:"0.01",required:"",class:"input w-full",placeholder:"每股成本"},null,512),[[M,n.cost,void 0,{number:!0}]])]),t("div",Ie,[s[19]||(s[19]=t("label",{class:"block text-sm font-medium mb-1"},"持有股數",-1)),V(t("input",{"onUpdate:modelValue":s[5]||(s[5]=u=>n.quantity=u),type:"number",required:"",class:"input w-full",placeholder:"持有數量"},null,512),[[M,n.quantity,void 0,{number:!0}]])]),t("div",Re,[s[20]||(s[20]=t("label",{class:"block text-sm font-medium mb-1"},"購買日期",-1)),V(t("input",{"onUpdate:modelValue":s[6]||(s[6]=u=>n.purchaseDate=u),type:"date",class:"input w-full"},null,512),[[M,n.purchaseDate]])]),t("div",{class:"flex justify-end space-x-3"},[t("button",{type:"button",onClick:h,class:"btn bg-gray-200 text-gray-800"}," 取消 "),s[21]||(s[21]=t("button",{type:"submit",class:"btn btn-primary"},"儲存",-1))])],32)])])):E("",!0),a.value!==null?(x(),k("div",Me,[t("div",Oe,[s[22]||(s[22]=t("h3",{class:"text-lg font-bold mb-4"},"確認刪除",-1)),t("p",je," 確定要刪除「"+f((P=o.value[a.value])==null?void 0:P.name)+"」的持股資料嗎？ ",1),t("div",Ee,[t("button",{onClick:s[7]||(s[7]=u=>a.value=null),class:"btn bg-gray-200 text-gray-800"}," 取消 "),t("button",{onClick:s[8]||(s[8]=u=>W()),class:"btn btn-danger"}," 確認刪除 ")])])])):E("",!0)])}}},Le={class:"card bg-white p-4 mb-6"},We={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ue={class:"p-3 bg-gray-50 rounded-lg"},Be={class:"p-3 bg-gray-50 rounded-lg"},Ye={class:"text-lg font-semibold"},Ke={class:"flex justify-between items-center mb-4"},He={class:"card"},Je={key:0,class:"text-center py-6 text-gray-500"},Ge={key:1,class:"table-container"},Ze={class:"table"},Qe={class:"flex space-x-2"},Xe=["onClick"],ts=["onClick"],es={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10"},ss={class:"bg-white rounded-lg p-6 max-w-md w-full"},ls={class:"text-lg font-bold mb-4"},as={class:"mb-4"},ns={class:"mb-4"},os={class:"mb-4"},rs={class:"mb-4"},is={class:"mb-4"},us={class:"mb-4"},cs=["value"],ds={class:"mb-4"},ms={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10"},ps={class:"bg-white rounded-lg p-6 max-w-md w-full"},bs={class:"mb-4"},vs={class:"flex justify-end space-x-3"},fs={__name:"RealizedView",setup(p){const{getRealizedTrades:b,addRealizedTrade:w,updateRealizedTrade:y,deleteRealizedTrade:c}=G(),o=T([]),d=T(!1),$=T(null),g=T(null),a=rt({symbol:"",name:"",sellPrice:0,quantity:0,buyPrice:0,date:new Date().toISOString().split("T")[0]}),r=F(()=>o.value.reduce((i,e)=>i+e.profit,0)),n=F(()=>[...o.value].sort((i,e)=>new Date(e.date)-new Date(i.date))),_=()=>{o.value=b()},A=i=>{const e=o.value[i];$.value=i,a.symbol=e.symbol,a.name=e.name,a.sellPrice=e.sellPrice,a.quantity=e.quantity,a.buyPrice=e.cost/e.quantity||0,a.date=e.date,d.value=!0},q=i=>{g.value=i},S=()=>{g.value!==null&&(c(g.value),_(),g.value=null)},O=()=>{const i=v(),D=a.sellPrice*a.quantity-i,l={symbol:a.symbol,name:a.name,sellPrice:a.sellPrice,quantity:a.quantity,cost:i,profit:D,date:a.date};$.value!==null?y($.value,l):w(l),_(),$.value=null,d.value=!1,C()},I=()=>{d.value=!1,$.value=null,C()},C=()=>{a.symbol="",a.name="",a.sellPrice=0,a.quantity=0,a.buyPrice=0,a.date=new Date().toISOString().split("T")[0]},R=i=>new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0,maximumFractionDigits:0}).format(i),W=i=>i.toFixed(2),m=i=>ot(i).format("YYYY/MM/DD"),h=i=>{if(i.cost===0)return"0.00%";const e=i.profit/i.cost*100;return`${e>=0?"+":""}${e.toFixed(2)}%`},v=()=>a.buyPrice*a.quantity;return Q(()=>{_()}),(i,e)=>{var D;return x(),k("div",null,[e[21]||(e[21]=t("h2",{class:"text-xl font-bold mb-4"},"已實現收益",-1)),t("div",Le,[t("div",We,[t("div",Ue,[e[9]||(e[9]=t("h3",{class:"text-gray-500 text-sm"},"總實現收益",-1)),t("p",{class:j(["text-lg font-semibold",r.value>=0?"positive":"negative"])},f(r.value>0?"+":"")+f(R(r.value)),3)]),t("div",Be,[e[10]||(e[10]=t("h3",{class:"text-gray-500 text-sm"},"總交易次數",-1)),t("p",Ye,f(o.value.length)+" 次",1)])])]),t("div",Ke,[t("button",{onClick:e[0]||(e[0]=l=>d.value=!0),class:"btn btn-primary"}," + 新增已實現收益 ")]),t("div",He,[o.value.length===0?(x(),k("div",Je," 尚未新增已實現收益資料，請點擊「新增已實現收益」按鈕進行新增。 ")):(x(),k("div",Ge,[t("table",Ze,[e[11]||(e[11]=t("thead",null,[t("tr",null,[t("th",null,"日期"),t("th",null,"代碼"),t("th",null,"名稱"),t("th",null,"賣出價格"),t("th",null,"數量"),t("th",null,"總成本"),t("th",null,"實現損益"),t("th",null,"報酬率"),t("th",null,"操作")])],-1)),t("tbody",null,[(x(!0),k(Y,null,K(n.value,(l,s)=>(x(),k("tr",{key:s},[t("td",null,f(m(l.date)),1),t("td",null,f(l.symbol),1),t("td",null,f(l.name),1),t("td",null,f(W(l.sellPrice)),1),t("td",null,f(l.quantity),1),t("td",null,f(R(l.cost)),1),t("td",{class:j(l.profit>=0?"positive":"negative")},f(l.profit>0?"+":"")+f(R(l.profit)),3),t("td",{class:j(l.profit>=0?"positive":"negative")},f(h(l)),3),t("td",null,[t("div",Qe,[t("button",{onClick:P=>A(s),class:"text-primary text-sm"}," 編輯 ",8,Xe),t("button",{onClick:P=>q(s),class:"text-danger text-sm"}," 刪除 ",8,ts)])])]))),128))])])]))]),d.value?(x(),k("div",es,[t("div",ss,[t("h3",ls,f($.value===null?"新增已實現收益":"編輯已實現收益"),1),t("form",{onSubmit:it(O,["prevent"])},[t("div",as,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium mb-1"},"股票代碼",-1)),V(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>a.symbol=l),required:"",class:"input w-full",placeholder:"例如：2330.TW 或 AAPL"},null,512),[[M,a.symbol]])]),t("div",ns,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium mb-1"},"股票名稱",-1)),V(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>a.name=l),required:"",class:"input w-full",placeholder:"例如：台積電 或 蘋果"},null,512),[[M,a.name]])]),t("div",os,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium mb-1"},"賣出價格",-1)),V(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>a.sellPrice=l),type:"number",step:"0.01",required:"",class:"input w-full",placeholder:"每股賣出價格"},null,512),[[M,a.sellPrice,void 0,{number:!0}]])]),t("div",rs,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium mb-1"},"數量",-1)),V(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>a.quantity=l),type:"number",required:"",class:"input w-full",placeholder:"賣出數量"},null,512),[[M,a.quantity,void 0,{number:!0}]])]),t("div",is,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium mb-1"},"買入價格",-1)),V(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>a.buyPrice=l),type:"number",step:"0.01",required:"",class:"input w-full",placeholder:"每股買入價格"},null,512),[[M,a.buyPrice,void 0,{number:!0}]])]),t("div",us,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium mb-1"},"總成本",-1)),t("input",{value:v(),type:"number",step:"0.01",disabled:"",class:"input w-full bg-gray-100"},null,8,cs)]),t("div",ds,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium mb-1"},"賣出日期",-1)),V(t("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>a.date=l),type:"date",required:"",class:"input w-full"},null,512),[[M,a.date]])]),t("div",{class:"flex justify-end space-x-3"},[t("button",{type:"button",onClick:I,class:"btn bg-gray-200 text-gray-800"}," 取消 "),e[19]||(e[19]=t("button",{type:"submit",class:"btn btn-primary"},"儲存",-1))])],32)])])):E("",!0),g.value!==null?(x(),k("div",ms,[t("div",ps,[e[20]||(e[20]=t("h3",{class:"text-lg font-bold mb-4"},"確認刪除",-1)),t("p",bs," 確定要刪除「"+f((D=o.value[g.value])==null?void 0:D.name)+"」的已實現收益資料嗎？ ",1),t("div",vs,[t("button",{onClick:e[7]||(e[7]=l=>g.value=null),class:"btn bg-gray-200 text-gray-800"}," 取消 "),t("button",{onClick:e[8]||(e[8]=l=>S()),class:"btn btn-danger"}," 確認刪除 ")])])])):E("",!0)])}}},ys=[{path:"/",component:Ne},{path:"/realized",component:fs},{path:"/charts",component:re}],gs=qt({history:zt(),routes:ys}),ut=Ft(Wt);ut.use(gs);ut.mount("#app");
