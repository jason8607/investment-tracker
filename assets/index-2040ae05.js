import{r as et,o as x,c as _,a as t,F as Y,b as K,d as L,w as Z,t as y,u as j,e as mt,f as pt,g as ot,n as W,T as bt,h as vt,i as ft,C as yt,A as gt,p as ht,j as xt,k as kt,B as _t,P as $t,L as wt,l as St,m as C,q as F,s as X,v as E,x as N,y as rt,z as Dt,D as Tt,E as Pt,G as Ct,H as it,I as ut,J as V,K as M,M as zt,N as qt,O as Ft,Q as Vt}from"./vendor-fc4b5792.js";(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))h(m);new MutationObserver(m=>{for(const o of m)if(o.type==="childList")for(const p of o.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&h(p)}).observe(document,{childList:!0,subtree:!0});function w(m){const o={};return m.integrity&&(o.integrity=m.integrity),m.referrerPolicy&&(o.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?o.credentials="include":m.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function h(m){if(m.ep)return;m.ep=!0;const o=w(m);fetch(m.href,o)}})();const st="investment-tracker-stocks",lt="investment-tracker-realized";function Q(){const i=()=>{try{const r=localStorage.getItem(st);return r?JSON.parse(r):[]}catch(r){return console.error("無法讀取持股資料",r),[]}},d=r=>{try{localStorage.setItem(st,JSON.stringify(r))}catch(a){console.error("無法儲存持股資料",a)}},w=r=>{const a=i();a.push(r),d(a)},h=(r,a)=>{const k=i();k[r]=a,d(k)},m=r=>{const a=i();a.splice(r,1),d(a)},o=()=>{try{const r=localStorage.getItem(lt);return r?JSON.parse(r):[]}catch(r){return console.error("無法讀取已實現收益資料",r),[]}},p=r=>{try{localStorage.setItem(lt,JSON.stringify(r))}catch(a){console.error("無法儲存已實現收益資料",a)}};return{getStocks:i,setStocks:d,addStock:w,updateStock:h,deleteStock:m,getRealizedTrades:o,setRealizedTrades:p,addRealizedTrade:r=>{const a=o();a.push(r),p(a)},updateRealizedTrade:(r,a)=>{const k=o();k[r]=a,p(k)},deleteRealizedTrade:r=>{const a=o();a.splice(r,1),p(a)}}}const At={class:"min-h-screen"},It={class:"bg-primary text-white p-4 shadow-md"},Rt={class:"container mx-auto flex justify-between items-center"},Mt={class:"flex space-x-2"},Ot={class:"btn bg-secondary text-white text-sm px-3 py-1 cursor-pointer"},Wt={class:"bg-white shadow-sm"},Nt={class:"container mx-auto"},jt={class:"flex"},Et={class:"container mx-auto p-4"},Ut={class:"bg-gray-100 text-gray-600 p-4 text-center text-sm"},Lt={__name:"App",setup(i){const{getStocks:d,getRealizedTrades:w,setStocks:h,setRealizedTrades:m}=Q(),o=[{name:"持股管理",path:"/"},{name:"已實現收益",path:"/realized"},{name:"圖表分析",path:"/charts"}],p=()=>{const v=j.book_new(),l=d(),r=w(),a=l.map(S=>({股票代碼:S.symbol,股票名稱:S.name,市場:S.market,成本價:S.cost,數量:S.quantity,購買日期:S.purchaseDate})),k=r.map(S=>({股票代碼:S.symbol,股票名稱:S.name,賣出價格:S.sellPrice,數量:S.quantity,成本:S.cost,實現損益:S.profit,日期:S.date})),A=j.json_to_sheet(a),z=j.json_to_sheet(k);j.book_append_sheet(v,A,"持股紀錄"),j.book_append_sheet(v,z,"已實現收益"),mt(v,"投資損益資料.xlsx")},$=v=>{const l=v.target.files[0];if(!l)return;const r=new FileReader;r.onload=a=>{const k=new Uint8Array(a.target.result),A=pt(k,{type:"array"}),z=A.Sheets.持股紀錄;if(z){const I=j.sheet_to_json(z).map(T=>({symbol:T.股票代碼,name:T.股票名稱,market:T.市場,cost:parseFloat(T.成本價),quantity:parseInt(T.數量),purchaseDate:T.購買日期}));h(I)}const S=A.Sheets.已實現收益;if(S){const I=j.sheet_to_json(S).map(T=>({symbol:T.股票代碼,name:T.股票名稱,sellPrice:parseFloat(T.賣出價格),quantity:parseInt(T.數量),cost:parseFloat(T.成本),profit:parseFloat(T.實現損益),date:T.日期}));m(I)}v.target.value="",alert("資料匯入成功！")},r.readAsArrayBuffer(l)};return(v,l)=>{const r=et("router-link"),a=et("router-view");return x(),_("div",At,[t("header",It,[t("div",Rt,[l[3]||(l[3]=t("h1",{class:"text-xl md:text-2xl font-bold"},"投資損益小幫手",-1)),t("div",Mt,[t("button",{onClick:p,class:"btn bg-secondary text-white text-sm px-3 py-1"},l[0]||(l[0]=[t("span",{class:"hidden md:inline"},"匯出資料",-1),t("span",{class:"md:hidden"},"匯出",-1)])),t("label",Ot,[l[1]||(l[1]=t("span",{class:"hidden md:inline"},"匯入資料",-1)),l[2]||(l[2]=t("span",{class:"md:hidden"},"匯入",-1)),t("input",{type:"file",accept:".xlsx",class:"hidden",onChange:$},null,32)])])])]),t("nav",Wt,[t("div",Nt,[t("ul",jt,[(x(),_(Y,null,K(o,k=>t("li",{key:k.path},[L(r,{to:k.path,class:W(["block px-4 py-3 hover:bg-gray-100 transition-colors border-b-2",v.$route.path===k.path?"border-primary text-primary font-medium":"border-transparent"])},{default:Z(()=>[ot(y(k.name),1)]),_:2},1032,["to","class"])])),64))])])]),t("main",Et,[L(a,null,{default:Z(({Component:k})=>[L(bt,{name:"fade",mode:"out-in"},{default:Z(()=>[(x(),vt(ft(k)))]),_:2},1024)]),_:1})]),t("footer",Ut,[t("p",null,"投資損益小幫手 © "+y(new Date().getFullYear()),1)])])}}};const Bt={class:"mb-6"},Yt={class:"flex flex-wrap space-x-2"},Kt=["onClick"],Ht={class:"card"},Jt={key:0,class:"p-4"},Gt={key:0,class:"text-center py-6 text-gray-500"},Qt={key:1,class:"flex flex-col md:flex-row"},Zt={class:"w-full md:w-1/2 min-h-[300px]"},Xt={class:"w-full md:w-1/2 p-4"},te={class:"flex-1"},ee={class:"text-right"},se={key:1,class:"p-4"},le={key:0,class:"text-center py-6 text-gray-500"},ne={key:1,class:"min-h-[300px]"},ae={key:2,class:"p-4"},oe={key:0,class:"text-center py-6 text-gray-500"},re={key:1,class:"min-h-[300px]"},ie={__name:"ChartsView",setup(i){yt.register(gt,ht,xt,kt,LinearScale,_t,$t,wt,St);const{getStocks:d,getRealizedTrades:w}=Q(),h=C("allocation"),m=C([]),o=C([]),p=C({}),$=[{id:"allocation",name:"持股分配"},{id:"profit",name:"總體損益"},{id:"realized",name:"已實現收益趨勢"}],v=["#4CAF50","#2196F3","#F44336","#FF9800","#9C27B0","#3F51B5","#009688","#795548","#607D8B","#E91E63"],l=F(()=>m.value.length>0),r=F(()=>o.value.length>0),a=F(()=>l.value||r.value),k=F(()=>{if(!l.value)return[];const b=m.value.map(f=>{var D;const e=(((D=p.value[f.symbol])==null?void 0:D.price)||f.cost)*f.quantity;return{...f,marketValue:e}}),g=b.reduce((f,u)=>f+u.marketValue,0);return b.map(f=>({...f,percentage:f.marketValue/g*100})).sort((f,u)=>u.marketValue-f.marketValue)}),A=F(()=>l.value?{labels:k.value.map(b=>b.name),datasets:[{data:k.value.map(b=>b.marketValue),backgroundColor:k.value.map((b,g)=>v[g%v.length]),hoverOffset:4}]}:{datasets:[]}),z=F(()=>{const b=["未實現損益","已實現收益","總體損益"],g=m.value.reduce((D,n)=>{var q;const P=(((q=p.value[n.symbol])==null?void 0:q.price)||n.cost)*n.quantity,c=n.cost*n.quantity;return D+(P-c)},0),f=o.value.reduce((D,n)=>D+n.profit,0),u=g+f,e=[g,f,u];return{labels:b,datasets:[{label:"損益金額",data:e,backgroundColor:e.map(D=>D>=0?"rgba(76, 175, 80, 0.6)":"rgba(244, 67, 54, 0.6)"),borderColor:e.map(D=>D>=0?"rgb(76, 175, 80)":"rgb(244, 67, 54)"),borderWidth:1}]}}),S=F(()=>{if(!r.value)return{datasets:[]};const b=[...o.value].sort((e,D)=>new Date(e.date)-new Date(D.date));let g=0;const f=[],u=[];return b.forEach(e=>{g+=e.profit,f.push(g),u.push(rt(e.date).format("YYYY/MM/DD"))}),{labels:u,datasets:[{label:"累計已實現收益",data:f,borderColor:"rgb(54, 162, 235)",backgroundColor:"rgba(54, 162, 235, 0.5)",tension:.1,pointBackgroundColor:f.map(e=>e>=0?"rgb(76, 175, 80)":"rgb(244, 67, 54)")}]}}),O={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(b){const g=b.label||"",f=b.raw||0,u=f/b.dataset.data.reduce((e,D)=>e+D,0)*100;return`${g}: ${R(f)} (${u.toFixed(2)}%)`}}}}},I={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(b){return`${b.dataset.label}: ${R(b.raw)}`}}}},scales:{y:{beginAtZero:!0,ticks:{callback:function(b){return R(b)}}}}},T={responsive:!0,maintainAspectRatio:!1,plugins:{tooltip:{callbacks:{label:function(b){return`${b.dataset.label}: ${R(b.raw)}`}}}},scales:{y:{ticks:{callback:function(b){return R(b)}}}}},R=b=>new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0,maximumFractionDigits:0}).format(b),U=()=>{m.value=d(),o.value=w();const b={};m.value.forEach(g=>{b[g.symbol]={price:g.cost,change:0,changePercent:0}}),p.value=b;try{const g=localStorage.getItem("investment-tracker-prices");g&&(p.value={...p.value,...JSON.parse(g)})}catch(g){console.error("無法讀取價格資料",g)}};return X(()=>{U(),window.addEventListener("storage",b=>{(b.key==="investment-tracker-stocks"||b.key==="investment-tracker-realized"||b.key==="investment-tracker-prices")&&U()})}),(b,g)=>(x(),_("div",null,[g[4]||(g[4]=t("h2",{class:"text-xl font-bold mb-4"},"圖表分析",-1)),t("div",Bt,[t("div",Yt,[(x(),_(Y,null,K($,f=>t("button",{key:f.id,onClick:u=>h.value=f.id,class:W(["px-4 py-2 rounded-md transition-colors mb-2",h.value===f.id?"bg-primary text-white":"bg-gray-100 text-gray-700"])},y(f.name),11,Kt)),64))])]),t("div",Ht,[h.value==="allocation"?(x(),_("div",Jt,[g[1]||(g[1]=t("h3",{class:"text-lg font-medium mb-4"},"持股分配",-1)),l.value?(x(),_("div",Qt,[t("div",Zt,[L(E(Dt),{"chart-data":A.value,"chart-options":O},null,8,["chart-data"])]),t("div",Xt,[g[0]||(g[0]=t("h4",{class:"text-md font-medium mb-2"},"持股比例",-1)),(x(!0),_(Y,null,K(k.value,(f,u)=>(x(),_("div",{key:u,class:"flex items-center mb-2"},[t("div",{class:"w-4 h-4 rounded-full mr-2",style:Tt({backgroundColor:v[u%v.length]})},null,4),t("div",te,y(f.name)+" ("+y(f.symbol)+")",1),t("div",ee,y(f.percentage.toFixed(2))+"%",1)]))),128))])])):(x(),_("div",Gt," 尚未新增持股資料，請先在持股管理頁面新增股票。 "))])):N("",!0),h.value==="profit"?(x(),_("div",se,[g[2]||(g[2]=t("h3",{class:"text-lg font-medium mb-4"},"總體損益",-1)),a.value?(x(),_("div",ne,[L(E(Pt),{"chart-data":z.value,"chart-options":I},null,8,["chart-data"])])):(x(),_("div",le," 尚未有足夠資料，請先新增持股或已實現收益。 "))])):N("",!0),h.value==="realized"?(x(),_("div",ae,[g[3]||(g[3]=t("h3",{class:"text-lg font-medium mb-4"},"已實現收益分析",-1)),r.value?(x(),_("div",re,[L(E(Ct),{"chart-data":S.value,"chart-options":T},null,8,["chart-data"])])):(x(),_("div",oe," 尚未新增已實現收益資料，請先在已實現收益頁面新增資料。 "))])):N("",!0)])]))}};function G(i){return i?i.includes(".")?i:/^\d+$/.test(i)?`${i}.TW`:i:""}async function ue(i){var d,w,h,m;try{const o=G(i),p=new Date().getTime(),$=await fetch(`https://query1.finance.yahoo.com/v8/finance/chart/${o}?interval=1d&t=${p}`,{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36",Accept:"application/json","Cache-Control":"no-cache"},mode:"cors"});if(!$.ok)return console.warn(`API 請求失敗 (${o}): ${$.status} ${$.statusText}`),J(o);const v=await $.json();if((d=v.chart)!=null&&d.error)return console.error(`獲取股票價格出錯 (${o})`,v.chart.error),J(o);if(!((m=(h=(w=v.chart)==null?void 0:w.result)==null?void 0:h[0])!=null&&m.meta))return console.warn(`API 返回結構異常 (${o})`,v),J(o);const l=v.chart.result[0],r=l.meta.regularMarketPrice,a=l.meta.currency||(o.endsWith(".TW")?"TWD":"USD");return{symbol:o,price:r,change:l.meta.regularMarketChange,changePercent:l.meta.regularMarketChangePercent,time:new Date(l.meta.regularMarketTime*1e3),currency:a,exchangeName:l.meta.exchangeName||""}}catch(o){return console.error(`獲取股票價格出錯 (${i})`,o),J(G(i))}}async function ce(i){try{const d=[];for(let h=0;h<i.length;h+=3){const o=i.slice(h,h+3).map($=>ue($)),p=await Promise.allSettled(o);d.push(...p),h+3<i.length&&await new Promise($=>setTimeout($,1e3))}return d.map((h,m)=>h.status==="fulfilled"&&h.value?{originalSymbol:i[m],...h.value}:{originalSymbol:i[m],symbol:G(i[m]),price:null,error:!0})}catch(d){return console.error("獲取多個股票價格出錯",d),i.map(w=>({originalSymbol:w,symbol:G(w),price:null,error:!0}))}}function J(i){const d=i.endsWith(".TW"),w=d?50:100,m=(d?500:1e3)-w,o=de(i)%m+w,p=(Math.random()*10-5)/100,$=o*p,v=o+$,l=d?"TWD":"USD",r=d?"TWSE":"NASDAQ";return console.log(`使用模擬數據 ${i}: ${v.toFixed(2)} ${l}`),{symbol:i,price:v,change:$,changePercent:p,time:new Date,currency:l,exchangeName:r,simulated:!0}}function de(i){let d=0;if(i.length===0)return d;for(let w=0;w<i.length;w++){const h=i.charCodeAt(w);d=(d<<5)-d+h,d=d&d}return Math.abs(d)}function nt(i,d,w=2){return i==null?"-":`${d==="TWD"?"NT$":"$"}${i.toFixed(w)}`}function at(i){return i==null?"":i>0?"positive":i<0?"negative":""}const me={class:"card bg-white p-4 mb-6"},pe={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},be={class:"p-3 bg-gray-50 rounded-lg"},ve={class:"text-lg font-semibold"},fe={class:"p-3 bg-gray-50 rounded-lg"},ye={class:"text-lg font-semibold"},ge={class:"p-3 bg-gray-50 rounded-lg"},he={class:"text-sm"},xe={class:"flex justify-between items-center mb-4"},ke={key:0,class:"inline-block animate-spin"},_e={class:"card"},$e={key:0,class:"text-center py-6 text-gray-500"},we={key:1,class:"table-container"},Se={class:"table"},De={class:"flex space-x-2"},Te=["onClick"],Pe=["onClick"],Ce={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10"},ze={class:"bg-white rounded-lg p-6 max-w-md w-full"},qe={class:"text-lg font-bold mb-4"},Fe={class:"mb-4"},Ve={class:"mb-4"},Ae={class:"mb-4"},Ie={class:"mb-4"},Re={class:"mb-4"},Me={class:"mb-4"},Oe={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10"},We={class:"bg-white rounded-lg p-6 max-w-md w-full"},Ne={class:"mb-4"},je={class:"flex justify-end space-x-3"},Ee={__name:"HomeView",setup(i){const{getStocks:d,addStock:w,updateStock:h,deleteStock:m}=Q(),o=C([]),p=C({}),$=C(!1),v=C(null),l=C(null),r=C(!1),a=it({symbol:"",name:"",market:"台股",cost:0,quantity:0,purchaseDate:new Date().toISOString().split("T")[0]}),k=F(()=>o.value.reduce((n,s)=>n+s.cost*s.quantity,0)),A=F(()=>o.value.reduce((n,s)=>{var c;const P=((c=p.value[s.symbol])==null?void 0:c.price)||0;return n+P*s.quantity},0)),z=F(()=>A.value-k.value),S=F(()=>k.value===0?0:z.value/k.value*100),O=()=>{o.value=d(),o.value.length>0&&I()},I=async()=>{if(o.value.length!==0){r.value=!0;try{const n=o.value.map(c=>c.symbol),s=await ce(n),P={};s.forEach(c=>{P[c.symbol]=c}),p.value=P}catch(n){console.error("更新價格出錯",n)}finally{r.value=!1}}},T=n=>{const s=o.value[n];v.value=n,a.symbol=s.symbol,a.name=s.name,a.market=s.market,a.cost=s.cost,a.quantity=s.quantity,a.purchaseDate=s.purchaseDate||"",$.value=!0},R=n=>{l.value=n},U=()=>{l.value!==null&&(m(l.value),O(),l.value=null)},b=()=>{const n={symbol:a.symbol,name:a.name,market:a.market,cost:a.cost,quantity:a.quantity,purchaseDate:a.purchaseDate};v.value!==null?h(v.value,n):w(n),O(),v.value=null,$.value=!1,f()},g=()=>{$.value=!1,v.value=null,f()},f=()=>{a.symbol="",a.name="",a.market="台股",a.cost=0,a.quantity=0,a.purchaseDate=new Date().toISOString().split("T")[0]},u=n=>new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),e=(n,s)=>{if(!s)return"載入中...";const P=n.cost*n.quantity,q=s*n.quantity-P,H=P>0?q/P*100:0,B=q>=0?"+":"";return`${B}${u(q)} (${B}${H.toFixed(2)}%)`},D=(n,s)=>{if(!s)return"";const P=n.cost*n.quantity,q=s*n.quantity-P;return q>0?"positive":q<0?"negative":""};return X(()=>{O();const n=setInterval(I,5*60*1e3);return()=>clearInterval(n)}),(n,s)=>{var P;return x(),_("div",null,[s[23]||(s[23]=t("h2",{class:"text-xl font-bold mb-4"},"持股管理",-1)),t("div",me,[t("div",pe,[t("div",be,[s[9]||(s[9]=t("h3",{class:"text-gray-500 text-sm"},"總投資成本",-1)),t("p",ve,y(u(k.value)),1)]),t("div",fe,[s[10]||(s[10]=t("h3",{class:"text-gray-500 text-sm"},"目前總市值",-1)),t("p",ye,y(u(A.value)),1)]),t("div",ge,[s[11]||(s[11]=t("h3",{class:"text-gray-500 text-sm"},"未實現損益",-1)),t("p",{class:W(["text-lg font-semibold",E(at)(z.value)])},[ot(y(z.value>0?"+":"")+y(u(z.value))+" ",1),t("span",he," ("+y(S.value>0?"+":"")+y(S.value.toFixed(2))+"%) ",1)],2)])])]),t("div",xe,[t("button",{onClick:s[0]||(s[0]=c=>$.value=!0),class:"btn btn-primary"}," + 新增持股 "),t("button",{onClick:I,class:"btn bg-gray-100 text-gray-700 flex items-center"},[s[12]||(s[12]=t("span",{class:"mr-1"},"更新價格",-1)),r.value?(x(),_("span",ke,"⟳")):N("",!0)])]),t("div",_e,[o.value.length===0?(x(),_("div",$e," 尚未新增持股資料，請點擊「新增持股」按鈕開始追蹤。 ")):(x(),_("div",we,[t("table",Se,[s[13]||(s[13]=t("thead",null,[t("tr",null,[t("th",null,"代碼"),t("th",null,"名稱"),t("th",null,"市場"),t("th",null,"持有股數"),t("th",null,"成本價"),t("th",null,"目前價格"),t("th",null,"市值"),t("th",null,"損益"),t("th",null,"操作")])],-1)),t("tbody",null,[(x(!0),_(Y,null,K(o.value,(c,q)=>{var H,B,tt;return x(),_("tr",{key:q},[t("td",null,y(c.symbol),1),t("td",null,y(c.name),1),t("td",null,y(c.market),1),t("td",null,y(c.quantity),1),t("td",null,y(E(nt)(c.cost)),1),t("td",{class:W(E(at)((H=p.value[c.symbol])==null?void 0:H.change))},y(p.value[c.symbol]?E(nt)(p.value[c.symbol].price):"載入中..."),3),t("td",null,y(p.value[c.symbol]?u(c.quantity*p.value[c.symbol].price):"載入中..."),1),t("td",{class:W(D(c,(B=p.value[c.symbol])==null?void 0:B.price))},y(e(c,(tt=p.value[c.symbol])==null?void 0:tt.price)),3),t("td",null,[t("div",De,[t("button",{onClick:dt=>T(q),class:"text-primary text-sm"}," 編輯 ",8,Te),t("button",{onClick:dt=>R(q),class:"text-danger text-sm"}," 刪除 ",8,Pe)])])])}),128))])])]))]),$.value?(x(),_("div",Ce,[t("div",ze,[t("h3",qe,y(v.value===null?"新增持股":"編輯持股"),1),t("form",{onSubmit:ut(b,["prevent"])},[t("div",Fe,[s[14]||(s[14]=t("label",{class:"block text-sm font-medium mb-1"},"股票代碼",-1)),V(t("input",{"onUpdate:modelValue":s[1]||(s[1]=c=>a.symbol=c),required:"",class:"input w-full",placeholder:"例如：2330.TW 或 AAPL"},null,512),[[M,a.symbol]])]),t("div",Ve,[s[15]||(s[15]=t("label",{class:"block text-sm font-medium mb-1"},"股票名稱",-1)),V(t("input",{"onUpdate:modelValue":s[2]||(s[2]=c=>a.name=c),required:"",class:"input w-full",placeholder:"例如：台積電 或 蘋果"},null,512),[[M,a.name]])]),t("div",Ae,[s[17]||(s[17]=t("label",{class:"block text-sm font-medium mb-1"},"市場",-1)),V(t("select",{"onUpdate:modelValue":s[3]||(s[3]=c=>a.market=c),required:"",class:"input w-full"},s[16]||(s[16]=[t("option",{value:"台股"},"台股",-1),t("option",{value:"美股"},"美股",-1),t("option",{value:"其他"},"其他",-1)]),512),[[zt,a.market]])]),t("div",Ie,[s[18]||(s[18]=t("label",{class:"block text-sm font-medium mb-1"},"成本價",-1)),V(t("input",{"onUpdate:modelValue":s[4]||(s[4]=c=>a.cost=c),type:"number",step:"0.01",required:"",class:"input w-full",placeholder:"每股成本"},null,512),[[M,a.cost,void 0,{number:!0}]])]),t("div",Re,[s[19]||(s[19]=t("label",{class:"block text-sm font-medium mb-1"},"持有股數",-1)),V(t("input",{"onUpdate:modelValue":s[5]||(s[5]=c=>a.quantity=c),type:"number",required:"",class:"input w-full",placeholder:"持有數量"},null,512),[[M,a.quantity,void 0,{number:!0}]])]),t("div",Me,[s[20]||(s[20]=t("label",{class:"block text-sm font-medium mb-1"},"購買日期",-1)),V(t("input",{"onUpdate:modelValue":s[6]||(s[6]=c=>a.purchaseDate=c),type:"date",class:"input w-full"},null,512),[[M,a.purchaseDate]])]),t("div",{class:"flex justify-end space-x-3"},[t("button",{type:"button",onClick:g,class:"btn bg-gray-200 text-gray-800"}," 取消 "),s[21]||(s[21]=t("button",{type:"submit",class:"btn btn-primary"},"儲存",-1))])],32)])])):N("",!0),l.value!==null?(x(),_("div",Oe,[t("div",We,[s[22]||(s[22]=t("h3",{class:"text-lg font-bold mb-4"},"確認刪除",-1)),t("p",Ne," 確定要刪除「"+y((P=o.value[l.value])==null?void 0:P.name)+"」的持股資料嗎？ ",1),t("div",je,[t("button",{onClick:s[7]||(s[7]=c=>l.value=null),class:"btn bg-gray-200 text-gray-800"}," 取消 "),t("button",{onClick:s[8]||(s[8]=c=>U()),class:"btn btn-danger"}," 確認刪除 ")])])])):N("",!0)])}}},Ue={class:"card bg-white p-4 mb-6"},Le={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Be={class:"p-3 bg-gray-50 rounded-lg"},Ye={class:"p-3 bg-gray-50 rounded-lg"},Ke={class:"text-lg font-semibold"},He={class:"flex justify-between items-center mb-4"},Je={class:"card"},Ge={key:0,class:"text-center py-6 text-gray-500"},Qe={key:1,class:"table-container"},Ze={class:"table"},Xe={class:"flex space-x-2"},ts=["onClick"],es=["onClick"],ss={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10"},ls={class:"bg-white rounded-lg p-6 max-w-md w-full"},ns={class:"text-lg font-bold mb-4"},as={class:"mb-4"},os={class:"mb-4"},rs={class:"mb-4"},is={class:"mb-4"},us={class:"mb-4"},cs={class:"mb-4"},ds=["value"],ms={class:"mb-4"},ps={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10"},bs={class:"bg-white rounded-lg p-6 max-w-md w-full"},vs={class:"mb-4"},fs={class:"flex justify-end space-x-3"},ys={__name:"RealizedView",setup(i){const{getRealizedTrades:d,addRealizedTrade:w,updateRealizedTrade:h,deleteRealizedTrade:m}=Q(),o=C([]),p=C(!1),$=C(null),v=C(null),l=it({symbol:"",name:"",sellPrice:0,quantity:0,buyPrice:0,date:new Date().toISOString().split("T")[0]}),r=F(()=>o.value.reduce((u,e)=>u+e.profit,0)),a=F(()=>[...o.value].sort((u,e)=>new Date(e.date)-new Date(u.date))),k=()=>{o.value=d()},A=u=>{const e=o.value[u];$.value=u,l.symbol=e.symbol,l.name=e.name,l.sellPrice=e.sellPrice,l.quantity=e.quantity,l.buyPrice=e.cost/e.quantity||0,l.date=e.date,p.value=!0},z=u=>{v.value=u},S=()=>{v.value!==null&&(m(v.value),k(),v.value=null)},O=()=>{const u=f(),D=l.sellPrice*l.quantity-u,n={symbol:l.symbol,name:l.name,sellPrice:l.sellPrice,quantity:l.quantity,cost:u,profit:D,date:l.date};$.value!==null?h($.value,n):w(n),k(),$.value=null,p.value=!1,T()},I=()=>{p.value=!1,$.value=null,T()},T=()=>{l.symbol="",l.name="",l.sellPrice=0,l.quantity=0,l.buyPrice=0,l.date=new Date().toISOString().split("T")[0]},R=u=>new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0,maximumFractionDigits:0}).format(u),U=u=>u.toFixed(2),b=u=>rt(u).format("YYYY/MM/DD"),g=u=>{if(u.cost===0)return"0.00%";const e=u.profit/u.cost*100;return`${e>=0?"+":""}${e.toFixed(2)}%`},f=()=>l.buyPrice*l.quantity;return X(()=>{k()}),(u,e)=>{var D;return x(),_("div",null,[e[21]||(e[21]=t("h2",{class:"text-xl font-bold mb-4"},"已實現收益",-1)),t("div",Ue,[t("div",Le,[t("div",Be,[e[9]||(e[9]=t("h3",{class:"text-gray-500 text-sm"},"總實現收益",-1)),t("p",{class:W(["text-lg font-semibold",r.value>=0?"positive":"negative"])},y(r.value>0?"+":"")+y(R(r.value)),3)]),t("div",Ye,[e[10]||(e[10]=t("h3",{class:"text-gray-500 text-sm"},"總交易次數",-1)),t("p",Ke,y(o.value.length)+" 次",1)])])]),t("div",He,[t("button",{onClick:e[0]||(e[0]=n=>p.value=!0),class:"btn btn-primary"}," + 新增已實現收益 ")]),t("div",Je,[o.value.length===0?(x(),_("div",Ge," 尚未新增已實現收益資料，請點擊「新增已實現收益」按鈕進行新增。 ")):(x(),_("div",Qe,[t("table",Ze,[e[11]||(e[11]=t("thead",null,[t("tr",null,[t("th",null,"日期"),t("th",null,"代碼"),t("th",null,"名稱"),t("th",null,"賣出價格"),t("th",null,"數量"),t("th",null,"總成本"),t("th",null,"實現損益"),t("th",null,"報酬率"),t("th",null,"操作")])],-1)),t("tbody",null,[(x(!0),_(Y,null,K(a.value,(n,s)=>(x(),_("tr",{key:s},[t("td",null,y(b(n.date)),1),t("td",null,y(n.symbol),1),t("td",null,y(n.name),1),t("td",null,y(U(n.sellPrice)),1),t("td",null,y(n.quantity),1),t("td",null,y(R(n.cost)),1),t("td",{class:W(n.profit>=0?"positive":"negative")},y(n.profit>0?"+":"")+y(R(n.profit)),3),t("td",{class:W(n.profit>=0?"positive":"negative")},y(g(n)),3),t("td",null,[t("div",Xe,[t("button",{onClick:P=>A(s),class:"text-primary text-sm"}," 編輯 ",8,ts),t("button",{onClick:P=>z(s),class:"text-danger text-sm"}," 刪除 ",8,es)])])]))),128))])])]))]),p.value?(x(),_("div",ss,[t("div",ls,[t("h3",ns,y($.value===null?"新增已實現收益":"編輯已實現收益"),1),t("form",{onSubmit:ut(O,["prevent"])},[t("div",as,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium mb-1"},"股票代碼",-1)),V(t("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>l.symbol=n),required:"",class:"input w-full",placeholder:"例如：2330.TW 或 AAPL"},null,512),[[M,l.symbol]])]),t("div",os,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium mb-1"},"股票名稱",-1)),V(t("input",{"onUpdate:modelValue":e[2]||(e[2]=n=>l.name=n),required:"",class:"input w-full",placeholder:"例如：台積電 或 蘋果"},null,512),[[M,l.name]])]),t("div",rs,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium mb-1"},"賣出價格",-1)),V(t("input",{"onUpdate:modelValue":e[3]||(e[3]=n=>l.sellPrice=n),type:"number",step:"0.01",required:"",class:"input w-full",placeholder:"每股賣出價格"},null,512),[[M,l.sellPrice,void 0,{number:!0}]])]),t("div",is,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium mb-1"},"數量",-1)),V(t("input",{"onUpdate:modelValue":e[4]||(e[4]=n=>l.quantity=n),type:"number",required:"",class:"input w-full",placeholder:"賣出數量"},null,512),[[M,l.quantity,void 0,{number:!0}]])]),t("div",us,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium mb-1"},"買入價格",-1)),V(t("input",{"onUpdate:modelValue":e[5]||(e[5]=n=>l.buyPrice=n),type:"number",step:"0.01",required:"",class:"input w-full",placeholder:"每股買入價格"},null,512),[[M,l.buyPrice,void 0,{number:!0}]])]),t("div",cs,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium mb-1"},"總成本",-1)),t("input",{value:f(),type:"number",step:"0.01",disabled:"",class:"input w-full bg-gray-100"},null,8,ds)]),t("div",ms,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium mb-1"},"賣出日期",-1)),V(t("input",{"onUpdate:modelValue":e[6]||(e[6]=n=>l.date=n),type:"date",required:"",class:"input w-full"},null,512),[[M,l.date]])]),t("div",{class:"flex justify-end space-x-3"},[t("button",{type:"button",onClick:I,class:"btn bg-gray-200 text-gray-800"}," 取消 "),e[19]||(e[19]=t("button",{type:"submit",class:"btn btn-primary"},"儲存",-1))])],32)])])):N("",!0),v.value!==null?(x(),_("div",ps,[t("div",bs,[e[20]||(e[20]=t("h3",{class:"text-lg font-bold mb-4"},"確認刪除",-1)),t("p",vs," 確定要刪除「"+y((D=o.value[v.value])==null?void 0:D.name)+"」的已實現收益資料嗎？ ",1),t("div",fs,[t("button",{onClick:e[7]||(e[7]=n=>v.value=null),class:"btn bg-gray-200 text-gray-800"}," 取消 "),t("button",{onClick:e[8]||(e[8]=n=>S()),class:"btn btn-danger"}," 確認刪除 ")])])])):N("",!0)])}}},gs=[{path:"/",component:Ee},{path:"/realized",component:ys},{path:"/charts",component:ie}],hs=qt({history:Ft(),routes:gs}),ct=Vt(Lt);ct.use(hs);ct.mount("#app");
