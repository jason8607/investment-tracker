import{r as X,o as y,c as g,a as t,F as Y,b as J,d as B,w as Z,t as m,u as N,e as ct,f as dt,g as at,n as M,T as mt,h as pt,i as bt,C as vt,A as yt,p as ft,j as gt,k as ht,B as xt,P as _t,L as kt,l as $t,m as q,q as F,s as G,v as L,x as E,y as nt,z as wt,D as St,E as Dt,G as Ct,H as ot,I as rt,J as V,K as A,M as Pt,N as qt,O as Tt,Q as zt}from"./vendor-fc4b5792.js";(function(){const k=document.createElement("link").relList;if(k&&k.supports&&k.supports("modulepreload"))return;for(const b of document.querySelectorAll('link[rel="modulepreload"]'))x(b);new MutationObserver(b=>{for(const i of b)if(i.type==="childList")for(const v of i.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&x(v)}).observe(document,{childList:!0,subtree:!0});function D(b){const i={};return b.integrity&&(i.integrity=b.integrity),b.referrerPolicy&&(i.referrerPolicy=b.referrerPolicy),b.crossOrigin==="use-credentials"?i.credentials="include":b.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function x(b){if(b.ep)return;b.ep=!0;const i=D(b);fetch(b.href,i)}})();const tt="investment-tracker-stocks",et="investment-tracker-realized";function H(){const _=()=>{try{const o=localStorage.getItem(tt);return o?JSON.parse(o):[]}catch(o){return console.error("無法讀取持股資料",o),[]}},k=o=>{try{localStorage.setItem(tt,JSON.stringify(o))}catch(n){console.error("無法儲存持股資料",n)}},D=o=>{const n=_();n.push(o),k(n)},x=(o,n)=>{const f=_();f[o]=n,k(f)},b=o=>{const n=_();n.splice(o,1),k(n)},i=()=>{try{const o=localStorage.getItem(et);return o?JSON.parse(o):[]}catch(o){return console.error("無法讀取已實現收益資料",o),[]}},v=o=>{try{localStorage.setItem(et,JSON.stringify(o))}catch(n){console.error("無法儲存已實現收益資料",n)}};return{getStocks:_,setStocks:k,addStock:D,updateStock:x,deleteStock:b,getRealizedTrades:i,setRealizedTrades:v,addRealizedTrade:o=>{const n=i();n.push(o),v(n)},updateRealizedTrade:(o,n)=>{const f=i();f[o]=n,v(f)},deleteRealizedTrade:o=>{const n=i();n.splice(o,1),v(n)}}}const Ft={class:"min-h-screen"},Vt={class:"bg-primary text-white p-4 shadow-md"},It={class:"container mx-auto flex justify-between items-center"},Ot={class:"flex space-x-2"},Rt={class:"btn bg-secondary text-white text-sm px-3 py-1 cursor-pointer"},At={class:"bg-white shadow-sm"},jt={class:"container mx-auto"},Mt={class:"flex"},Et={class:"container mx-auto p-4"},Nt={class:"bg-gray-100 text-gray-600 p-4 text-center text-sm"},Lt={__name:"App",setup(_){const{getStocks:k,getRealizedTrades:D,setStocks:x,setRealizedTrades:b}=H(),i=[{name:"持股管理",path:"/"},{name:"已實現收益",path:"/realized"},{name:"圖表分析",path:"/charts"}],v=()=>{const h=N.book_new(),a=k(),o=D(),n=a.map($=>({股票代碼:$.symbol,股票名稱:$.name,市場:$.market,成本價:$.cost,數量:$.quantity,購買日期:$.purchaseDate})),f=o.map($=>({股票代碼:$.symbol,股票名稱:$.name,賣出價格:$.sellPrice,數量:$.quantity,成本:$.cost,實現損益:$.profit,日期:$.date})),I=N.json_to_sheet(n),T=N.json_to_sheet(f);N.book_append_sheet(h,I,"持股紀錄"),N.book_append_sheet(h,T,"已實現收益"),ct(h,"投資損益資料.xlsx")},C=h=>{const a=h.target.files[0];if(!a)return;const o=new FileReader;o.onload=n=>{const f=new Uint8Array(n.target.result),I=dt(f,{type:"array"}),T=I.Sheets.持股紀錄;if(T){const O=N.sheet_to_json(T).map(S=>({symbol:S.股票代碼,name:S.股票名稱,market:S.市場,cost:parseFloat(S.成本價),quantity:parseInt(S.數量),purchaseDate:S.購買日期}));x(O)}const $=I.Sheets.已實現收益;if($){const O=N.sheet_to_json($).map(S=>({symbol:S.股票代碼,name:S.股票名稱,sellPrice:parseFloat(S.賣出價格),quantity:parseInt(S.數量),cost:parseFloat(S.成本),profit:parseFloat(S.實現損益),date:S.日期}));b(O)}h.target.value="",alert("資料匯入成功！")},o.readAsArrayBuffer(a)};return(h,a)=>{const o=X("router-link"),n=X("router-view");return y(),g("div",Ft,[t("header",Vt,[t("div",It,[a[3]||(a[3]=t("h1",{class:"text-xl md:text-2xl font-bold"},"投資損益小幫手",-1)),t("div",Ot,[t("button",{onClick:v,class:"btn bg-secondary text-white text-sm px-3 py-1"},a[0]||(a[0]=[t("span",{class:"hidden md:inline"},"匯出資料",-1),t("span",{class:"md:hidden"},"匯出",-1)])),t("label",Rt,[a[1]||(a[1]=t("span",{class:"hidden md:inline"},"匯入資料",-1)),a[2]||(a[2]=t("span",{class:"md:hidden"},"匯入",-1)),t("input",{type:"file",accept:".xlsx",class:"hidden",onChange:C},null,32)])])])]),t("nav",At,[t("div",jt,[t("ul",Mt,[(y(),g(Y,null,J(i,f=>t("li",{key:f.path},[B(o,{to:f.path,class:M(["block px-4 py-3 hover:bg-gray-100 transition-colors border-b-2",h.$route.path===f.path?"border-primary text-primary font-medium":"border-transparent"])},{default:Z(()=>[at(m(f.name),1)]),_:2},1032,["to","class"])])),64))])])]),t("main",Et,[B(n,null,{default:Z(({Component:f})=>[B(mt,{name:"fade",mode:"out-in"},{default:Z(()=>[(y(),pt(bt(f)))]),_:2},1024)]),_:1})]),t("footer",Nt,[t("p",null,"投資損益小幫手 © "+m(new Date().getFullYear()),1)])])}}};const Ut={class:"mb-6"},Bt={class:"flex flex-wrap space-x-2"},Wt=["onClick"],Yt={class:"card"},Jt={key:0,class:"p-4"},Kt={key:0,class:"text-center py-6 text-gray-500"},Ht={key:1,class:"flex flex-col md:flex-row"},Zt={class:"w-full md:w-1/2 min-h-[300px]"},Gt={class:"w-full md:w-1/2 p-4"},Qt={class:"flex-1"},Xt={class:"text-right"},te={key:1,class:"p-4"},ee={key:0,class:"text-center py-6 text-gray-500"},se={key:1,class:"min-h-[300px]"},le={key:2,class:"p-4"},ae={key:0,class:"text-center py-6 text-gray-500"},ne={key:1,class:"min-h-[300px]"},oe={__name:"ChartsView",setup(_){vt.register(yt,ft,gt,ht,LinearScale,xt,_t,kt,$t);const{getStocks:k,getRealizedTrades:D}=H(),x=q("allocation"),b=q([]),i=q([]),v=q({}),C=[{id:"allocation",name:"持股分配"},{id:"profit",name:"總體損益"},{id:"realized",name:"已實現收益趨勢"}],h=["#4CAF50","#2196F3","#F44336","#FF9800","#9C27B0","#3F51B5","#009688","#795548","#607D8B","#E91E63"],a=F(()=>b.value.length>0),o=F(()=>i.value.length>0),n=F(()=>a.value||o.value),f=F(()=>{if(!a.value)return[];const c=b.value.map(d=>{var w;const e=(((w=v.value[d.symbol])==null?void 0:w.price)||d.cost)*d.quantity;return{...d,marketValue:e}}),p=c.reduce((d,r)=>d+r.marketValue,0);return c.map(d=>({...d,percentage:d.marketValue/p*100})).sort((d,r)=>r.marketValue-d.marketValue)}),I=F(()=>a.value?{labels:f.value.map(c=>c.name),datasets:[{data:f.value.map(c=>c.marketValue),backgroundColor:f.value.map((c,p)=>h[p%h.length]),hoverOffset:4}]}:{datasets:[]}),T=F(()=>{const c=["未實現損益","已實現收益","總體損益"],p=b.value.reduce((w,l)=>{var z;const P=(((z=v.value[l.symbol])==null?void 0:z.price)||l.cost)*l.quantity,u=l.cost*l.quantity;return w+(P-u)},0),d=i.value.reduce((w,l)=>w+l.profit,0),r=p+d,e=[p,d,r];return{labels:c,datasets:[{label:"損益金額",data:e,backgroundColor:e.map(w=>w>=0?"rgba(76, 175, 80, 0.6)":"rgba(244, 67, 54, 0.6)"),borderColor:e.map(w=>w>=0?"rgb(76, 175, 80)":"rgb(244, 67, 54)"),borderWidth:1}]}}),$=F(()=>{if(!o.value)return{datasets:[]};const c=[...i.value].sort((e,w)=>new Date(e.date)-new Date(w.date));let p=0;const d=[],r=[];return c.forEach(e=>{p+=e.profit,d.push(p),r.push(nt(e.date).format("YYYY/MM/DD"))}),{labels:r,datasets:[{label:"累計已實現收益",data:d,borderColor:"rgb(54, 162, 235)",backgroundColor:"rgba(54, 162, 235, 0.5)",tension:.1,pointBackgroundColor:d.map(e=>e>=0?"rgb(76, 175, 80)":"rgb(244, 67, 54)")}]}}),j={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(c){const p=c.label||"",d=c.raw||0,r=d/c.dataset.data.reduce((e,w)=>e+w,0)*100;return`${p}: ${R(d)} (${r.toFixed(2)}%)`}}}}},O={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(c){return`${c.dataset.label}: ${R(c.raw)}`}}}},scales:{y:{beginAtZero:!0,ticks:{callback:function(c){return R(c)}}}}},S={responsive:!0,maintainAspectRatio:!1,plugins:{tooltip:{callbacks:{label:function(c){return`${c.dataset.label}: ${R(c.raw)}`}}}},scales:{y:{ticks:{callback:function(c){return R(c)}}}}},R=c=>new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0,maximumFractionDigits:0}).format(c),U=()=>{b.value=k(),i.value=D();const c={};b.value.forEach(p=>{c[p.symbol]={price:p.cost,change:0,changePercent:0}}),v.value=c;try{const p=localStorage.getItem("investment-tracker-prices");p&&(v.value={...v.value,...JSON.parse(p)})}catch(p){console.error("無法讀取價格資料",p)}};return G(()=>{U(),window.addEventListener("storage",c=>{(c.key==="investment-tracker-stocks"||c.key==="investment-tracker-realized"||c.key==="investment-tracker-prices")&&U()})}),(c,p)=>(y(),g("div",null,[p[4]||(p[4]=t("h2",{class:"text-xl font-bold mb-4"},"圖表分析",-1)),t("div",Ut,[t("div",Bt,[(y(),g(Y,null,J(C,d=>t("button",{key:d.id,onClick:r=>x.value=d.id,class:M(["px-4 py-2 rounded-md transition-colors mb-2",x.value===d.id?"bg-primary text-white":"bg-gray-100 text-gray-700"])},m(d.name),11,Wt)),64))])]),t("div",Yt,[x.value==="allocation"?(y(),g("div",Jt,[p[1]||(p[1]=t("h3",{class:"text-lg font-medium mb-4"},"持股分配",-1)),a.value?(y(),g("div",Ht,[t("div",Zt,[B(L(wt),{"chart-data":I.value,"chart-options":j},null,8,["chart-data"])]),t("div",Gt,[p[0]||(p[0]=t("h4",{class:"text-md font-medium mb-2"},"持股比例",-1)),(y(!0),g(Y,null,J(f.value,(d,r)=>(y(),g("div",{key:r,class:"flex items-center mb-2"},[t("div",{class:"w-4 h-4 rounded-full mr-2",style:St({backgroundColor:h[r%h.length]})},null,4),t("div",Qt,m(d.name)+" ("+m(d.symbol)+")",1),t("div",Xt,m(d.percentage.toFixed(2))+"%",1)]))),128))])])):(y(),g("div",Kt," 尚未新增持股資料，請先在持股管理頁面新增股票。 "))])):E("",!0),x.value==="profit"?(y(),g("div",te,[p[2]||(p[2]=t("h3",{class:"text-lg font-medium mb-4"},"總體損益",-1)),n.value?(y(),g("div",se,[B(L(Dt),{"chart-data":T.value,"chart-options":O},null,8,["chart-data"])])):(y(),g("div",ee," 尚未有足夠資料，請先新增持股或已實現收益。 "))])):E("",!0),x.value==="realized"?(y(),g("div",le,[p[3]||(p[3]=t("h3",{class:"text-lg font-medium mb-4"},"已實現收益分析",-1)),o.value?(y(),g("div",ne,[B(L(Ct),{"chart-data":$.value,"chart-options":S},null,8,["chart-data"])])):(y(),g("div",ae," 尚未新增已實現收益資料，請先在已實現收益頁面新增資料。 "))])):E("",!0)])]))}};async function re(_){try{const D=await(await fetch(`https://query1.finance.yahoo.com/v8/finance/chart/${_}?interval=1d`)).json();if(D.chart.error)return console.error("獲取股票價格出錯",D.chart.error),null;const x=D.chart.result[0];return{price:x.meta.regularMarketPrice,change:x.meta.regularMarketChange,changePercent:x.meta.regularMarketChangePercent,time:new Date(x.meta.regularMarketTime*1e3)}}catch(k){return console.error("獲取股票價格出錯",k),null}}async function ie(_){try{const k=_.map(x=>re(x));return(await Promise.allSettled(k)).map((x,b)=>x.status==="fulfilled"&&x.value?{symbol:_[b],...x.value}:{symbol:_[b],price:null,error:!0})}catch(k){return console.error("獲取多個股票價格出錯",k),_.map(D=>({symbol:D,price:null,error:!0}))}}function st(_,k=2){return _==null?"-":_.toFixed(k)}function lt(_){return _==null?"":_>0?"positive":_<0?"negative":""}const ue={class:"card bg-white p-4 mb-6"},ce={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},de={class:"p-3 bg-gray-50 rounded-lg"},me={class:"text-lg font-semibold"},pe={class:"p-3 bg-gray-50 rounded-lg"},be={class:"text-lg font-semibold"},ve={class:"p-3 bg-gray-50 rounded-lg"},ye={class:"text-sm"},fe={class:"flex justify-between items-center mb-4"},ge={key:0,class:"inline-block animate-spin"},he={class:"card"},xe={key:0,class:"text-center py-6 text-gray-500"},_e={key:1,class:"table-container"},ke={class:"table"},$e={class:"flex space-x-2"},we=["onClick"],Se=["onClick"],De={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10"},Ce={class:"bg-white rounded-lg p-6 max-w-md w-full"},Pe={class:"text-lg font-bold mb-4"},qe={class:"mb-4"},Te={class:"mb-4"},ze={class:"mb-4"},Fe={class:"mb-4"},Ve={class:"mb-4"},Ie={class:"mb-4"},Oe={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10"},Re={class:"bg-white rounded-lg p-6 max-w-md w-full"},Ae={class:"mb-4"},je={class:"flex justify-end space-x-3"},Me={__name:"HomeView",setup(_){const{getStocks:k,addStock:D,updateStock:x,deleteStock:b}=H(),i=q([]),v=q({}),C=q(!1),h=q(null),a=q(null),o=q(!1),n=ot({symbol:"",name:"",market:"台股",cost:0,quantity:0,purchaseDate:new Date().toISOString().split("T")[0]}),f=F(()=>i.value.reduce((l,s)=>l+s.cost*s.quantity,0)),I=F(()=>i.value.reduce((l,s)=>{var u;const P=((u=v.value[s.symbol])==null?void 0:u.price)||0;return l+P*s.quantity},0)),T=F(()=>I.value-f.value),$=F(()=>f.value===0?0:T.value/f.value*100),j=()=>{i.value=k(),i.value.length>0&&O()},O=async()=>{if(i.value.length!==0){o.value=!0;try{const l=i.value.map(u=>u.symbol),s=await ie(l),P={};s.forEach(u=>{P[u.symbol]=u}),v.value=P}catch(l){console.error("更新價格出錯",l)}finally{o.value=!1}}},S=l=>{const s=i.value[l];h.value=l,n.symbol=s.symbol,n.name=s.name,n.market=s.market,n.cost=s.cost,n.quantity=s.quantity,n.purchaseDate=s.purchaseDate||"",C.value=!0},R=l=>{a.value=l},U=()=>{a.value!==null&&(b(a.value),j(),a.value=null)},c=()=>{const l={symbol:n.symbol,name:n.name,market:n.market,cost:n.cost,quantity:n.quantity,purchaseDate:n.purchaseDate};h.value!==null?x(h.value,l):D(l),j(),h.value=null,C.value=!1,d()},p=()=>{C.value=!1,h.value=null,d()},d=()=>{n.symbol="",n.name="",n.market="台股",n.cost=0,n.quantity=0,n.purchaseDate=new Date().toISOString().split("T")[0]},r=l=>new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0,maximumFractionDigits:0}).format(l),e=(l,s)=>{if(!s)return"載入中...";const P=l.cost*l.quantity,z=s*l.quantity-P,K=P>0?z/P*100:0,W=z>=0?"+":"";return`${W}${r(z)} (${W}${K.toFixed(2)}%)`},w=(l,s)=>{if(!s)return"";const P=l.cost*l.quantity,z=s*l.quantity-P;return z>0?"positive":z<0?"negative":""};return G(()=>{j();const l=setInterval(O,5*60*1e3);return()=>clearInterval(l)}),(l,s)=>{var P;return y(),g("div",null,[s[23]||(s[23]=t("h2",{class:"text-xl font-bold mb-4"},"持股管理",-1)),t("div",ue,[t("div",ce,[t("div",de,[s[9]||(s[9]=t("h3",{class:"text-gray-500 text-sm"},"總投資成本",-1)),t("p",me,m(r(f.value)),1)]),t("div",pe,[s[10]||(s[10]=t("h3",{class:"text-gray-500 text-sm"},"目前總市值",-1)),t("p",be,m(r(I.value)),1)]),t("div",ve,[s[11]||(s[11]=t("h3",{class:"text-gray-500 text-sm"},"未實現損益",-1)),t("p",{class:M(["text-lg font-semibold",L(lt)(T.value)])},[at(m(T.value>0?"+":"")+m(r(T.value))+" ",1),t("span",ye," ("+m($.value>0?"+":"")+m($.value.toFixed(2))+"%) ",1)],2)])])]),t("div",fe,[t("button",{onClick:s[0]||(s[0]=u=>C.value=!0),class:"btn btn-primary"}," + 新增持股 "),t("button",{onClick:O,class:"btn bg-gray-100 text-gray-700 flex items-center"},[s[12]||(s[12]=t("span",{class:"mr-1"},"更新價格",-1)),o.value?(y(),g("span",ge,"⟳")):E("",!0)])]),t("div",he,[i.value.length===0?(y(),g("div",xe," 尚未新增持股資料，請點擊「新增持股」按鈕開始追蹤。 ")):(y(),g("div",_e,[t("table",ke,[s[13]||(s[13]=t("thead",null,[t("tr",null,[t("th",null,"代碼"),t("th",null,"名稱"),t("th",null,"市場"),t("th",null,"持有股數"),t("th",null,"成本價"),t("th",null,"目前價格"),t("th",null,"市值"),t("th",null,"損益"),t("th",null,"操作")])],-1)),t("tbody",null,[(y(!0),g(Y,null,J(i.value,(u,z)=>{var K,W,Q;return y(),g("tr",{key:z},[t("td",null,m(u.symbol),1),t("td",null,m(u.name),1),t("td",null,m(u.market),1),t("td",null,m(u.quantity),1),t("td",null,m(L(st)(u.cost)),1),t("td",{class:M(L(lt)((K=v.value[u.symbol])==null?void 0:K.change))},m(v.value[u.symbol]?L(st)(v.value[u.symbol].price):"載入中..."),3),t("td",null,m(v.value[u.symbol]?r(u.quantity*v.value[u.symbol].price):"載入中..."),1),t("td",{class:M(w(u,(W=v.value[u.symbol])==null?void 0:W.price))},m(e(u,(Q=v.value[u.symbol])==null?void 0:Q.price)),3),t("td",null,[t("div",$e,[t("button",{onClick:ut=>S(z),class:"text-primary text-sm"}," 編輯 ",8,we),t("button",{onClick:ut=>R(z),class:"text-danger text-sm"}," 刪除 ",8,Se)])])])}),128))])])]))]),C.value?(y(),g("div",De,[t("div",Ce,[t("h3",Pe,m(h.value===null?"新增持股":"編輯持股"),1),t("form",{onSubmit:rt(c,["prevent"])},[t("div",qe,[s[14]||(s[14]=t("label",{class:"block text-sm font-medium mb-1"},"股票代碼",-1)),V(t("input",{"onUpdate:modelValue":s[1]||(s[1]=u=>n.symbol=u),required:"",class:"input w-full",placeholder:"例如：2330.TW 或 AAPL"},null,512),[[A,n.symbol]])]),t("div",Te,[s[15]||(s[15]=t("label",{class:"block text-sm font-medium mb-1"},"股票名稱",-1)),V(t("input",{"onUpdate:modelValue":s[2]||(s[2]=u=>n.name=u),required:"",class:"input w-full",placeholder:"例如：台積電 或 蘋果"},null,512),[[A,n.name]])]),t("div",ze,[s[17]||(s[17]=t("label",{class:"block text-sm font-medium mb-1"},"市場",-1)),V(t("select",{"onUpdate:modelValue":s[3]||(s[3]=u=>n.market=u),required:"",class:"input w-full"},s[16]||(s[16]=[t("option",{value:"台股"},"台股",-1),t("option",{value:"美股"},"美股",-1),t("option",{value:"其他"},"其他",-1)]),512),[[Pt,n.market]])]),t("div",Fe,[s[18]||(s[18]=t("label",{class:"block text-sm font-medium mb-1"},"成本價",-1)),V(t("input",{"onUpdate:modelValue":s[4]||(s[4]=u=>n.cost=u),type:"number",step:"0.01",required:"",class:"input w-full",placeholder:"每股成本"},null,512),[[A,n.cost,void 0,{number:!0}]])]),t("div",Ve,[s[19]||(s[19]=t("label",{class:"block text-sm font-medium mb-1"},"持有股數",-1)),V(t("input",{"onUpdate:modelValue":s[5]||(s[5]=u=>n.quantity=u),type:"number",required:"",class:"input w-full",placeholder:"持有數量"},null,512),[[A,n.quantity,void 0,{number:!0}]])]),t("div",Ie,[s[20]||(s[20]=t("label",{class:"block text-sm font-medium mb-1"},"購買日期",-1)),V(t("input",{"onUpdate:modelValue":s[6]||(s[6]=u=>n.purchaseDate=u),type:"date",class:"input w-full"},null,512),[[A,n.purchaseDate]])]),t("div",{class:"flex justify-end space-x-3"},[t("button",{type:"button",onClick:p,class:"btn bg-gray-200 text-gray-800"}," 取消 "),s[21]||(s[21]=t("button",{type:"submit",class:"btn btn-primary"},"儲存",-1))])],32)])])):E("",!0),a.value!==null?(y(),g("div",Oe,[t("div",Re,[s[22]||(s[22]=t("h3",{class:"text-lg font-bold mb-4"},"確認刪除",-1)),t("p",Ae," 確定要刪除「"+m((P=i.value[a.value])==null?void 0:P.name)+"」的持股資料嗎？ ",1),t("div",je,[t("button",{onClick:s[7]||(s[7]=u=>a.value=null),class:"btn bg-gray-200 text-gray-800"}," 取消 "),t("button",{onClick:s[8]||(s[8]=u=>U()),class:"btn btn-danger"}," 確認刪除 ")])])])):E("",!0)])}}},Ee={class:"card bg-white p-4 mb-6"},Ne={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Le={class:"p-3 bg-gray-50 rounded-lg"},Ue={class:"p-3 bg-gray-50 rounded-lg"},Be={class:"text-lg font-semibold"},We={class:"flex justify-between items-center mb-4"},Ye={class:"card"},Je={key:0,class:"text-center py-6 text-gray-500"},Ke={key:1,class:"table-container"},He={class:"table"},Ze={class:"flex space-x-2"},Ge=["onClick"],Qe=["onClick"],Xe={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10"},ts={class:"bg-white rounded-lg p-6 max-w-md w-full"},es={class:"text-lg font-bold mb-4"},ss={class:"mb-4"},ls={class:"mb-4"},as={class:"mb-4"},ns={class:"mb-4"},os={class:"mb-4"},rs={class:"mb-4"},is=["value"],us={class:"mb-4"},cs={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10"},ds={class:"bg-white rounded-lg p-6 max-w-md w-full"},ms={class:"mb-4"},ps={class:"flex justify-end space-x-3"},bs={__name:"RealizedView",setup(_){const{getRealizedTrades:k,addRealizedTrade:D,updateRealizedTrade:x,deleteRealizedTrade:b}=H(),i=q([]),v=q(!1),C=q(null),h=q(null),a=ot({symbol:"",name:"",sellPrice:0,quantity:0,buyPrice:0,date:new Date().toISOString().split("T")[0]}),o=F(()=>i.value.reduce((r,e)=>r+e.profit,0)),n=F(()=>[...i.value].sort((r,e)=>new Date(e.date)-new Date(r.date))),f=()=>{i.value=k()},I=r=>{const e=i.value[r];C.value=r,a.symbol=e.symbol,a.name=e.name,a.sellPrice=e.sellPrice,a.quantity=e.quantity,a.buyPrice=e.cost/e.quantity||0,a.date=e.date,v.value=!0},T=r=>{h.value=r},$=()=>{h.value!==null&&(b(h.value),f(),h.value=null)},j=()=>{const r=d(),w=a.sellPrice*a.quantity-r,l={symbol:a.symbol,name:a.name,sellPrice:a.sellPrice,quantity:a.quantity,cost:r,profit:w,date:a.date};C.value!==null?x(C.value,l):D(l),f(),C.value=null,v.value=!1,S()},O=()=>{v.value=!1,C.value=null,S()},S=()=>{a.symbol="",a.name="",a.sellPrice=0,a.quantity=0,a.buyPrice=0,a.date=new Date().toISOString().split("T")[0]},R=r=>new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0,maximumFractionDigits:0}).format(r),U=r=>r.toFixed(2),c=r=>nt(r).format("YYYY/MM/DD"),p=r=>{if(r.cost===0)return"0.00%";const e=r.profit/r.cost*100;return`${e>=0?"+":""}${e.toFixed(2)}%`},d=()=>a.buyPrice*a.quantity;return G(()=>{f()}),(r,e)=>{var w;return y(),g("div",null,[e[21]||(e[21]=t("h2",{class:"text-xl font-bold mb-4"},"已實現收益",-1)),t("div",Ee,[t("div",Ne,[t("div",Le,[e[9]||(e[9]=t("h3",{class:"text-gray-500 text-sm"},"總實現收益",-1)),t("p",{class:M(["text-lg font-semibold",o.value>=0?"positive":"negative"])},m(o.value>0?"+":"")+m(R(o.value)),3)]),t("div",Ue,[e[10]||(e[10]=t("h3",{class:"text-gray-500 text-sm"},"總交易次數",-1)),t("p",Be,m(i.value.length)+" 次",1)])])]),t("div",We,[t("button",{onClick:e[0]||(e[0]=l=>v.value=!0),class:"btn btn-primary"}," + 新增已實現收益 ")]),t("div",Ye,[i.value.length===0?(y(),g("div",Je," 尚未新增已實現收益資料，請點擊「新增已實現收益」按鈕進行新增。 ")):(y(),g("div",Ke,[t("table",He,[e[11]||(e[11]=t("thead",null,[t("tr",null,[t("th",null,"日期"),t("th",null,"代碼"),t("th",null,"名稱"),t("th",null,"賣出價格"),t("th",null,"數量"),t("th",null,"總成本"),t("th",null,"實現損益"),t("th",null,"報酬率"),t("th",null,"操作")])],-1)),t("tbody",null,[(y(!0),g(Y,null,J(n.value,(l,s)=>(y(),g("tr",{key:s},[t("td",null,m(c(l.date)),1),t("td",null,m(l.symbol),1),t("td",null,m(l.name),1),t("td",null,m(U(l.sellPrice)),1),t("td",null,m(l.quantity),1),t("td",null,m(R(l.cost)),1),t("td",{class:M(l.profit>=0?"positive":"negative")},m(l.profit>0?"+":"")+m(R(l.profit)),3),t("td",{class:M(l.profit>=0?"positive":"negative")},m(p(l)),3),t("td",null,[t("div",Ze,[t("button",{onClick:P=>I(s),class:"text-primary text-sm"}," 編輯 ",8,Ge),t("button",{onClick:P=>T(s),class:"text-danger text-sm"}," 刪除 ",8,Qe)])])]))),128))])])]))]),v.value?(y(),g("div",Xe,[t("div",ts,[t("h3",es,m(C.value===null?"新增已實現收益":"編輯已實現收益"),1),t("form",{onSubmit:rt(j,["prevent"])},[t("div",ss,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium mb-1"},"股票代碼",-1)),V(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>a.symbol=l),required:"",class:"input w-full",placeholder:"例如：2330.TW 或 AAPL"},null,512),[[A,a.symbol]])]),t("div",ls,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium mb-1"},"股票名稱",-1)),V(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>a.name=l),required:"",class:"input w-full",placeholder:"例如：台積電 或 蘋果"},null,512),[[A,a.name]])]),t("div",as,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium mb-1"},"賣出價格",-1)),V(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>a.sellPrice=l),type:"number",step:"0.01",required:"",class:"input w-full",placeholder:"每股賣出價格"},null,512),[[A,a.sellPrice,void 0,{number:!0}]])]),t("div",ns,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium mb-1"},"數量",-1)),V(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>a.quantity=l),type:"number",required:"",class:"input w-full",placeholder:"賣出數量"},null,512),[[A,a.quantity,void 0,{number:!0}]])]),t("div",os,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium mb-1"},"買入價格",-1)),V(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>a.buyPrice=l),type:"number",step:"0.01",required:"",class:"input w-full",placeholder:"每股買入價格"},null,512),[[A,a.buyPrice,void 0,{number:!0}]])]),t("div",rs,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium mb-1"},"總成本",-1)),t("input",{value:d(),type:"number",step:"0.01",disabled:"",class:"input w-full bg-gray-100"},null,8,is)]),t("div",us,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium mb-1"},"賣出日期",-1)),V(t("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>a.date=l),type:"date",required:"",class:"input w-full"},null,512),[[A,a.date]])]),t("div",{class:"flex justify-end space-x-3"},[t("button",{type:"button",onClick:O,class:"btn bg-gray-200 text-gray-800"}," 取消 "),e[19]||(e[19]=t("button",{type:"submit",class:"btn btn-primary"},"儲存",-1))])],32)])])):E("",!0),h.value!==null?(y(),g("div",cs,[t("div",ds,[e[20]||(e[20]=t("h3",{class:"text-lg font-bold mb-4"},"確認刪除",-1)),t("p",ms," 確定要刪除「"+m((w=i.value[h.value])==null?void 0:w.name)+"」的已實現收益資料嗎？ ",1),t("div",ps,[t("button",{onClick:e[7]||(e[7]=l=>h.value=null),class:"btn bg-gray-200 text-gray-800"}," 取消 "),t("button",{onClick:e[8]||(e[8]=l=>$()),class:"btn btn-danger"}," 確認刪除 ")])])])):E("",!0)])}}},vs=[{path:"/",component:Me},{path:"/realized",component:bs},{path:"/charts",component:oe}],ys=qt({history:Tt(),routes:vs}),it=zt(Lt);it.use(ys);it.mount("#app");
