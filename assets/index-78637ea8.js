import{r as St,o as m,c as g,a as t,F as nt,b as rt,d as X,w as gt,t as u,u as et,e as Et,f as Mt,g as ot,n as R,T as Bt,h as ct,i as Lt,K as Yt,C as dt,A as ht,p as mt,j as vt,k as xt,L as _t,B as wt,P as Pt,l as qt,m as pt,q as U,s as V,v as Ft,x as bt,y as Jt,z as zt,D as tt,E as Z,G as Vt,H as Ut,I as Kt,J as jt,M as Ht,N as $t,O as Dt,Q as At,R as Rt,S as E,U as Y,V as It,W as Zt,X as Xt,Y as Gt}from"./vendor-386eb522.js";(function(){const p=document.createElement("link").relList;if(p&&p.supports&&p.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))$(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&$(i)}).observe(document,{childList:!0,subtree:!0});function D(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function $(n){if(n.ep)return;n.ep=!0;const o=D(n);fetch(n.href,o)}})();const Ct="investment-tracker-stocks",Tt="investment-tracker-realized";function ft(){const C=()=>{try{const d=localStorage.getItem(Ct);return d?JSON.parse(d):[]}catch(d){return console.error("無法讀取持股資料",d),[]}},p=d=>{try{localStorage.setItem(Ct,JSON.stringify(d))}catch(h){console.error("無法儲存持股資料",h)}},D=d=>{const h=C();h.push(d),p(h)},$=(d,h)=>{const r=C();r[d]=h,p(r)},n=d=>{const h=C();h.splice(d,1),p(h)},o=()=>{try{const d=localStorage.getItem(Tt);return d?JSON.parse(d):[]}catch(d){return console.error("無法讀取已實現收益資料",d),[]}},i=d=>{try{localStorage.setItem(Tt,JSON.stringify(d))}catch(h){console.error("無法儲存已實現收益資料",h)}};return{getStocks:C,setStocks:p,addStock:D,updateStock:$,deleteStock:n,getRealizedTrades:o,setRealizedTrades:i,addRealizedTrade:d=>{const h=o();h.push(d),i(h)},updateRealizedTrade:(d,h)=>{const r=o();r[d]=h,i(r)},deleteRealizedTrade:d=>{const h=o();h.splice(d,1),i(h)}}}const Qt={class:"min-h-screen"},te={class:"bg-primary text-white p-4 shadow-md"},ee={class:"container mx-auto flex justify-between items-center"},se={class:"flex space-x-2"},le={class:"btn bg-secondary text-white text-sm px-3 py-1 cursor-pointer"},oe={class:"bg-white shadow-sm"},ae={class:"container mx-auto"},ne={class:"flex"},re={class:"container mx-auto p-4"},ie={class:"bg-gray-100 text-gray-600 p-4 text-center text-sm"},ue={__name:"App",setup(C){const{getStocks:p,getRealizedTrades:D,setStocks:$,setRealizedTrades:n}=ft(),o=[{name:"持股管理",path:"/"},{name:"已實現收益",path:"/realized"},{name:"圖表分析",path:"/charts"}],i=()=>{const T=et.book_new(),k=p(),d=D(),h=k.map(a=>({股票代碼:a.symbol,股票名稱:a.name,市場:a.market,成本價:a.cost,數量:a.quantity,購買日期:a.purchaseDate})),r=d.map(a=>({股票代碼:a.symbol,股票名稱:a.name,賣出價格:a.sellPrice,數量:a.quantity,成本:a.cost,實現損益:a.profit,日期:a.date})),x=et.json_to_sheet(h),W=et.json_to_sheet(r);et.book_append_sheet(T,x,"持股紀錄"),et.book_append_sheet(T,W,"已實現收益"),Et(T,"投資損益資料.xlsx")},S=T=>{const k=T.target.files[0];if(!k)return;const d=new FileReader;d.onload=h=>{const r=new Uint8Array(h.target.result),x=Mt(r,{type:"array"}),W=x.Sheets.持股紀錄;if(W){const P=et.sheet_to_json(W).map(q=>({symbol:q.股票代碼,name:q.股票名稱,market:q.市場,cost:parseFloat(q.成本價),quantity:parseInt(q.數量),purchaseDate:q.購買日期}));$(P)}const a=x.Sheets.已實現收益;if(a){const P=et.sheet_to_json(a).map(q=>({symbol:q.股票代碼,name:q.股票名稱,sellPrice:parseFloat(q.賣出價格),quantity:parseInt(q.數量),cost:parseFloat(q.成本),profit:parseFloat(q.實現損益),date:q.日期}));n(P)}T.target.value="",alert("資料匯入成功！")},d.readAsArrayBuffer(k)};return(T,k)=>{const d=St("router-link"),h=St("router-view");return m(),g("div",Qt,[t("header",te,[t("div",ee,[k[3]||(k[3]=t("h1",{class:"text-xl md:text-2xl font-bold"},"投資損益小幫手",-1)),t("div",se,[t("button",{onClick:i,class:"btn bg-secondary text-white text-sm px-3 py-1"},k[0]||(k[0]=[t("span",{class:"hidden md:inline"},"匯出資料",-1),t("span",{class:"md:hidden"},"匯出",-1)])),t("label",le,[k[1]||(k[1]=t("span",{class:"hidden md:inline"},"匯入資料",-1)),k[2]||(k[2]=t("span",{class:"md:hidden"},"匯入",-1)),t("input",{type:"file",accept:".xlsx",class:"hidden",onChange:S},null,32)])])])]),t("nav",oe,[t("div",ae,[t("ul",ne,[(m(),g(nt,null,rt(o,r=>t("li",{key:r.path},[X(d,{to:r.path,class:R(["block px-4 py-3 hover:bg-gray-100 transition-colors border-b-2",T.$route.path===r.path?"border-primary text-primary font-medium":"border-transparent"])},{default:gt(()=>[ot(u(r.name),1)]),_:2},1032,["to","class"])])),64))])])]),t("main",re,[X(h,null,{default:gt(({Component:r})=>[X(Bt,{name:"fade",mode:"out-in"},{default:gt(()=>[(m(),ct(Yt,null,[(m(),ct(Lt(r),{key:T.$route.path}))],1024))]),_:2},1024)]),_:1})]),t("footer",ie,[t("p",null,"投資損益小幫手 © "+u(new Date().getFullYear()),1)])])}}};const ce={class:"mb-6"},de={class:"flex flex-wrap space-x-2"},me=["onClick"],ve={class:"card"},pe={key:0,class:"p-4"},be={key:0,class:"text-center py-6 text-gray-500"},fe={key:1,class:"flex flex-col md:flex-row"},ge={class:"w-full md:w-1/2 min-h-[300px]"},ye={key:0},he={key:1,class:"h-[300px] flex items-center justify-center"},xe={class:"w-full md:w-1/2 p-4"},_e={class:"flex-1"},we={class:"text-right"},$e={key:1,class:"p-4"},ke={key:0,class:"text-center py-6 text-gray-500"},Se={key:1,class:"min-h-[300px]"},De={key:0},Ce={key:1,class:"h-[300px] flex items-center justify-center"},Te={key:2,class:"p-4"},Pe={key:0,class:"text-center py-6 text-gray-500"},qe={key:1,class:"min-h-[300px]"},Fe={key:0},ze={key:1,class:"h-[300px] flex items-center justify-center"},Ve={__name:"ChartsView",setup(C){dt.register(ht,mt,vt,xt,_t,wt,Pt,qt,pt);const{getStocks:p,getRealizedTrades:D}=ft(),$=U("allocation"),n=U([]),o=U([]),i=U({}),S=U(!1),T=U(!0),k=[{id:"allocation",name:"持股分配"},{id:"profit",name:"總體損益"},{id:"realized",name:"已實現收益趨勢"}],d=["#4CAF50","#2196F3","#F44336","#FF9800","#9C27B0","#3F51B5","#009688","#795548","#607D8B","#E91E63"],h=V(()=>n.value&&n.value.length>0),r=V(()=>o.value&&o.value.length>0),x=V(()=>h.value||r.value);Ft([n,o,i],()=>{(h.value||r.value)&&Object.keys(i.value).length>0&&(console.log("圖表數據已就緒"),S.value=!0)},{deep:!0});const W=V(()=>{if(!h.value)return[];const b=n.value.map(w=>{var F;const A=(((F=i.value[w.symbol])==null?void 0:F.price)||w.cost)*w.quantity;return{...w,marketValue:A}}),f=b.reduce((w,j)=>w+j.marketValue,0);return b.map(w=>({...w,percentage:w.marketValue/f*100})).sort((w,j)=>j.marketValue-w.marketValue)}),a=V(()=>h.value?{labels:W.value.map(b=>b.name),datasets:[{data:W.value.map(b=>b.marketValue),backgroundColor:W.value.map((b,f)=>d[f%d.length]),hoverOffset:4}]}:{labels:[],datasets:[{data:[],backgroundColor:[],hoverOffset:4}]}),N=V(()=>{const b=["未實現損益","已實現收益","總體損益"];if(!x.value)return{labels:b,datasets:[{label:"損益金額",data:[0,0,0],backgroundColor:Array(3).fill("rgba(200, 200, 200, 0.6)"),borderColor:Array(3).fill("rgb(200, 200, 200)"),borderWidth:1}]};const f=n.value.reduce((F,M)=>{var st;const K=(((st=i.value[M.symbol])==null?void 0:st.price)||M.cost)*M.quantity,B=M.cost*M.quantity;return F+(K-B)},0),w=o.value.reduce((F,M)=>F+M.profit,0),j=f+w,A=[f,w,j];return{labels:b,datasets:[{label:"損益金額",data:A,backgroundColor:A.map(F=>F>=0?"rgba(76, 175, 80, 0.6)":"rgba(244, 67, 54, 0.6)"),borderColor:A.map(F=>F>=0?"rgb(76, 175, 80)":"rgb(244, 67, 54)"),borderWidth:1}]}}),P=V(()=>{if(!r.value)return{labels:[],datasets:[{label:"累計已實現收益",data:[],borderColor:"rgb(54, 162, 235)",backgroundColor:"rgba(54, 162, 235, 0.5)",tension:.1,pointBackgroundColor:[]}]};const b=[...o.value].sort((A,F)=>new Date(A.date)-new Date(F.date));let f=0;const w=[],j=[];return b.forEach(A=>{f+=A.profit,w.push(f),j.push(Vt(A.date).format("YYYY/MM/DD"))}),{labels:j,datasets:[{label:"累計已實現收益",data:w,borderColor:"rgb(54, 162, 235)",backgroundColor:"rgba(54, 162, 235, 0.5)",tension:.1,pointBackgroundColor:w.map(A=>A>=0?"rgb(76, 175, 80)":"rgb(244, 67, 54)")}]}}),q={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(b){const f=b.label||"",w=b.raw||0,j=w/b.dataset.data.reduce((A,F)=>A+F,0)*100;return`${f}: ${L(w)} (${j.toFixed(2)}%)`}}}}},G={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(b){return`${b.dataset.label}: ${L(b.raw)}`}}}},scales:{y:{beginAtZero:!0,ticks:{callback:function(b){return L(b)}}}}},O={responsive:!0,maintainAspectRatio:!1,plugins:{tooltip:{callbacks:{label:function(b){return`${b.dataset.label}: ${L(b.raw)}`}}}},scales:{y:{ticks:{callback:function(b){return L(b)}}}}},L=b=>new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0,maximumFractionDigits:0}).format(b),Q=()=>{try{S.value=!1,n.value=p()||[],o.value=D()||[],console.log(`載入了 ${n.value.length} 支股票和 ${o.value.length} 筆交易記錄`);const b={};n.value.forEach(f=>{f&&f.symbol&&(b[f.symbol]={price:f.cost||0,change:0,changePercent:0})}),i.value=b;try{const f=localStorage.getItem("investment-tracker-prices");if(f){const w=JSON.parse(f);w&&typeof w=="object"&&(i.value={...i.value,...w})}}catch(f){console.error("無法讀取價格資料",f)}setTimeout(()=>{n.value&&n.value.length>0||o.value&&o.value.length>0?(console.log("圖表數據驗證成功，準備渲染圖表"),S.value=!0):console.log("無有效數據，不渲染圖表")},100)}catch(b){console.error("載入數據時出錯:",b),n.value=[],o.value=[],i.value={},S.value=!1}};return bt(()=>{console.log("圖表分析頁面加載中...");try{Q(),T.value=!1;const b=f=>{(f.key==="investment-tracker-stocks"||f.key==="investment-tracker-realized"||f.key==="investment-tracker-prices")&&(console.log("儲存數據變更，重新載入圖表數據"),S.value=!1,setTimeout(()=>{Q()},50))};window.addEventListener("storage",b),Jt(()=>{console.log("移除儲存變化事件監聽器"),window.removeEventListener("storage",b)})}catch(b){console.error("圖表分析頁面初始化失敗:",b),n.value=[],o.value=[],i.value={},S.value=!1}}),zt(()=>{if(console.log("圖表分析頁面激活中，初次掛載狀態:",T.value),T.value){T.value=!1;return}try{Q()}catch(b){console.error("圖表分析頁面激活時失敗:",b)}}),(b,f)=>(m(),g("div",null,[f[7]||(f[7]=t("h2",{class:"text-xl font-bold mb-4"},"圖表分析",-1)),t("div",ce,[t("div",de,[(m(),g(nt,null,rt(k,w=>t("button",{key:w.id,onClick:j=>$.value=w.id,class:R(["px-4 py-2 rounded-md transition-colors mb-2",$.value===w.id?"bg-primary text-white":"bg-gray-100 text-gray-700"])},u(w.name),11,me)),64))])]),t("div",ve,[$.value==="allocation"?(m(),g("div",pe,[f[2]||(f[2]=t("h3",{class:"text-lg font-medium mb-4"},"持股分配",-1)),h.value?(m(),g("div",fe,[t("div",ge,[S.value&&a.value.datasets[0].data.length>0?(m(),g("div",ye,[X(tt(Ut),{data:a.value,options:q,height:250},null,8,["data"])])):(m(),g("div",he,f[0]||(f[0]=[t("p",{class:"text-gray-500"},"正在載入圖表...",-1)])))]),t("div",xe,[f[1]||(f[1]=t("h4",{class:"text-md font-medium mb-2"},"持股比例",-1)),(m(!0),g(nt,null,rt(W.value,(w,j)=>(m(),g("div",{key:j,class:"flex items-center mb-2"},[t("div",{class:"w-4 h-4 rounded-full mr-2",style:Kt({backgroundColor:d[j%d.length]})},null,4),t("div",_e,u(w.name)+" ("+u(w.symbol)+")",1),t("div",we,u(w.percentage.toFixed(2))+"%",1)]))),128))])])):(m(),g("div",be," 尚未新增持股資料，請先在持股管理頁面新增股票。 "))])):Z("",!0),$.value==="profit"?(m(),g("div",$e,[f[4]||(f[4]=t("h3",{class:"text-lg font-medium mb-4"},"總體損益",-1)),x.value?(m(),g("div",Se,[S.value&&N.value.datasets[0].data.length>0?(m(),g("div",De,[X(tt(jt),{data:N.value,options:G,height:250},null,8,["data"])])):(m(),g("div",Ce,f[3]||(f[3]=[t("p",{class:"text-gray-500"},"正在載入圖表...",-1)])))])):(m(),g("div",ke," 尚未有足夠資料，請先新增持股或已實現收益。 "))])):Z("",!0),$.value==="realized"?(m(),g("div",Te,[f[6]||(f[6]=t("h3",{class:"text-lg font-medium mb-4"},"已實現收益分析",-1)),r.value?(m(),g("div",qe,[S.value&&P.value.datasets[0].data.length>0?(m(),g("div",Fe,[X(tt(Ht),{data:P.value,options:O,height:250},null,8,["data"])])):(m(),g("div",ze,f[5]||(f[5]=[t("p",{class:"text-gray-500"},"正在載入圖表...",-1)])))])):(m(),g("div",Pe," 尚未新增已實現收益資料，請先在已實現收益頁面新增資料。 "))])):Z("",!0)])]))}},kt="https://yahoo-finance-backend.vercel.app";let lt={USD_TWD:null,lastUpdated:null};async function Ue(){const C=new Date;if(lt.USD_TWD&&lt.lastUpdated&&C-lt.lastUpdated<36e5)return console.log("使用緩存的匯率數據"),lt.USD_TWD;try{const p=["USDTWD=X","TWD=X"];let D,$=null;for(const n of p)try{const o=`${kt}/api/stock/${n}`;if(console.log(`請求美元兌台幣匯率 (${n})...`),D=await $t.get(o,{headers:{Accept:"application/json","Cache-Control":"no-cache"},timeout:1e4}),!D.data.error&&D.data.price){$=D.data.price,console.log(`成功獲取美元兌台幣匯率: 1 USD = ${$} TWD (使用${n})`);break}}catch(o){console.error(`使用 ${n} 獲取匯率失敗:`,o.message)}$||(console.log("無法從API獲取匯率，使用預設值"),$=30),lt={USD_TWD:$,lastUpdated:C};try{localStorage.setItem("exchange-rate-cache",JSON.stringify(lt))}catch(n){console.error("無法將匯率數據存入localStorage",n)}return $}catch(p){console.error("獲取匯率失敗:",p);try{const D=localStorage.getItem("exchange-rate-cache");if(D){const $=JSON.parse(D);return console.log("使用localStorage中的匯率數據"),$.USD_TWD}}catch(D){console.error("讀取緩存匯率失敗",D)}return 30}}function yt(C){return C?C.includes(".")?C:/^\d+$/.test(C)?`${C}.TW`:C:""}async function je(C){const p=C,D=yt(C),$=`${kt}/api/stock/${D}`;console.log(`請求股票數據：${D}`);try{const n=await $t.get($,{headers:{Accept:"application/json","Cache-Control":"no-cache"},timeout:1e4});if(n.data.error)throw new Error(`API 錯誤: ${n.data.error}`);return console.log(`成功獲取 ${D} 價格: ${n.data.price} ${n.data.currency}`),{...n.data,originalSymbol:p}}catch(n){throw console.error(`獲取 ${D} 價格失敗:`,n),n.response?new Error(`API 請求失敗: ${n.response.status} ${n.response.statusText}`):n.request?new Error("無法連接到服務器，請檢查網絡連接"):n}}async function Ae(C){const p=C.filter(n=>n&&n.trim());if(p.length===0)return[];const D=p.map(n=>yt(n)),$=`${kt}/api/stocks?symbols=${D.join(",")}`;console.log(`批量獲取股票數據: ${p.join(", ")}`);try{const n=await $t.get($,{headers:{Accept:"application/json","Cache-Control":"no-cache"},timeout:15e3});return console.log(`成功獲取 ${n.data.length} 支股票數據`),n.data.map((i,S)=>(i.originalSymbol||(i.originalSymbol=p[S]),i))}catch(n){console.error("批量獲取股票數據失敗:",n),console.log("嘗試逐個獲取股票數據...");const o=p.map(i=>je(i).catch(S=>(console.error(`獲取 ${i} 數據失敗:`,S),{error:!0,errorMessage:S.message||"未知錯誤",symbol:yt(i),originalSymbol:i})));return Promise.all(o)}}function ut(C){return C==null?"":C>0?"positive":C<0?"negative":""}const Re={class:"market-pie-chart",style:{width:"250px",height:"250px"}},Ie={key:1,class:"text-center text-gray-500 h-full flex items-center justify-center"},Nt={__name:"MarketPieChart",props:{twValue:{type:Number,required:!0},usValue:{type:Number,required:!0}},setup(C){dt.register(ht,mt,vt,pt);const p=C,D=V(()=>{const n=p.twValue>0||p.usValue>0;return{labels:["台股","美股"],datasets:[{backgroundColor:["#36A2EB","#FF6384"],data:n?[p.twValue,p.usValue]:[]}]}}),$={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"},tooltip:{callbacks:{label:n=>{const o=n.label||"",i=n.raw||0,S=p.twValue+p.usValue,T=S>0?(i/S*100).toFixed(2):0;return`${o}: ${T}%`}}}}};return(n,o)=>(m(),g("div",Re,[D.value.datasets[0].data.length>0?(m(),ct(tt(Ut),{key:0,data:D.value,options:$,height:250},null,8,["data"])):(m(),g("div",Ie," 暫無資料 "))]))}},Ne={class:"market-bar-chart",style:{width:"250px",height:"250px"}},We={key:1,class:"text-center text-gray-500 h-full flex items-center justify-center"},Wt={__name:"MarketBarChart",props:{twProfit:{type:Number,required:!0},usProfit:{type:Number,required:!0},twCost:{type:Number,required:!0},usCost:{type:Number,required:!0}},setup(C){dt.register(xt,_t,wt,pt,mt,vt);const p=C,D=(o,i)=>i<=0?0:o/i*100,$=V(()=>{const o=D(p.twProfit,p.twCost),i=D(p.usProfit,p.usCost),S=p.twCost>0||p.usCost>0;return{labels:["台股","美股"],datasets:[{label:"報酬率 (%)",backgroundColor:[o>=0?"rgba(76, 175, 80, 0.6)":"rgba(244, 67, 54, 0.6)",i>=0?"rgba(76, 175, 80, 0.6)":"rgba(244, 67, 54, 0.6)"],borderColor:[o>=0?"rgba(76, 175, 80, 1)":"rgba(244, 67, 54, 1)",i>=0?"rgba(76, 175, 80, 1)":"rgba(244, 67, 54, 1)"],borderWidth:1,data:S?[o,i]:[]}]}}),n={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:o=>`報酬率: ${(o.raw||0).toFixed(2)}%`}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"報酬率 (%)"},ticks:{callback:function(o){return o+"%"}}}}};return bt(()=>{Dt(()=>{$.value.datasets[0].data.length>0&&console.log("Chart data loaded:",$.value)})}),Ft(()=>[p.twProfit,p.usProfit,p.twCost,p.usCost],()=>{Dt(()=>{console.log("Props updated, chart should re-render")})}),(o,i)=>(m(),g("div",Ne,[$.value.datasets[0].data.length>0?(m(),ct(tt(jt),{key:0,data:$.value,options:n,height:250},null,8,["data"])):(m(),g("div",We," 暫無資料 "))]))}},Oe={class:"card bg-white p-4 mb-6"},Ee={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Me={class:"p-3 bg-gray-50 rounded-lg"},Be={class:"text-lg font-semibold"},Le={class:"p-3 bg-gray-50 rounded-lg"},Ye={class:"text-lg font-semibold"},Je={class:"p-3 bg-gray-50 rounded-lg"},Ke={class:"text-sm"},He={key:0,class:"card bg-white p-4 mb-6"},Ze={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Xe={class:"h-64 flex items-center justify-center"},Ge={class:"grid grid-cols-2 gap-4 mt-3"},Qe={class:"bg-gray-50 p-3 rounded-lg"},ts={class:"font-semibold"},es={class:"bg-gray-50 p-3 rounded-lg"},ss={class:"font-semibold"},ls={class:"h-64 flex items-center justify-center"},os={class:"grid grid-cols-2 gap-4 mt-3"},as={class:"font-semibold"},ns={class:"text-xs"},rs={key:1,class:"bg-gray-50 p-3 rounded-lg"},is={class:"font-semibold"},us={class:"text-xs"},cs={key:3,class:"bg-gray-50 p-3 rounded-lg"},ds={class:"flex justify-between items-center mb-4"},ms={class:"tabs"},vs={class:"flex items-center"},ps={class:"flex items-center"},bs={class:"text-sm text-gray-500 mr-3"},fs={key:0,class:"inline-block animate-spin"},gs={class:"card"},ys={key:0,class:"text-center py-6 text-gray-500"},hs={key:1,class:"table-container"},xs={class:"table"},_s={class:"flex space-x-2"},ws=["onClick"],$s=["onClick"],ks={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10"},Ss={class:"bg-white rounded-lg p-6 max-w-md w-full"},Ds={class:"text-lg font-bold mb-4"},Cs={class:"mb-4"},Ts={class:"mb-4"},Ps={class:"mb-4"},qs={class:"mb-4"},Fs={class:"mb-4"},zs={class:"mb-4"},Vs={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10"},Us={class:"bg-white rounded-lg p-6 max-w-md w-full"},js={class:"mb-4"},As={class:"flex justify-end space-x-3"},Rs={__name:"HomeView",setup(C){const{getStocks:p,addStock:D,updateStock:$,deleteStock:n}=ft(),o=U([]),i=U({}),S=U(!1),T=U(null),k=U(null),d=U(!1),h=U(30),r=U("all"),x=At({symbol:"",name:"",market:"台股",cost:0,quantity:0,purchaseDate:new Date().toISOString().split("T")[0]}),W=V(()=>r.value==="all"?o.value:r.value==="tw"?o.value.filter(l=>B(l)==="TWD"):r.value==="us"?o.value.filter(l=>B(l)==="USD"):o.value),a=V(()=>{const l={tw:{cost:0,value:0,profit:0},us:{cost:0,value:0,profit:0}};return!o.value||o.value.length===0||o.value.forEach(e=>{const _=B(e),v=e.cost*e.quantity,z=K(e);if(!z||isNaN(z))return;const H=z*e.quantity;if(_==="USD"){const it=v*h.value,at=H*h.value;l.us.cost+=it,l.us.value+=at,l.us.profit+=at-it}else l.tw.cost+=v,l.tw.value+=H,l.tw.profit+=H-v}),l}),N=V(()=>!a.value||!a.value.tw||!a.value.us?0:a.value.tw.cost+a.value.us.cost),P=V(()=>!a.value||!a.value.tw||!a.value.us?0:a.value.tw.value+a.value.us.value),q=V(()=>!P.value||!N.value?0:P.value-N.value),G=V(()=>N.value===0?0:q.value/N.value*100),O=V(()=>{if(!a.value||!a.value.tw||!a.value.us)return{tw:0,us:0};const l=a.value.tw.value||0,e=a.value.us.value||0,_=l+e;return _===0?{tw:0,us:0}:{tw:l/_*100,us:e/_*100}}),L=l=>o.value.findIndex(e=>e.symbol===l.symbol),Q=()=>{try{console.log("載入持股數據..."),o.value=p()||[],b(!1)}catch(l){console.error("載入持股數據失敗",l),o.value=[]}},b=async(l=!0)=>{if(!(!o.value||o.value.length===0)){l&&(d.value=!0);try{const e=o.value.map(z=>z.symbol).filter(z=>z);if(e.length===0){d.value=!1;return}console.log("正在更新以下股票價格:",e.join(", "));const _=await Ae(e);if(!_||_.length===0){console.warn("未獲取到任何股票價格數據"),d.value=!1;return}const v={};_.forEach(z=>{if(!z)return;const H=z.originalSymbol||z.symbol;H&&(v[H]=z)}),console.log("已更新價格數據:",Object.keys(v).join(", ")),i.value=v;try{localStorage.setItem("investment-tracker-prices",JSON.stringify(v))}catch(z){console.error("無法儲存價格資料到本地存儲",z)}}catch(e){console.error("更新價格出錯",e)}finally{l&&(d.value=!1)}}},f=l=>{const e=o.value[l];T.value=l,x.symbol=e.symbol,x.name=e.name,x.market=e.market,x.cost=e.cost,x.quantity=e.quantity,x.purchaseDate=e.purchaseDate||"",S.value=!0},w=l=>{k.value=l},j=()=>{k.value!==null&&(n(k.value),Q(),k.value=null)},A=()=>{const l={symbol:x.symbol,name:x.name,market:x.market,cost:x.cost,quantity:x.quantity,purchaseDate:x.purchaseDate};T.value!==null?$(T.value,l):D(l),Q(),T.value=null,S.value=!1,M()},F=()=>{S.value=!1,T.value=null,M()},M=()=>{x.symbol="",x.name="",x.market="台股",x.cost=0,x.quantity=0,x.purchaseDate=new Date().toISOString().split("T")[0]},J=(l,e="TWD")=>{const _=e==="USD"?"US$":"NT$",v=new Intl.NumberFormat("zh-TW",{minimumFractionDigits:0,maximumFractionDigits:0}).format(l);return`${_}${v}`},K=l=>{if(!l||!i.value)return 0;const e=i.value[l.symbol]||i.value[`${l.symbol}.TW`]||Object.values(i.value).find(_=>_&&(_.originalSymbol===l.symbol||_.symbol===l.symbol||_.symbol===`${l.symbol}.TW`));return e&&e.price||0},B=l=>{if(!l)return"TWD";if(l.market==="美股")return"USD";if(i.value){const e=i.value[l.symbol]||i.value[`${l.symbol}.TW`]||Object.values(i.value).find(_=>_&&(_.originalSymbol===l.symbol||_.symbol===l.symbol||_.symbol===`${l.symbol}.TW`));if(e&&e.currency)return e.currency}return l.market==="美股"?"USD":"TWD"},st=l=>{const e=K(l);return e?`${B(l)==="USD"?"US$":"NT$"}${e.toFixed(2)}`:"載入中..."},c=l=>{if(!l||!i.value)return 0;const e=i.value[l.symbol]||i.value[`${l.symbol}.TW`]||Object.values(i.value).find(_=>_&&(_.originalSymbol===l.symbol||_.symbol===l.symbol||_.symbol===`${l.symbol}.TW`));return(e==null?void 0:e.change)||0},s=l=>{if(!l)return"載入中...";const e=K(l);if(!e)return"載入中...";const _=l.cost*l.quantity,z=e*l.quantity-_,H=_>0?z/_*100:0,it=B(l),at=z>=0?"+":"";return`${at}${J(z,it)} (${at}${H.toFixed(2)}%)`},I=(l,e)=>{if(!l||!e)return"";const _=l.cost*l.quantity,z=e*l.quantity-_;return z>0?"positive":z<0?"negative":""},y=(l,e)=>l==null?"-":`${e==="USD"?"US$":"NT$"}${l.toFixed(2)}`;return bt(async()=>{try{const l=localStorage.getItem("exchange-rate-cache");if(l){const _=JSON.parse(l);_.USD_TWD&&(h.value=_.USD_TWD,console.log(`從緩存讀取匯率: 1 USD = ${h.value} TWD`))}Q();const e=await Ue();e&&!isNaN(e)&&(h.value=e,console.log(`設置匯率: 1 USD = ${e} TWD`),b())}catch(l){console.error("頁面初始化時發生錯誤",l)}}),(l,e)=>{var _;return m(),g("div",null,[e[34]||(e[34]=t("h2",{class:"text-xl font-bold mb-4"},"持股管理",-1)),t("div",Oe,[t("div",Ee,[t("div",Me,[e[12]||(e[12]=t("h3",{class:"text-gray-500 text-sm"},"總投資成本",-1)),t("p",Be,u(J(N.value)),1)]),t("div",Le,[e[13]||(e[13]=t("h3",{class:"text-gray-500 text-sm"},"目前總市值",-1)),t("p",Ye,u(J(P.value)),1)]),t("div",Je,[e[14]||(e[14]=t("h3",{class:"text-gray-500 text-sm"},"未實現損益",-1)),t("p",{class:R(["text-lg font-semibold",tt(ut)(q.value)])},[ot(u(q.value>0?"+":"")+u(J(q.value))+" ",1),t("span",Ke," ("+u(G.value>0?"+":"")+u(G.value.toFixed(2))+"%) ",1)],2)])])]),o.value.length>0?(m(),g("div",He,[t("div",Ze,[t("div",null,[e[17]||(e[17]=t("h3",{class:"text-lg font-bold mb-3"},"市場分佈",-1)),t("div",Xe,[X(Nt,{"tw-value":a.value&&a.value.tw?a.value.tw.value:0,"us-value":a.value&&a.value.us?a.value.us.value:0},null,8,["tw-value","us-value"])]),t("div",Ge,[t("div",Qe,[e[15]||(e[15]=t("h4",{class:"text-sm text-gray-500"},"台股占比",-1)),t("p",ts,u(O.value&&O.value.tw?O.value.tw.toFixed(2):"0.00")+"% ",1)]),t("div",es,[e[16]||(e[16]=t("h4",{class:"text-sm text-gray-500"},"美股占比",-1)),t("p",ss,u(O.value&&O.value.us?O.value.us.toFixed(2):"0.00")+"% ",1)])])]),t("div",null,[e[22]||(e[22]=t("h3",{class:"text-lg font-bold mb-3"},"市場表現",-1)),t("div",ls,[X(Wt,{"tw-profit":a.value&&a.value.tw?a.value.tw.profit:0,"us-profit":a.value&&a.value.us?a.value.us.profit:0,"tw-cost":a.value&&a.value.tw?a.value.tw.cost:0,"us-cost":a.value&&a.value.us?a.value.us.cost:0},null,8,["tw-profit","us-profit","tw-cost","us-cost"])]),t("div",os,[a.value&&a.value.tw?(m(),g("div",{key:0,class:R(["bg-gray-50 p-3 rounded-lg",tt(ut)(a.value.tw.profit)])},[e[18]||(e[18]=t("h4",{class:"text-sm text-gray-500"},"台股損益",-1)),t("p",as,[ot(u(a.value.tw.profit>0?"+":"")+u(J(a.value.tw.profit))+" ",1),t("span",ns," ("+u(a.value.tw.cost>0?(a.value.tw.profit/a.value.tw.cost*100).toFixed(2)+"%":"0%")+") ",1)])],2)):(m(),g("div",rs,e[19]||(e[19]=[t("h4",{class:"text-sm text-gray-500"},"台股損益",-1),t("p",{class:"font-semibold"},"NT$0",-1)]))),a.value&&a.value.us?(m(),g("div",{key:2,class:R(["bg-gray-50 p-3 rounded-lg",tt(ut)(a.value.us.profit)])},[e[20]||(e[20]=t("h4",{class:"text-sm text-gray-500"},"美股損益",-1)),t("p",is,[ot(u(a.value.us.profit>0?"+":"")+u(J(a.value.us.profit))+" ",1),t("span",us," ("+u(a.value.us.cost>0?(a.value.us.profit/a.value.us.cost*100).toFixed(2)+"%":"0%")+") ",1)])],2)):(m(),g("div",cs,e[21]||(e[21]=[t("h4",{class:"text-sm text-gray-500"},"美股損益",-1),t("p",{class:"font-semibold"},"US$0",-1)])))])])])])):Z("",!0),t("div",ds,[t("div",ms,[t("button",{onClick:e[0]||(e[0]=v=>r.value="all"),class:R(["tab-btn mr-2 px-4 py-2 rounded-lg",r.value==="all"?"bg-primary text-white":"bg-gray-100"])}," 全部持股 ",2),t("button",{onClick:e[1]||(e[1]=v=>r.value="tw"),class:R(["tab-btn mr-2 px-4 py-2 rounded-lg",r.value==="tw"?"bg-primary text-white":"bg-gray-100"])}," 台股 ",2),t("button",{onClick:e[2]||(e[2]=v=>r.value="us"),class:R(["tab-btn px-4 py-2 rounded-lg",r.value==="us"?"bg-primary text-white":"bg-gray-100"])}," 美股 ",2)]),t("div",vs,[t("button",{onClick:e[3]||(e[3]=v=>S.value=!0),class:"btn btn-primary mr-2"}," + 新增持股 "),t("div",ps,[t("span",bs,"匯率: 1 USD = "+u(h.value.toFixed(2))+" TWD",1),t("button",{onClick:b,class:"btn bg-gray-100 text-gray-700 flex items-center"},[e[23]||(e[23]=t("span",{class:"mr-1"},"更新價格",-1)),d.value?(m(),g("span",fs,"⟳")):Z("",!0)])])])]),t("div",gs,[W.value.length===0?(m(),g("div",ys,u(r.value==="all"?"尚未新增持股資料，請點擊「新增持股」按鈕開始追蹤。":`尚無${r.value==="tw"?"台股":"美股"}資料。`),1)):(m(),g("div",hs,[t("table",xs,[e[24]||(e[24]=t("thead",null,[t("tr",null,[t("th",null,"代碼"),t("th",null,"名稱"),t("th",null,"市場"),t("th",null,"持有股數"),t("th",null,"成本價"),t("th",null,"目前價格"),t("th",null,"市值"),t("th",null,"損益"),t("th",null,"操作")])],-1)),t("tbody",null,[(m(!0),g(nt,null,rt(W.value,(v,z)=>(m(),g("tr",{key:z},[t("td",null,u(v.symbol),1),t("td",null,u(v.name),1),t("td",null,u(v.market),1),t("td",null,u(v.quantity),1),t("td",null,u(y(v.cost,B(v))),1),t("td",{class:R(tt(ut)(c(v)))},u(st(v)),3),t("td",null,u(K(v)?J(v.quantity*K(v),B(v)):"載入中..."),1),t("td",{class:R(I(v,K(v)))},u(s(v)),3),t("td",null,[t("div",_s,[t("button",{onClick:H=>f(L(v)),class:"text-primary text-sm"}," 編輯 ",8,ws),t("button",{onClick:H=>w(L(v)),class:"text-danger text-sm"}," 刪除 ",8,$s)])])]))),128))])])]))]),S.value?(m(),g("div",ks,[t("div",Ss,[t("h3",Ds,u(T.value===null?"新增持股":"編輯持股"),1),t("form",{onSubmit:Rt(A,["prevent"])},[t("div",Cs,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium mb-1"},"股票代碼",-1)),E(t("input",{"onUpdate:modelValue":e[4]||(e[4]=v=>x.symbol=v),required:"",class:"input w-full",placeholder:"例如：2330.TW 或 AAPL"},null,512),[[Y,x.symbol]])]),t("div",Ts,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium mb-1"},"股票名稱",-1)),E(t("input",{"onUpdate:modelValue":e[5]||(e[5]=v=>x.name=v),required:"",class:"input w-full",placeholder:"例如：台積電 或 蘋果"},null,512),[[Y,x.name]])]),t("div",Ps,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium mb-1"},"市場",-1)),E(t("select",{"onUpdate:modelValue":e[6]||(e[6]=v=>x.market=v),required:"",class:"input w-full"},e[27]||(e[27]=[t("option",{value:"台股"},"台股",-1),t("option",{value:"美股"},"美股",-1),t("option",{value:"其他"},"其他",-1)]),512),[[It,x.market]])]),t("div",qs,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium mb-1"},"成本價",-1)),E(t("input",{"onUpdate:modelValue":e[7]||(e[7]=v=>x.cost=v),type:"number",step:"0.01",required:"",class:"input w-full",placeholder:"每股成本"},null,512),[[Y,x.cost,void 0,{number:!0}]])]),t("div",Fs,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium mb-1"},"持有股數",-1)),E(t("input",{"onUpdate:modelValue":e[8]||(e[8]=v=>x.quantity=v),type:"number",required:"",class:"input w-full",placeholder:"持有數量"},null,512),[[Y,x.quantity,void 0,{number:!0}]])]),t("div",zs,[e[31]||(e[31]=t("label",{class:"block text-sm font-medium mb-1"},"購買日期",-1)),E(t("input",{"onUpdate:modelValue":e[9]||(e[9]=v=>x.purchaseDate=v),type:"date",class:"input w-full"},null,512),[[Y,x.purchaseDate]])]),t("div",{class:"flex justify-end space-x-3"},[t("button",{type:"button",onClick:F,class:"btn bg-gray-200 text-gray-800"}," 取消 "),e[32]||(e[32]=t("button",{type:"submit",class:"btn btn-primary"},"儲存",-1))])],32)])])):Z("",!0),k.value!==null?(m(),g("div",Vs,[t("div",Us,[e[33]||(e[33]=t("h3",{class:"text-lg font-bold mb-4"},"確認刪除",-1)),t("p",js," 確定要刪除「"+u((_=o.value[k.value])==null?void 0:_.name)+"」的持股資料嗎？ ",1),t("div",As,[t("button",{onClick:e[10]||(e[10]=v=>k.value=null),class:"btn bg-gray-200 text-gray-800"}," 取消 "),t("button",{onClick:e[11]||(e[11]=v=>j()),class:"btn btn-danger"}," 確認刪除 ")])])])):Z("",!0)])}}},Is={class:"card bg-white p-4 mb-6"},Ns={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ws={class:"p-3 bg-gray-50 rounded-lg"},Os={class:"p-3 bg-gray-50 rounded-lg"},Es={class:"text-lg font-semibold"},Ms={class:"p-3 bg-gray-50 rounded-lg"},Bs={key:0,class:"card bg-white p-4 mb-6"},Ls={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ys={class:"h-64 flex items-center justify-center"},Js={class:"grid grid-cols-2 gap-4 mt-3"},Ks={class:"bg-gray-50 p-3 rounded-lg"},Hs={class:"font-semibold"},Zs={class:"bg-gray-50 p-3 rounded-lg"},Xs={class:"font-semibold"},Gs={class:"h-64 flex items-center justify-center"},Qs={class:"grid grid-cols-2 gap-4 mt-3"},tl={class:"font-semibold"},el={class:"text-xs"},sl={class:"font-semibold"},ll={class:"text-xs"},ol={class:"flex justify-between items-center mb-4"},al={class:"tabs"},nl={class:"card"},rl={key:0,class:"text-center py-6 text-gray-500"},il={key:1,class:"table-container"},ul={class:"table"},cl={class:"flex space-x-2"},dl=["onClick"],ml=["onClick"],vl={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10"},pl={class:"bg-white rounded-lg p-6 max-w-md w-full"},bl={class:"text-lg font-bold mb-4"},fl={class:"mb-4"},gl={class:"mb-4"},yl={class:"mb-4"},hl={class:"mb-4"},xl={class:"mb-4"},_l={class:"mb-4"},wl={class:"mb-4"},$l=["value"],kl={class:"mb-4"},Sl={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10"},Dl={class:"bg-white rounded-lg p-6 max-w-md w-full"},Cl={class:"mb-4"},Tl={class:"flex justify-end space-x-3"},Pl={__name:"RealizedView",setup(C){dt.register(ht,mt,vt,xt,_t,wt,pt,Pt,qt);const{getRealizedTrades:p,addRealizedTrade:D,updateRealizedTrade:$,deleteRealizedTrade:n}=ft(),o=U([]),i=U(!1),S=U(null),T=U(null),k=U("all"),d=U(0),h=U(!0),r=At({symbol:"",name:"",sellPrice:0,quantity:0,buyPrice:0,date:new Date().toISOString().split("T")[0],market:"台股"}),x=V(()=>a.value.reduce((c,s)=>c+s.profit,0)),W=V(()=>{if(a.value.length===0)return 0;const c=a.value.reduce((I,y)=>I+y.cost,0);return c===0?0:a.value.reduce((I,y)=>I+y.profit,0)/c*100}),a=V(()=>k.value==="all"?G.value:k.value==="tw"?G.value.filter(c=>N(c,"台股")):k.value==="us"?G.value.filter(c=>N(c,"美股")):G.value),N=(c,s)=>c.market?c.market===s:s==="台股"?/^\d+$/.test(c.symbol.split(".")[0]):s==="美股"?/[A-Za-z]/.test(c.symbol):!1,P=V(()=>{const c={tw:{profit:0,cost:0},us:{profit:0,cost:0}};return o.value.length===0||o.value.forEach(s=>{N(s,"台股")?(c.tw.profit+=s.profit,c.tw.cost+=s.cost):N(s,"美股")&&(c.us.profit+=s.profit,c.us.cost+=s.cost)}),c}),q=V(()=>{const c=Math.abs(P.value.tw.profit),s=Math.abs(P.value.us.profit),I=c+s;return{tw:I>0?c/I*100:0,us:I>0?s/I*100:0}}),G=V(()=>[...o.value].sort((c,s)=>new Date(s.date)-new Date(c.date))),O=()=>{o.value=p(),d.value++,console.log("載入交易數據後更新圖表計數器:",d.value)},L=c=>o.value.findIndex(s=>s.symbol===c.symbol&&s.date===c.date&&s.profit===c.profit),Q=c=>{const s=o.value[c];S.value=c,r.symbol=s.symbol,r.name=s.name,r.market=s.market||(N(s,"台股")?"台股":"美股"),r.sellPrice=s.sellPrice,r.quantity=s.quantity,r.buyPrice=s.cost/s.quantity||0,r.date=s.date,i.value=!0},b=c=>{T.value=c},f=()=>{T.value!==null&&(n(T.value),O(),T.value=null)},w=()=>{const c=B(),I=r.sellPrice*r.quantity-c,y={symbol:r.symbol,name:r.name,market:r.market,sellPrice:r.sellPrice,quantity:r.quantity,cost:c,profit:I,date:r.date};S.value!==null?$(S.value,y):D(y),O(),S.value=null,i.value=!1,A()},j=()=>{i.value=!1,S.value=null,A()},A=()=>{r.symbol="",r.name="",r.market="台股",r.sellPrice=0,r.quantity=0,r.buyPrice=0,r.date=new Date().toISOString().split("T")[0]},F=c=>{const s="NT$",I=new Intl.NumberFormat("zh-TW",{minimumFractionDigits:0,maximumFractionDigits:0}).format(c);return`${s}${I}`},M=c=>`NT$${c.toFixed(2)}`,J=c=>Vt(c).format("YYYY/MM/DD"),K=c=>{if(c.cost===0)return"0.00%";const s=c.profit/c.cost*100;return`${s>=0?"+":""}${s.toFixed(2)}%`},B=()=>r.buyPrice*r.quantity,st=()=>{const c=B();return F(c)};return bt(()=>{O()}),zt(()=>{if(console.log("RealizedView 被激活, 初次掛載狀態:",h.value),h.value){h.value=!1;return}d.value++,console.log("激活時更新圖表計數器:",d.value),O(),setTimeout(()=>{d.value++,console.log("延遲後再次更新圖表計數器:",d.value)},300)}),(c,s)=>{var I;return m(),g("div",null,[s[34]||(s[34]=t("h2",{class:"text-xl font-bold mb-4"},"已實現收益",-1)),t("div",Is,[t("div",Ns,[t("div",Ws,[s[13]||(s[13]=t("h3",{class:"text-gray-500 text-sm"},"總實現收益",-1)),t("p",{class:R(["text-lg font-semibold",x.value>=0?"positive":"negative"])},u(x.value>0?"+":"")+u(F(x.value)),3)]),t("div",Os,[s[14]||(s[14]=t("h3",{class:"text-gray-500 text-sm"},"總交易次數",-1)),t("p",Es,u(o.value.length)+" 次",1)]),t("div",Ms,[s[15]||(s[15]=t("h3",{class:"text-gray-500 text-sm"},"平均報酬率",-1)),t("p",{class:R(["text-lg font-semibold",W.value>=0?"positive":"negative"])},u(W.value>0?"+":"")+u(W.value.toFixed(2))+"% ",3)])])]),o.value.length>0?(m(),g("div",Bs,[t("div",Ls,[t("div",null,[s[18]||(s[18]=t("h3",{class:"text-lg font-bold mb-3"},"市場分佈",-1)),t("div",Ys,[X(Nt,{"tw-value":P.value.tw.profit,"us-value":P.value.us.profit},null,8,["tw-value","us-value"])]),t("div",Js,[t("div",Ks,[s[16]||(s[16]=t("h4",{class:"text-sm text-gray-500"},"台股占比",-1)),t("p",Hs,u(q.value.tw.toFixed(2))+"% ",1)]),t("div",Zs,[s[17]||(s[17]=t("h4",{class:"text-sm text-gray-500"},"美股占比",-1)),t("p",Xs,u(q.value.us.toFixed(2))+"% ",1)])])]),t("div",null,[s[21]||(s[21]=t("h3",{class:"text-lg font-bold mb-3"},"市場表現",-1)),t("div",Gs,[X(Wt,{"tw-profit":P.value.tw.profit,"us-profit":P.value.us.profit,"tw-cost":P.value.tw.cost,"us-cost":P.value.us.cost},null,8,["tw-profit","us-profit","tw-cost","us-cost"])]),t("div",Qs,[t("div",{class:R(["bg-gray-50 p-3 rounded-lg",P.value.tw.profit>=0?"positive":"negative"])},[s[19]||(s[19]=t("h4",{class:"text-sm text-gray-500"},"台股損益",-1)),t("p",tl,[ot(u(P.value.tw.profit>0?"+":"")+u(F(P.value.tw.profit))+" ",1),t("span",el," ("+u(P.value.tw.cost>0?(P.value.tw.profit/P.value.tw.cost*100).toFixed(2)+"%":"0%")+") ",1)])],2),t("div",{class:R(["bg-gray-50 p-3 rounded-lg",P.value.us.profit>=0?"positive":"negative"])},[s[20]||(s[20]=t("h4",{class:"text-sm text-gray-500"},"美股損益",-1)),t("p",sl,[ot(u(P.value.us.profit>0?"+":"")+u(F(P.value.us.profit))+" ",1),t("span",ll," ("+u(P.value.us.cost>0?(P.value.us.profit/P.value.us.cost*100).toFixed(2)+"%":"0%")+") ",1)])],2)])])])])):Z("",!0),t("div",ol,[t("div",al,[t("button",{onClick:s[0]||(s[0]=y=>k.value="all"),class:R(["tab-btn mr-2 px-4 py-2 rounded-lg",k.value==="all"?"bg-primary text-white":"bg-gray-100"])}," 全部交易 ",2),t("button",{onClick:s[1]||(s[1]=y=>k.value="tw"),class:R(["tab-btn mr-2 px-4 py-2 rounded-lg",k.value==="tw"?"bg-primary text-white":"bg-gray-100"])}," 台股 ",2),t("button",{onClick:s[2]||(s[2]=y=>k.value="us"),class:R(["tab-btn px-4 py-2 rounded-lg",k.value==="us"?"bg-primary text-white":"bg-gray-100"])}," 美股 ",2)]),t("button",{onClick:s[3]||(s[3]=y=>i.value=!0),class:"btn btn-primary"}," + 新增已實現收益 ")]),t("div",nl,[a.value.length===0?(m(),g("div",rl,u(k.value==="all"?"尚未新增已實現收益資料，請點擊「新增已實現收益」按鈕進行新增。":`尚無${k.value==="tw"?"台股":"美股"}已實現交易資料。`),1)):(m(),g("div",il,[t("table",ul,[s[22]||(s[22]=t("thead",null,[t("tr",null,[t("th",null,"日期"),t("th",null,"代碼"),t("th",null,"名稱"),t("th",null,"市場"),t("th",null,"賣出價格"),t("th",null,"數量"),t("th",null,"總成本"),t("th",null,"實現損益"),t("th",null,"報酬率"),t("th",null,"操作")])],-1)),t("tbody",null,[(m(!0),g(nt,null,rt(a.value,(y,l)=>(m(),g("tr",{key:l},[t("td",null,u(J(y.date)),1),t("td",null,u(y.symbol),1),t("td",null,u(y.name),1),t("td",null,u(y.market||(N(y,"台股")?"台股":"美股")),1),t("td",null,u(M(y.sellPrice)),1),t("td",null,u(y.quantity),1),t("td",null,u(F(y.cost)),1),t("td",{class:R(y.profit>=0?"positive":"negative")},u(y.profit>0?"+":"")+u(F(y.profit)),3),t("td",{class:R(y.profit>=0?"positive":"negative")},u(K(y)),3),t("td",null,[t("div",cl,[t("button",{onClick:e=>Q(L(y)),class:"text-primary text-sm"}," 編輯 ",8,dl),t("button",{onClick:e=>b(L(y)),class:"text-danger text-sm"}," 刪除 ",8,ml)])])]))),128))])])]))]),i.value?(m(),g("div",vl,[t("div",pl,[t("h3",bl,u(S.value===null?"新增已實現收益":"編輯已實現收益"),1),t("form",{onSubmit:Rt(w,["prevent"])},[t("div",fl,[s[23]||(s[23]=t("label",{class:"block text-sm font-medium mb-1"},"股票代碼",-1)),E(t("input",{"onUpdate:modelValue":s[4]||(s[4]=y=>r.symbol=y),required:"",class:"input w-full",placeholder:"例如：2330.TW 或 AAPL"},null,512),[[Y,r.symbol]])]),t("div",gl,[s[24]||(s[24]=t("label",{class:"block text-sm font-medium mb-1"},"股票名稱",-1)),E(t("input",{"onUpdate:modelValue":s[5]||(s[5]=y=>r.name=y),required:"",class:"input w-full",placeholder:"例如：台積電 或 蘋果"},null,512),[[Y,r.name]])]),t("div",yl,[s[26]||(s[26]=t("label",{class:"block text-sm font-medium mb-1"},"市場",-1)),E(t("select",{"onUpdate:modelValue":s[6]||(s[6]=y=>r.market=y),required:"",class:"input w-full"},s[25]||(s[25]=[t("option",{value:"台股"},"台股",-1),t("option",{value:"美股"},"美股",-1),t("option",{value:"其他"},"其他",-1)]),512),[[It,r.market]])]),t("div",hl,[s[27]||(s[27]=t("label",{class:"block text-sm font-medium mb-1"},"賣出價格",-1)),E(t("input",{"onUpdate:modelValue":s[7]||(s[7]=y=>r.sellPrice=y),type:"number",step:"0.01",required:"",class:"input w-full",placeholder:"每股賣出價格"},null,512),[[Y,r.sellPrice,void 0,{number:!0}]])]),t("div",xl,[s[28]||(s[28]=t("label",{class:"block text-sm font-medium mb-1"},"數量",-1)),E(t("input",{"onUpdate:modelValue":s[8]||(s[8]=y=>r.quantity=y),type:"number",required:"",class:"input w-full",placeholder:"賣出數量"},null,512),[[Y,r.quantity,void 0,{number:!0}]])]),t("div",_l,[s[29]||(s[29]=t("label",{class:"block text-sm font-medium mb-1"},"買入價格",-1)),E(t("input",{"onUpdate:modelValue":s[9]||(s[9]=y=>r.buyPrice=y),type:"number",step:"0.01",required:"",class:"input w-full",placeholder:"每股買入價格"},null,512),[[Y,r.buyPrice,void 0,{number:!0}]])]),t("div",wl,[s[30]||(s[30]=t("label",{class:"block text-sm font-medium mb-1"},"總成本",-1)),t("input",{value:st(),type:"number",step:"0.01",disabled:"",class:"input w-full bg-gray-100"},null,8,$l)]),t("div",kl,[s[31]||(s[31]=t("label",{class:"block text-sm font-medium mb-1"},"賣出日期",-1)),E(t("input",{"onUpdate:modelValue":s[10]||(s[10]=y=>r.date=y),type:"date",required:"",class:"input w-full"},null,512),[[Y,r.date]])]),t("div",{class:"flex justify-end space-x-3"},[t("button",{type:"button",onClick:j,class:"btn bg-gray-200 text-gray-800"}," 取消 "),s[32]||(s[32]=t("button",{type:"submit",class:"btn btn-primary"},"儲存",-1))])],32)])])):Z("",!0),T.value!==null?(m(),g("div",Sl,[t("div",Dl,[s[33]||(s[33]=t("h3",{class:"text-lg font-bold mb-4"},"確認刪除",-1)),t("p",Cl," 確定要刪除「"+u((I=o.value[T.value])==null?void 0:I.name)+"」的已實現收益資料嗎？ ",1),t("div",Tl,[t("button",{onClick:s[11]||(s[11]=y=>T.value=null),class:"btn bg-gray-200 text-gray-800"}," 取消 "),t("button",{onClick:s[12]||(s[12]=y=>f()),class:"btn btn-danger"}," 確認刪除 ")])])])):Z("",!0)])}}},ql=[{path:"/",component:Rs},{path:"/realized",component:Pl},{path:"/charts",component:Ve}],Fl=Zt({history:Xt(),routes:ql}),Ot=Gt(ue);Ot.use(Fl);Ot.mount("#app");
