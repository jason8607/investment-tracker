import{r as Dt,o as v,c as g,a as t,F as nt,b as rt,d as Q,w as ht,t as i,u as et,e as Lt,f as Yt,g as at,n as j,T as Jt,h as dt,i as Kt,K as Zt,C as mt,A as xt,p as vt,j as pt,k as _t,L as wt,B as $t,P as qt,l as Ft,m as bt,q as N,s as V,v as zt,x as ft,y as Ht,z as Nt,D as tt,E as L,G as Vt,H as Ut,I as Xt,J as At,M as Gt,N as kt,O as Ct,Q as jt,R as Rt,S as O,U as H,V as It,W as Qt,X as te,Y as ee}from"./vendor-386eb522.js";(function(){const m=document.createElement("link").relList;if(m&&m.supports&&m.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))u(d);new MutationObserver(d=>{for(const l of d)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&u(c)}).observe(document,{childList:!0,subtree:!0});function C(d){const l={};return d.integrity&&(l.integrity=d.integrity),d.referrerPolicy&&(l.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?l.credentials="include":d.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function u(d){if(d.ep)return;d.ep=!0;const l=C(d);fetch(d.href,l)}})();const Tt="investment-tracker-stocks",Pt="investment-tracker-realized";function gt(){const S=()=>{try{const p=localStorage.getItem(Tt);return p?JSON.parse(p):[]}catch(p){return console.error("無法讀取持股資料",p),[]}},m=p=>{try{localStorage.setItem(Tt,JSON.stringify(p))}catch(_){console.error("無法儲存持股資料",_)}},C=p=>{const _=S();_.push(p),m(_)},u=(p,_)=>{const o=S();o[p]=_,m(o)},d=p=>{const _=S();_.splice(p,1),m(_)},l=()=>{try{const p=localStorage.getItem(Pt);return p?JSON.parse(p):[]}catch(p){return console.error("無法讀取已實現收益資料",p),[]}},c=p=>{try{localStorage.setItem(Pt,JSON.stringify(p))}catch(_){console.error("無法儲存已實現收益資料",_)}};return{getStocks:S,setStocks:m,addStock:C,updateStock:u,deleteStock:d,getRealizedTrades:l,setRealizedTrades:c,addRealizedTrade:p=>{const _=l();_.push(p),c(_)},updateRealizedTrade:(p,_)=>{const o=l();o[p]=_,c(o)},deleteRealizedTrade:p=>{const _=l();_.splice(p,1),c(_)}}}const se={class:"min-h-screen"},le={class:"bg-primary text-white p-4 shadow-md"},ae={class:"container mx-auto flex justify-between items-center"},oe={class:"flex space-x-2"},ne={class:"btn bg-secondary text-white text-sm px-3 py-1 cursor-pointer"},re={class:"bg-white shadow-sm"},ie={class:"container mx-auto"},ue={class:"flex"},ce={class:"container mx-auto p-4"},de={class:"bg-gray-100 text-gray-600 p-4 text-center text-sm"},me={__name:"App",setup(S){const{getStocks:m,getRealizedTrades:C,setStocks:u,setRealizedTrades:d}=gt(),l=[{name:"持股管理",path:"/"},{name:"已實現收益",path:"/realized"},{name:"圖表分析",path:"/charts"}],c=()=>{const D=et.book_new(),k=m(),p=C(),_=k.map(P=>({股票代碼:P.symbol,股票名稱:P.name,市場:P.market,成本價:P.cost,數量:P.quantity,購買日期:P.purchaseDate})),o=p.map(P=>({股票代碼:P.symbol,股票名稱:P.name,賣出價格:P.sellPrice,數量:P.quantity,成本:P.cost,實現損益:P.profit,日期:P.date})),y=et.json_to_sheet(_),R=et.json_to_sheet(o);et.book_append_sheet(D,y,"持股紀錄"),et.book_append_sheet(D,R,"已實現收益"),Lt(D,"投資損益資料.xlsx")},T=D=>{const k=D.target.files[0];if(!k)return;const p=new FileReader;p.onload=_=>{const o=new Uint8Array(_.target.result),y=Yt(o,{type:"array"}),R=y.Sheets.持股紀錄;if(R){const n=et.sheet_to_json(R).map(q=>({symbol:q.股票代碼,name:q.股票名稱,market:q.市場,cost:parseFloat(q.成本價),quantity:parseInt(q.數量),purchaseDate:q.購買日期}));u(n)}const P=y.Sheets.已實現收益;if(P){const n=et.sheet_to_json(P).map(q=>({symbol:q.股票代碼,name:q.股票名稱,sellPrice:parseFloat(q.賣出價格),quantity:parseInt(q.數量),cost:parseFloat(q.成本),profit:parseFloat(q.實現損益),date:q.日期}));d(n)}D.target.value="",alert("資料匯入成功！")},p.readAsArrayBuffer(k)};return(D,k)=>{const p=Dt("router-link"),_=Dt("router-view");return v(),g("div",se,[t("header",le,[t("div",ae,[k[3]||(k[3]=t("h1",{class:"text-xl md:text-2xl font-bold"},"投資損益小幫手",-1)),t("div",oe,[t("button",{onClick:c,class:"btn bg-secondary text-white text-sm px-3 py-1"},k[0]||(k[0]=[t("span",{class:"hidden md:inline"},"匯出資料",-1),t("span",{class:"md:hidden"},"匯出",-1)])),t("label",ne,[k[1]||(k[1]=t("span",{class:"hidden md:inline"},"匯入資料",-1)),k[2]||(k[2]=t("span",{class:"md:hidden"},"匯入",-1)),t("input",{type:"file",accept:".xlsx",class:"hidden",onChange:T},null,32)])])])]),t("nav",re,[t("div",ie,[t("ul",ue,[(v(),g(nt,null,rt(l,o=>t("li",{key:o.path},[Q(p,{to:o.path,class:j(["block px-4 py-3 hover:bg-gray-100 transition-colors border-b-2",D.$route.path===o.path?"border-primary text-primary font-medium":"border-transparent"])},{default:ht(()=>[at(i(o.name),1)]),_:2},1032,["to","class"])])),64))])])]),t("main",ce,[Q(_,null,{default:ht(({Component:o})=>[Q(Jt,{name:"fade",mode:"out-in"},{default:ht(()=>[(v(),dt(Zt,null,[(v(),dt(Kt(o),{key:D.$route.path}))],1024))]),_:2},1024)]),_:1})]),t("footer",de,[t("p",null,"投資損益小幫手 © "+i(new Date().getFullYear()),1)])])}}};const ve={class:"mb-6"},pe={class:"flex flex-wrap space-x-2"},be=["onClick"],fe={class:"card"},ge={key:0,class:"p-4"},ye={key:0,class:"text-center py-6 text-gray-500"},he={key:1,class:"flex flex-col md:flex-row"},xe={class:"w-full md:w-1/2 min-h-[300px]"},_e={key:0},we={key:1,class:"h-[300px] flex items-center justify-center"},$e={class:"w-full md:w-1/2 p-4"},ke={class:"flex-1"},Se={class:"text-right"},De={key:1,class:"p-4"},Ce={key:0,class:"text-center py-6 text-gray-500"},Te={key:1,class:"min-h-[300px]"},Pe={key:0},qe={key:1,class:"h-[300px] flex items-center justify-center"},Fe={key:2,class:"p-4"},ze={key:0,class:"text-center py-6 text-gray-500"},Ne={key:1,class:"min-h-[300px]"},Ve={key:0},Ue={key:1,class:"h-[300px] flex items-center justify-center"},Ae={__name:"ChartsView",setup(S){mt.register(xt,vt,pt,_t,wt,$t,qt,Ft,bt);const{getStocks:m,getRealizedTrades:C}=gt(),u=N("allocation"),d=N([]),l=N([]),c=N({}),T=N(!1),D=N(!0),k=[{id:"allocation",name:"持股分配"},{id:"profit",name:"總體損益"},{id:"realized",name:"已實現收益趨勢"}],p=["#4CAF50","#2196F3","#F44336","#FF9800","#9C27B0","#3F51B5","#009688","#795548","#607D8B","#E91E63"],_=V(()=>d.value&&d.value.length>0),o=V(()=>l.value&&l.value.length>0),y=V(()=>_.value||o.value);zt([d,l,c],()=>{(_.value||o.value)&&Object.keys(c.value).length>0&&(console.log("圖表數據已就緒"),T.value=!0)},{deep:!0});const R=V(()=>{if(!_.value)return[];const h=d.value.map(w=>{var F;const A=(((F=c.value[w.symbol])==null?void 0:F.price)||w.cost)*w.quantity;return{...w,marketValue:A}}),b=h.reduce((w,U)=>w+U.marketValue,0);return h.map(w=>({...w,percentage:w.marketValue/b*100})).sort((w,U)=>U.marketValue-w.marketValue)}),P=V(()=>_.value?{labels:R.value.map(h=>h.name),datasets:[{data:R.value.map(h=>h.marketValue),backgroundColor:R.value.map((h,b)=>p[b%p.length]),hoverOffset:4}]}:{labels:[],datasets:[{data:[],backgroundColor:[],hoverOffset:4}]}),W=V(()=>{const h=["未實現損益","已實現收益","總體損益"];if(!y.value)return{labels:h,datasets:[{label:"損益金額",data:[0,0,0],backgroundColor:Array(3).fill("rgba(200, 200, 200, 0.6)"),borderColor:Array(3).fill("rgb(200, 200, 200)"),borderWidth:1}]};const b=d.value.reduce((F,K)=>{var Z;const st=(((Z=c.value[K.symbol])==null?void 0:Z.price)||K.cost)*K.quantity,M=K.cost*K.quantity;return F+(st-M)},0),w=l.value.reduce((F,K)=>F+K.profit,0),U=b+w,A=[b,w,U];return{labels:h,datasets:[{label:"損益金額",data:A,backgroundColor:A.map(F=>F>=0?"rgba(76, 175, 80, 0.6)":"rgba(244, 67, 54, 0.6)"),borderColor:A.map(F=>F>=0?"rgb(76, 175, 80)":"rgb(244, 67, 54)"),borderWidth:1}]}}),n=V(()=>{if(!o.value)return{labels:[],datasets:[{label:"累計已實現收益",data:[],borderColor:"rgb(54, 162, 235)",backgroundColor:"rgba(54, 162, 235, 0.5)",tension:.1,pointBackgroundColor:[]}]};const h=[...l.value].sort((A,F)=>new Date(A.date)-new Date(F.date));let b=0;const w=[],U=[];return h.forEach(A=>{b+=A.profit,w.push(b),U.push(Vt(A.date).format("YYYY/MM/DD"))}),{labels:U,datasets:[{label:"累計已實現收益",data:w,borderColor:"rgb(54, 162, 235)",backgroundColor:"rgba(54, 162, 235, 0.5)",tension:.1,pointBackgroundColor:w.map(A=>A>=0?"rgb(76, 175, 80)":"rgb(244, 67, 54)")}]}}),q={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(h){const b=h.label||"",w=h.raw||0,U=w/h.dataset.data.reduce((A,F)=>A+F,0)*100;return`${b}: ${J(w)} (${U.toFixed(2)}%)`}}}}},X={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(h){return`${h.dataset.label}: ${J(h.raw)}`}}}},scales:{y:{beginAtZero:!0,ticks:{callback:function(h){return J(h)}}}}},Y={responsive:!0,maintainAspectRatio:!1,plugins:{tooltip:{callbacks:{label:function(h){return`${h.dataset.label}: ${J(h.raw)}`}}}},scales:{y:{ticks:{callback:function(h){return J(h)}}}}},J=h=>new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0,maximumFractionDigits:0}).format(h),E=()=>{try{T.value=!1,d.value=m()||[],l.value=C()||[],console.log(`載入了 ${d.value.length} 支股票和 ${l.value.length} 筆交易記錄`);const h={};d.value.forEach(b=>{b&&b.symbol&&(h[b.symbol]={price:b.cost||0,change:0,changePercent:0})}),c.value=h;try{const b=localStorage.getItem("investment-tracker-prices");if(b){const w=JSON.parse(b);w&&typeof w=="object"&&(c.value={...c.value,...w})}}catch(b){console.error("無法讀取價格資料",b)}setTimeout(()=>{d.value&&d.value.length>0||l.value&&l.value.length>0?(console.log("圖表數據驗證成功，準備渲染圖表"),T.value=!0):console.log("無有效數據，不渲染圖表")},100)}catch(h){console.error("載入數據時出錯:",h),d.value=[],l.value=[],c.value={},T.value=!1}};return ft(()=>{console.log("圖表分析頁面加載中...");try{E(),D.value=!1;const h=b=>{(b.key==="investment-tracker-stocks"||b.key==="investment-tracker-realized"||b.key==="investment-tracker-prices")&&(console.log("儲存數據變更，重新載入圖表數據"),T.value=!1,setTimeout(()=>{E()},50))};window.addEventListener("storage",h),Ht(()=>{console.log("移除儲存變化事件監聽器"),window.removeEventListener("storage",h)})}catch(h){console.error("圖表分析頁面初始化失敗:",h),d.value=[],l.value=[],c.value={},T.value=!1}}),Nt(()=>{if(console.log("圖表分析頁面激活中，初次掛載狀態:",D.value),D.value){D.value=!1;return}try{E()}catch(h){console.error("圖表分析頁面激活時失敗:",h)}}),(h,b)=>(v(),g("div",null,[b[7]||(b[7]=t("h2",{class:"text-xl font-bold mb-4"},"圖表分析",-1)),t("div",ve,[t("div",pe,[(v(),g(nt,null,rt(k,w=>t("button",{key:w.id,onClick:U=>u.value=w.id,class:j(["px-4 py-2 rounded-md transition-colors mb-2",u.value===w.id?"bg-primary text-white":"bg-gray-100 text-gray-700"])},i(w.name),11,be)),64))])]),t("div",fe,[u.value==="allocation"?(v(),g("div",ge,[b[2]||(b[2]=t("h3",{class:"text-lg font-medium mb-4"},"持股分配",-1)),_.value?(v(),g("div",he,[t("div",xe,[T.value&&P.value.datasets[0].data.length>0?(v(),g("div",_e,[Q(tt(Ut),{data:P.value,options:q,height:250},null,8,["data"])])):(v(),g("div",we,b[0]||(b[0]=[t("p",{class:"text-gray-500"},"正在載入圖表...",-1)])))]),t("div",$e,[b[1]||(b[1]=t("h4",{class:"text-md font-medium mb-2"},"持股比例",-1)),(v(!0),g(nt,null,rt(R.value,(w,U)=>(v(),g("div",{key:U,class:"flex items-center mb-2"},[t("div",{class:"w-4 h-4 rounded-full mr-2",style:Xt({backgroundColor:p[U%p.length]})},null,4),t("div",ke,i(w.name)+" ("+i(w.symbol)+")",1),t("div",Se,i(w.percentage.toFixed(2))+"%",1)]))),128))])])):(v(),g("div",ye," 尚未新增持股資料，請先在持股管理頁面新增股票。 "))])):L("",!0),u.value==="profit"?(v(),g("div",De,[b[4]||(b[4]=t("h3",{class:"text-lg font-medium mb-4"},"總體損益",-1)),y.value?(v(),g("div",Te,[T.value&&W.value.datasets[0].data.length>0?(v(),g("div",Pe,[Q(tt(At),{data:W.value,options:X,height:250},null,8,["data"])])):(v(),g("div",qe,b[3]||(b[3]=[t("p",{class:"text-gray-500"},"正在載入圖表...",-1)])))])):(v(),g("div",Ce," 尚未有足夠資料，請先新增持股或已實現收益。 "))])):L("",!0),u.value==="realized"?(v(),g("div",Fe,[b[6]||(b[6]=t("h3",{class:"text-lg font-medium mb-4"},"已實現收益分析",-1)),o.value?(v(),g("div",Ne,[T.value&&n.value.datasets[0].data.length>0?(v(),g("div",Ve,[Q(tt(Gt),{data:n.value,options:Y,height:250},null,8,["data"])])):(v(),g("div",Ue,b[5]||(b[5]=[t("p",{class:"text-gray-500"},"正在載入圖表...",-1)])))])):(v(),g("div",ze," 尚未新增已實現收益資料，請先在已實現收益頁面新增資料。 "))])):L("",!0)])]))}},St="https://yahoo-finance-backend.vercel.app";let lt={USD_TWD:null,lastUpdated:null};async function je(){const S=new Date;if(lt.USD_TWD&&lt.lastUpdated&&S-lt.lastUpdated<36e5)return console.log("使用緩存的匯率數據"),lt.USD_TWD;try{const m=["USDTWD=X","TWD=X"];let C,u=null;for(const d of m)try{const l=`${St}/api/stock/${d}`;if(console.log(`請求美元兌台幣匯率 (${d})...`),C=await kt.get(l,{headers:{Accept:"application/json","Cache-Control":"no-cache"},timeout:1e4}),!C.data.error&&C.data.price){u=C.data.price,console.log(`成功獲取美元兌台幣匯率: 1 USD = ${u} TWD (使用${d})`);break}}catch(l){console.error(`使用 ${d} 獲取匯率失敗:`,l.message)}u||(console.log("無法從API獲取匯率，使用預設值"),u=30),lt={USD_TWD:u,lastUpdated:S};try{localStorage.setItem("exchange-rate-cache",JSON.stringify(lt))}catch(d){console.error("無法將匯率數據存入localStorage",d)}return u}catch(m){console.error("獲取匯率失敗:",m);try{const C=localStorage.getItem("exchange-rate-cache");if(C){const u=JSON.parse(C);return console.log("使用localStorage中的匯率數據"),u.USD_TWD}}catch(C){console.error("讀取緩存匯率失敗",C)}return 30}}async function Wt(S){const m=S,C=`${St}/api/stock/${S}`;console.log(`請求股票數據：${S}`);try{const u=await kt.get(C,{headers:{Accept:"application/json","Cache-Control":"no-cache"},timeout:1e4});if(u.data.error)throw new Error(`API 錯誤: ${u.data.error}`);return console.log(`成功獲取 ${S} 價格: ${u.data.price} ${u.data.currency}`),{...u.data,originalSymbol:m,name:u.data.name||u.data.shortName||u.data.longName||"未知股票"}}catch(u){throw console.error(`獲取 ${S} 價格失敗:`,u),u.response?new Error(`API 請求失敗: ${u.response.status} ${u.response.statusText}`):u.request?new Error("無法連接到服務器，請檢查網絡連接"):u}}async function Re(S){const m=S.filter(u=>u&&u.trim());if(m.length===0)return[];const C=`${St}/api/stocks?symbols=${m.join(",")}`;console.log(`批量獲取股票數據: ${m.join(", ")}`);try{const u=await kt.get(C,{headers:{Accept:"application/json","Cache-Control":"no-cache"},timeout:15e3});return console.log(`成功獲取 ${u.data.length} 支股票數據`),u.data.map((l,c)=>(l.originalSymbol||(l.originalSymbol=m[c]),l.name||(l.name=l.shortName||l.longName||"未知股票"),l))}catch(u){console.error("批量獲取股票數據失敗:",u),console.log("嘗試逐個獲取股票數據...");const d=m.map(l=>Wt(l).catch(c=>(console.error(`獲取 ${l} 數據失敗:`,c),{error:!0,errorMessage:c.message||"未知錯誤",symbol:normalizeSymbol(l),originalSymbol:l,name:"未知股票"})));return Promise.all(d)}}async function Ot(S){try{const m=await Wt(S);return m.name||m.shortName||m.longName||"未知股票"}catch(m){return console.error(`獲取股票 ${S} 名稱失敗:`,m),null}}function ct(S){return S==null?"":S>0?"positive":S<0?"negative":""}const Ie={class:"market-pie-chart",style:{width:"250px",height:"250px"}},We={key:1,class:"text-center text-gray-500 h-full flex items-center justify-center"},Et={__name:"MarketPieChart",props:{twValue:{type:Number,required:!0},usValue:{type:Number,required:!0}},setup(S){mt.register(xt,vt,pt,bt);const m=S,C=V(()=>{const d=m.twValue>0||m.usValue>0;return{labels:["台股","美股"],datasets:[{backgroundColor:["#36A2EB","#FF6384"],data:d?[m.twValue,m.usValue]:[]}]}}),u={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"},tooltip:{callbacks:{label:d=>{const l=d.label||"",c=d.raw||0,T=m.twValue+m.usValue,D=T>0?(c/T*100).toFixed(2):0;return`${l}: ${D}%`}}}}};return(d,l)=>(v(),g("div",Ie,[C.value.datasets[0].data.length>0?(v(),dt(tt(Ut),{key:0,data:C.value,options:u,height:250},null,8,["data"])):(v(),g("div",We," 暫無資料 "))]))}},Oe={class:"market-bar-chart",style:{width:"250px",height:"250px"}},Ee={key:1,class:"text-center text-gray-500 h-full flex items-center justify-center"},Mt={__name:"MarketBarChart",props:{twProfit:{type:Number,required:!0},usProfit:{type:Number,required:!0},twCost:{type:Number,required:!0},usCost:{type:Number,required:!0}},setup(S){mt.register(_t,wt,$t,bt,vt,pt);const m=S,C=(l,c)=>c<=0?0:l/c*100,u=V(()=>{const l=C(m.twProfit,m.twCost),c=C(m.usProfit,m.usCost),T=m.twCost>0||m.usCost>0;return{labels:["台股","美股"],datasets:[{label:"報酬率 (%)",backgroundColor:[l>=0?"rgba(76, 175, 80, 0.6)":"rgba(244, 67, 54, 0.6)",c>=0?"rgba(76, 175, 80, 0.6)":"rgba(244, 67, 54, 0.6)"],borderColor:[l>=0?"rgba(76, 175, 80, 1)":"rgba(244, 67, 54, 1)",c>=0?"rgba(76, 175, 80, 1)":"rgba(244, 67, 54, 1)"],borderWidth:1,data:T?[l,c]:[]}]}}),d={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:l=>`報酬率: ${(l.raw||0).toFixed(2)}%`}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"報酬率 (%)"},ticks:{callback:function(l){return l+"%"}}}}};return ft(()=>{Ct(()=>{u.value.datasets[0].data.length>0&&console.log("Chart data loaded:",u.value)})}),zt(()=>[m.twProfit,m.usProfit,m.twCost,m.usCost],()=>{Ct(()=>{console.log("Props updated, chart should re-render")})}),(l,c)=>(v(),g("div",Oe,[u.value.datasets[0].data.length>0?(v(),dt(tt(At),{key:0,data:u.value,options:d,height:250},null,8,["data"])):(v(),g("div",Ee," 暫無資料 "))]))}},Me={class:"card bg-white p-4 mb-6"},Be={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Le={class:"p-3 bg-gray-50 rounded-lg"},Ye={class:"text-lg font-semibold"},Je={class:"p-3 bg-gray-50 rounded-lg"},Ke={class:"text-lg font-semibold"},Ze={class:"p-3 bg-gray-50 rounded-lg"},He={class:"text-sm"},Xe={key:0,class:"card bg-white p-4 mb-6"},Ge={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Qe={class:"h-64 flex items-center justify-center"},ts={class:"grid grid-cols-2 gap-4 mt-3"},es={class:"bg-gray-50 p-3 rounded-lg"},ss={class:"font-semibold"},ls={class:"bg-gray-50 p-3 rounded-lg"},as={class:"font-semibold"},os={class:"h-64 flex items-center justify-center"},ns={class:"grid grid-cols-2 gap-4 mt-3"},rs={class:"font-semibold"},is={class:"text-xs"},us={key:1,class:"bg-gray-50 p-3 rounded-lg"},cs={class:"font-semibold"},ds={class:"text-xs"},ms={key:3,class:"bg-gray-50 p-3 rounded-lg"},vs={class:"flex justify-between items-center mb-4"},ps={class:"tabs"},bs={class:"flex items-center"},fs={class:"flex items-center"},gs={class:"text-sm text-gray-500 mr-3"},ys={key:0,class:"inline-block animate-spin"},hs={class:"card"},xs={key:0,class:"text-center py-6 text-gray-500"},_s={key:1,class:"table-container"},ws={class:"table"},$s={class:"flex space-x-2"},ks=["onClick"],Ss=["onClick"],Ds={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10"},Cs={class:"bg-white rounded-lg p-6 max-w-md w-full"},Ts={class:"text-lg font-bold mb-4"},Ps={class:"mb-4"},qs={class:"mb-4"},Fs=["disabled"],zs={key:0,class:"text-sm text-gray-500 mt-1"},Ns={class:"mb-4"},Vs={class:"mb-4"},Us={class:"mb-4"},As={class:"mb-4"},js={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10"},Rs={class:"bg-white rounded-lg p-6 max-w-md w-full"},Is={class:"mb-4"},Ws={class:"flex justify-end space-x-3"},Os={__name:"HomeView",setup(S){const{getStocks:m,addStock:C,updateStock:u,deleteStock:d}=gt(),l=N([]),c=N({}),T=N(!1),D=N(null),k=N(null),p=N(!1),_=N(30),o=N("all"),y=jt({symbol:"",name:"",market:"台股",cost:0,quantity:0,purchaseDate:new Date().toISOString().split("T")[0]}),R=N(!1),P=async()=>{if(y.symbol){R.value=!0;try{const a=await Ot(y.symbol);a&&(y.name=a,console.log(`自動獲取股票名稱: ${y.symbol} -> ${a}`))}catch(a){console.error("獲取股票名稱失敗:",a)}finally{R.value=!1}}},W=V(()=>o.value==="all"?l.value:o.value==="tw"?l.value.filter(a=>B(a)==="TWD"):o.value==="us"?l.value.filter(a=>B(a)==="USD"):l.value),n=V(()=>{const a={tw:{cost:0,value:0,profit:0},us:{cost:0,value:0,profit:0}};return!l.value||l.value.length===0||l.value.forEach(e=>{const $=B(e),f=e.cost*e.quantity,z=Z(e);if(!z||isNaN(z))return;const G=z*e.quantity;if($==="USD"){const ut=f*_.value,ot=G*_.value;a.us.cost+=ut,a.us.value+=ot,a.us.profit+=ot-ut}else a.tw.cost+=f,a.tw.value+=G,a.tw.profit+=G-f}),a}),q=V(()=>!n.value||!n.value.tw||!n.value.us?0:n.value.tw.cost+n.value.us.cost),X=V(()=>!n.value||!n.value.tw||!n.value.us?0:n.value.tw.value+n.value.us.value),Y=V(()=>!X.value||!q.value?0:X.value-q.value),J=V(()=>q.value===0?0:Y.value/q.value*100),E=V(()=>{if(!n.value||!n.value.tw||!n.value.us)return{tw:0,us:0};const a=n.value.tw.value||0,e=n.value.us.value||0,$=a+e;return $===0?{tw:0,us:0}:{tw:a/$*100,us:e/$*100}}),h=a=>l.value.findIndex(e=>e.symbol===a.symbol),b=()=>{try{console.log("載入持股數據..."),l.value=m()||[],w(!1)}catch(a){console.error("載入持股數據失敗",a),l.value=[]}},w=async(a=!0)=>{if(!(!l.value||l.value.length===0)){a&&(p.value=!0);try{const e=l.value.map(z=>z.symbol).filter(z=>z);if(e.length===0){p.value=!1;return}console.log("正在更新以下股票價格:",e.join(", "));const $=await Re(e);if(!$||$.length===0){console.warn("未獲取到任何股票價格數據"),p.value=!1;return}const f={};$.forEach(z=>{if(!z)return;const G=z.originalSymbol||z.symbol;G&&(f[G]=z)}),console.log("已更新價格數據:",Object.keys(f).join(", ")),c.value=f;try{localStorage.setItem("investment-tracker-prices",JSON.stringify(f))}catch(z){console.error("無法儲存價格資料到本地存儲",z)}}catch(e){console.error("更新價格出錯",e)}finally{a&&(p.value=!1)}}},U=a=>{const e=l.value[a];D.value=a,y.symbol=e.symbol,y.name=e.name,y.market=e.market,y.cost=e.cost,y.quantity=e.quantity,y.purchaseDate=e.purchaseDate||"",T.value=!0},A=a=>{k.value=a},F=()=>{k.value!==null&&(d(k.value),b(),k.value=null)},K=()=>{const a={symbol:y.symbol,name:y.name,market:y.market,cost:y.cost,quantity:y.quantity,purchaseDate:y.purchaseDate};D.value!==null?u(D.value,a):C(a),b(),D.value=null,T.value=!1,st()},it=()=>{T.value=!1,D.value=null,st()},st=()=>{y.symbol="",y.name="",y.market="台股",y.cost=0,y.quantity=0,y.purchaseDate=new Date().toISOString().split("T")[0]},M=(a,e="TWD")=>{const $=e==="USD"?"US$":"NT$",f=new Intl.NumberFormat("zh-TW",{minimumFractionDigits:0,maximumFractionDigits:0}).format(a);return`${$}${f}`},Z=a=>{if(!a||!c.value)return 0;const e=c.value[a.symbol]||c.value[`${a.symbol}.TW`]||Object.values(c.value).find($=>$&&($.originalSymbol===a.symbol||$.symbol===a.symbol||$.symbol===`${a.symbol}.TW`));return e&&e.price||0},B=a=>{if(!a)return"TWD";if(a.market==="美股")return"USD";if(c.value){const e=c.value[a.symbol]||c.value[`${a.symbol}.TW`]||Object.values(c.value).find($=>$&&($.originalSymbol===a.symbol||$.symbol===a.symbol||$.symbol===`${a.symbol}.TW`));if(e&&e.currency)return e.currency}return a.market==="美股"?"USD":"TWD"},yt=a=>{const e=Z(a);return e?`${B(a)==="USD"?"US$":"NT$"}${e.toFixed(2)}`:"載入中..."},r=a=>{if(!a||!c.value)return 0;const e=c.value[a.symbol]||c.value[`${a.symbol}.TW`]||Object.values(c.value).find($=>$&&($.originalSymbol===a.symbol||$.symbol===a.symbol||$.symbol===`${a.symbol}.TW`));return(e==null?void 0:e.change)||0},s=a=>{if(!a)return"載入中...";const e=Z(a);if(!e)return"載入中...";const $=a.cost*a.quantity,z=e*a.quantity-$,G=$>0?z/$*100:0,ut=B(a),ot=z>=0?"+":"";return`${ot}${M(z,ut)} (${ot}${G.toFixed(2)}%)`},I=(a,e)=>{if(!a||!e)return"";const $=a.cost*a.quantity,z=e*a.quantity-$;return z>0?"positive":z<0?"negative":""},x=(a,e)=>a==null?"-":`${e==="USD"?"US$":"NT$"}${a.toFixed(2)}`;return ft(async()=>{try{const a=localStorage.getItem("exchange-rate-cache");if(a){const $=JSON.parse(a);$.USD_TWD&&(_.value=$.USD_TWD,console.log(`從緩存讀取匯率: 1 USD = ${_.value} TWD`))}b();const e=await je();e&&!isNaN(e)&&(_.value=e,console.log(`設置匯率: 1 USD = ${e} TWD`),w())}catch(a){console.error("頁面初始化時發生錯誤",a)}}),(a,e)=>{var $;return v(),g("div",null,[e[34]||(e[34]=t("h2",{class:"text-xl font-bold mb-4"},"持股管理",-1)),t("div",Me,[t("div",Be,[t("div",Le,[e[12]||(e[12]=t("h3",{class:"text-gray-500 text-sm"},"總投資成本",-1)),t("p",Ye,i(M(q.value)),1)]),t("div",Je,[e[13]||(e[13]=t("h3",{class:"text-gray-500 text-sm"},"目前總市值",-1)),t("p",Ke,i(M(X.value)),1)]),t("div",Ze,[e[14]||(e[14]=t("h3",{class:"text-gray-500 text-sm"},"未實現損益",-1)),t("p",{class:j(["text-lg font-semibold",tt(ct)(Y.value)])},[at(i(Y.value>0?"+":"")+i(M(Y.value))+" ",1),t("span",He," ("+i(J.value>0?"+":"")+i(J.value.toFixed(2))+"%) ",1)],2)])])]),l.value.length>0?(v(),g("div",Xe,[t("div",Ge,[t("div",null,[e[17]||(e[17]=t("h3",{class:"text-lg font-bold mb-3"},"市場分佈",-1)),t("div",Qe,[Q(Et,{"tw-value":n.value&&n.value.tw?n.value.tw.value:0,"us-value":n.value&&n.value.us?n.value.us.value:0},null,8,["tw-value","us-value"])]),t("div",ts,[t("div",es,[e[15]||(e[15]=t("h4",{class:"text-sm text-gray-500"},"台股占比",-1)),t("p",ss,i(E.value&&E.value.tw?E.value.tw.toFixed(2):"0.00")+"% ",1)]),t("div",ls,[e[16]||(e[16]=t("h4",{class:"text-sm text-gray-500"},"美股占比",-1)),t("p",as,i(E.value&&E.value.us?E.value.us.toFixed(2):"0.00")+"% ",1)])])]),t("div",null,[e[22]||(e[22]=t("h3",{class:"text-lg font-bold mb-3"},"市場表現",-1)),t("div",os,[Q(Mt,{"tw-profit":n.value&&n.value.tw?n.value.tw.profit:0,"us-profit":n.value&&n.value.us?n.value.us.profit:0,"tw-cost":n.value&&n.value.tw?n.value.tw.cost:0,"us-cost":n.value&&n.value.us?n.value.us.cost:0},null,8,["tw-profit","us-profit","tw-cost","us-cost"])]),t("div",ns,[n.value&&n.value.tw?(v(),g("div",{key:0,class:j(["bg-gray-50 p-3 rounded-lg",tt(ct)(n.value.tw.profit)])},[e[18]||(e[18]=t("h4",{class:"text-sm text-gray-500"},"台股損益",-1)),t("p",rs,[at(i(n.value.tw.profit>0?"+":"")+i(M(n.value.tw.profit))+" ",1),t("span",is," ("+i(n.value.tw.cost>0?(n.value.tw.profit/n.value.tw.cost*100).toFixed(2)+"%":"0%")+") ",1)])],2)):(v(),g("div",us,e[19]||(e[19]=[t("h4",{class:"text-sm text-gray-500"},"台股損益",-1),t("p",{class:"font-semibold"},"NT$0",-1)]))),n.value&&n.value.us?(v(),g("div",{key:2,class:j(["bg-gray-50 p-3 rounded-lg",tt(ct)(n.value.us.profit)])},[e[20]||(e[20]=t("h4",{class:"text-sm text-gray-500"},"美股損益",-1)),t("p",cs,[at(i(n.value.us.profit>0?"+":"")+i(M(n.value.us.profit))+" ",1),t("span",ds," ("+i(n.value.us.cost>0?(n.value.us.profit/n.value.us.cost*100).toFixed(2)+"%":"0%")+") ",1)])],2)):(v(),g("div",ms,e[21]||(e[21]=[t("h4",{class:"text-sm text-gray-500"},"美股損益",-1),t("p",{class:"font-semibold"},"US$0",-1)])))])])])])):L("",!0),t("div",vs,[t("div",ps,[t("button",{onClick:e[0]||(e[0]=f=>o.value="all"),class:j(["tab-btn mr-2 px-4 py-2 rounded-lg",o.value==="all"?"bg-primary text-white":"bg-gray-100"])}," 全部持股 ",2),t("button",{onClick:e[1]||(e[1]=f=>o.value="tw"),class:j(["tab-btn mr-2 px-4 py-2 rounded-lg",o.value==="tw"?"bg-primary text-white":"bg-gray-100"])}," 台股 ",2),t("button",{onClick:e[2]||(e[2]=f=>o.value="us"),class:j(["tab-btn px-4 py-2 rounded-lg",o.value==="us"?"bg-primary text-white":"bg-gray-100"])}," 美股 ",2)]),t("div",bs,[t("button",{onClick:e[3]||(e[3]=f=>T.value=!0),class:"btn btn-primary mr-2"}," + 新增持股 "),t("div",fs,[t("span",gs,"匯率: 1 USD = "+i(_.value.toFixed(2))+" TWD",1),t("button",{onClick:w,class:"btn bg-gray-100 text-gray-700 flex items-center"},[e[23]||(e[23]=t("span",{class:"mr-1"},"更新價格",-1)),p.value?(v(),g("span",ys,"⟳")):L("",!0)])])])]),t("div",hs,[W.value.length===0?(v(),g("div",xs,i(o.value==="all"?"尚未新增持股資料，請點擊「新增持股」按鈕開始追蹤。":`尚無${o.value==="tw"?"台股":"美股"}資料。`),1)):(v(),g("div",_s,[t("table",ws,[e[24]||(e[24]=t("thead",null,[t("tr",null,[t("th",null,"代碼"),t("th",null,"名稱"),t("th",null,"市場"),t("th",null,"持有股數"),t("th",null,"成本價"),t("th",null,"目前價格"),t("th",null,"市值"),t("th",null,"損益"),t("th",null,"操作")])],-1)),t("tbody",null,[(v(!0),g(nt,null,rt(W.value,(f,z)=>(v(),g("tr",{key:z},[t("td",null,i(f.symbol),1),t("td",null,i(f.name),1),t("td",null,i(f.market),1),t("td",null,i(f.quantity),1),t("td",null,i(x(f.cost,B(f))),1),t("td",{class:j(tt(ct)(r(f)))},i(yt(f)),3),t("td",null,i(Z(f)?M(f.quantity*Z(f),B(f)):"載入中..."),1),t("td",{class:j(I(f,Z(f)))},i(s(f)),3),t("td",null,[t("div",$s,[t("button",{onClick:G=>U(h(f)),class:"text-primary text-sm"}," 編輯 ",8,ks),t("button",{onClick:G=>A(h(f)),class:"text-danger text-sm"}," 刪除 ",8,Ss)])])]))),128))])])]))]),T.value?(v(),g("div",Ds,[t("div",Cs,[t("h3",Ts,i(D.value===null?"新增持股":"編輯持股"),1),t("form",{onSubmit:Rt(K,["prevent"])},[t("div",Ps,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium mb-1"},"股票代碼",-1)),O(t("input",{"onUpdate:modelValue":e[4]||(e[4]=f=>y.symbol=f),required:"",class:"input w-full",placeholder:"例如：2330.TW 或 AAPL",onBlur:P},null,544),[[H,y.symbol]])]),t("div",qs,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium mb-1"},"股票名稱",-1)),O(t("input",{"onUpdate:modelValue":e[5]||(e[5]=f=>y.name=f),required:"",class:"input w-full",placeholder:"自動獲取，或手動輸入",disabled:R.value},null,8,Fs),[[H,y.name]]),R.value?(v(),g("div",zs," 正在獲取股票名稱... ")):L("",!0)]),t("div",Ns,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium mb-1"},"市場",-1)),O(t("select",{"onUpdate:modelValue":e[6]||(e[6]=f=>y.market=f),required:"",class:"input w-full"},e[27]||(e[27]=[t("option",{value:"台股"},"台股",-1),t("option",{value:"美股"},"美股",-1),t("option",{value:"其他"},"其他",-1)]),512),[[It,y.market]])]),t("div",Vs,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium mb-1"},"成本價",-1)),O(t("input",{"onUpdate:modelValue":e[7]||(e[7]=f=>y.cost=f),type:"number",step:"0.01",required:"",class:"input w-full",placeholder:"每股成本"},null,512),[[H,y.cost,void 0,{number:!0}]])]),t("div",Us,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium mb-1"},"持有股數",-1)),O(t("input",{"onUpdate:modelValue":e[8]||(e[8]=f=>y.quantity=f),type:"number",required:"",class:"input w-full",placeholder:"持有數量"},null,512),[[H,y.quantity,void 0,{number:!0}]])]),t("div",As,[e[31]||(e[31]=t("label",{class:"block text-sm font-medium mb-1"},"購買日期",-1)),O(t("input",{"onUpdate:modelValue":e[9]||(e[9]=f=>y.purchaseDate=f),type:"date",class:"input w-full"},null,512),[[H,y.purchaseDate]])]),t("div",{class:"flex justify-end space-x-3"},[t("button",{type:"button",onClick:it,class:"btn bg-gray-200 text-gray-800"}," 取消 "),e[32]||(e[32]=t("button",{type:"submit",class:"btn btn-primary"},"儲存",-1))])],32)])])):L("",!0),k.value!==null?(v(),g("div",js,[t("div",Rs,[e[33]||(e[33]=t("h3",{class:"text-lg font-bold mb-4"},"確認刪除",-1)),t("p",Is," 確定要刪除「"+i(($=l.value[k.value])==null?void 0:$.name)+"」的持股資料嗎？ ",1),t("div",Ws,[t("button",{onClick:e[10]||(e[10]=f=>k.value=null),class:"btn bg-gray-200 text-gray-800"}," 取消 "),t("button",{onClick:e[11]||(e[11]=f=>F()),class:"btn btn-danger"}," 確認刪除 ")])])])):L("",!0)])}}},Es={class:"card bg-white p-4 mb-6"},Ms={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Bs={class:"p-3 bg-gray-50 rounded-lg"},Ls={class:"p-3 bg-gray-50 rounded-lg"},Ys={class:"text-lg font-semibold"},Js={class:"p-3 bg-gray-50 rounded-lg"},Ks={key:0,class:"card bg-white p-4 mb-6"},Zs={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Hs={class:"h-64 flex items-center justify-center"},Xs={class:"grid grid-cols-2 gap-4 mt-3"},Gs={class:"bg-gray-50 p-3 rounded-lg"},Qs={class:"font-semibold"},tl={class:"bg-gray-50 p-3 rounded-lg"},el={class:"font-semibold"},sl={class:"h-64 flex items-center justify-center"},ll={class:"grid grid-cols-2 gap-4 mt-3"},al={class:"font-semibold"},ol={class:"text-xs"},nl={class:"font-semibold"},rl={class:"text-xs"},il={class:"flex justify-between items-center mb-4"},ul={class:"tabs"},cl={class:"card"},dl={key:0,class:"text-center py-6 text-gray-500"},ml={key:1,class:"table-container"},vl={class:"table"},pl={class:"flex space-x-2"},bl=["onClick"],fl=["onClick"],gl={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10"},yl={class:"bg-white rounded-lg p-6 max-w-md w-full"},hl={class:"text-lg font-bold mb-4"},xl={class:"mb-4"},_l={class:"mb-4"},wl=["disabled"],$l={key:0,class:"text-sm text-gray-500 mt-1"},kl={class:"mb-4"},Sl={class:"mb-4"},Dl={class:"mb-4"},Cl={class:"mb-4"},Tl={class:"mb-4"},Pl=["value"],ql={class:"mb-4"},Fl={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10"},zl={class:"bg-white rounded-lg p-6 max-w-md w-full"},Nl={class:"mb-4"},Vl={class:"flex justify-end space-x-3"},Ul={__name:"RealizedView",setup(S){mt.register(xt,vt,pt,_t,wt,$t,bt,qt,Ft);const{getRealizedTrades:m,addRealizedTrade:C,updateRealizedTrade:u,deleteRealizedTrade:d}=gt(),l=N([]),c=N(!1),T=N(null),D=N(null),k=N("all"),p=N(0),_=N(!0),o=jt({symbol:"",name:"",sellPrice:0,quantity:0,buyPrice:0,date:new Date().toISOString().split("T")[0],market:"台股"}),y=V(()=>P.value.reduce((r,s)=>r+s.profit,0)),R=V(()=>{if(P.value.length===0)return 0;const r=P.value.reduce((I,x)=>I+x.cost,0);return r===0?0:P.value.reduce((I,x)=>I+x.profit,0)/r*100}),P=V(()=>k.value==="all"?X.value:k.value==="tw"?X.value.filter(r=>W(r,"台股")):k.value==="us"?X.value.filter(r=>W(r,"美股")):X.value),W=(r,s)=>r.market?r.market===s:s==="台股"?/^\d+$/.test(r.symbol.split(".")[0]):s==="美股"?/[A-Za-z]/.test(r.symbol):!1,n=V(()=>{const r={tw:{profit:0,cost:0},us:{profit:0,cost:0}};return l.value.length===0||l.value.forEach(s=>{W(s,"台股")?(r.tw.profit+=s.profit,r.tw.cost+=s.cost):W(s,"美股")&&(r.us.profit+=s.profit,r.us.cost+=s.cost)}),r}),q=V(()=>{const r=Math.abs(n.value.tw.profit),s=Math.abs(n.value.us.profit),I=r+s;return{tw:I>0?r/I*100:0,us:I>0?s/I*100:0}}),X=V(()=>[...l.value].sort((r,s)=>new Date(s.date)-new Date(r.date))),Y=()=>{l.value=m(),p.value++,console.log("載入交易數據後更新圖表計數器:",p.value)},J=r=>l.value.findIndex(s=>s.symbol===r.symbol&&s.date===r.date&&s.profit===r.profit),E=r=>{const s=l.value[r];T.value=r,o.symbol=s.symbol,o.name=s.name,o.market=s.market||(W(s,"台股")?"台股":"美股"),o.sellPrice=s.sellPrice,o.quantity=s.quantity,o.buyPrice=s.cost/s.quantity||0,o.date=s.date,c.value=!0},h=r=>{D.value=r},b=()=>{D.value!==null&&(d(D.value),Y(),D.value=null)},w=()=>{const r=M(),I=o.sellPrice*o.quantity-r,x={symbol:o.symbol,name:o.name,market:o.market,sellPrice:o.sellPrice,quantity:o.quantity,cost:r,profit:I,date:o.date};T.value!==null?u(T.value,x):C(x),Y(),T.value=null,c.value=!1,A()},U=()=>{c.value=!1,T.value=null,A()},A=()=>{o.symbol="",o.name="",o.market="台股",o.sellPrice=0,o.quantity=0,o.buyPrice=0,o.date=new Date().toISOString().split("T")[0]},F=r=>{const s="NT$",I=new Intl.NumberFormat("zh-TW",{minimumFractionDigits:0,maximumFractionDigits:0}).format(r);return`${s}${I}`},K=r=>`NT$${r.toFixed(2)}`,it=r=>Vt(r).format("YYYY/MM/DD"),st=r=>{if(r.cost===0)return"0.00%";const s=r.profit/r.cost*100;return`${s>=0?"+":""}${s.toFixed(2)}%`},M=()=>o.buyPrice*o.quantity,Z=()=>{const r=M();return F(r)},B=N(!1),yt=async()=>{if(o.symbol){B.value=!0;try{const r=await Ot(o.symbol);r&&(o.name=r,console.log(`自動獲取股票名稱: ${o.symbol} -> ${r}`),o.symbol.includes(".TW")||/^\d{4,}[A-Za-z]?$/.test(o.symbol)?o.market="台股":/[A-Za-z]/.test(o.symbol)&&(o.market="美股"))}catch(r){console.error("獲取股票名稱失敗:",r)}finally{B.value=!1}}};return ft(()=>{Y()}),Nt(()=>{if(console.log("RealizedView 被激活, 初次掛載狀態:",_.value),_.value){_.value=!1;return}p.value++,console.log("激活時更新圖表計數器:",p.value),Y(),setTimeout(()=>{p.value++,console.log("延遲後再次更新圖表計數器:",p.value)},300)}),(r,s)=>{var I;return v(),g("div",null,[s[34]||(s[34]=t("h2",{class:"text-xl font-bold mb-4"},"已實現收益",-1)),t("div",Es,[t("div",Ms,[t("div",Bs,[s[13]||(s[13]=t("h3",{class:"text-gray-500 text-sm"},"總實現收益",-1)),t("p",{class:j(["text-lg font-semibold",y.value>=0?"positive":"negative"])},i(y.value>0?"+":"")+i(F(y.value)),3)]),t("div",Ls,[s[14]||(s[14]=t("h3",{class:"text-gray-500 text-sm"},"總交易次數",-1)),t("p",Ys,i(l.value.length)+" 次",1)]),t("div",Js,[s[15]||(s[15]=t("h3",{class:"text-gray-500 text-sm"},"平均報酬率",-1)),t("p",{class:j(["text-lg font-semibold",R.value>=0?"positive":"negative"])},i(R.value>0?"+":"")+i(R.value.toFixed(2))+"% ",3)])])]),l.value.length>0?(v(),g("div",Ks,[t("div",Zs,[t("div",null,[s[18]||(s[18]=t("h3",{class:"text-lg font-bold mb-3"},"市場分佈",-1)),t("div",Hs,[Q(Et,{"tw-value":n.value.tw.profit,"us-value":n.value.us.profit},null,8,["tw-value","us-value"])]),t("div",Xs,[t("div",Gs,[s[16]||(s[16]=t("h4",{class:"text-sm text-gray-500"},"台股占比",-1)),t("p",Qs,i(q.value.tw.toFixed(2))+"% ",1)]),t("div",tl,[s[17]||(s[17]=t("h4",{class:"text-sm text-gray-500"},"美股占比",-1)),t("p",el,i(q.value.us.toFixed(2))+"% ",1)])])]),t("div",null,[s[21]||(s[21]=t("h3",{class:"text-lg font-bold mb-3"},"市場表現",-1)),t("div",sl,[Q(Mt,{"tw-profit":n.value.tw.profit,"us-profit":n.value.us.profit,"tw-cost":n.value.tw.cost,"us-cost":n.value.us.cost},null,8,["tw-profit","us-profit","tw-cost","us-cost"])]),t("div",ll,[t("div",{class:j(["bg-gray-50 p-3 rounded-lg",n.value.tw.profit>=0?"positive":"negative"])},[s[19]||(s[19]=t("h4",{class:"text-sm text-gray-500"},"台股損益",-1)),t("p",al,[at(i(n.value.tw.profit>0?"+":"")+i(F(n.value.tw.profit))+" ",1),t("span",ol," ("+i(n.value.tw.cost>0?(n.value.tw.profit/n.value.tw.cost*100).toFixed(2)+"%":"0%")+") ",1)])],2),t("div",{class:j(["bg-gray-50 p-3 rounded-lg",n.value.us.profit>=0?"positive":"negative"])},[s[20]||(s[20]=t("h4",{class:"text-sm text-gray-500"},"美股損益",-1)),t("p",nl,[at(i(n.value.us.profit>0?"+":"")+i(F(n.value.us.profit))+" ",1),t("span",rl," ("+i(n.value.us.cost>0?(n.value.us.profit/n.value.us.cost*100).toFixed(2)+"%":"0%")+") ",1)])],2)])])])])):L("",!0),t("div",il,[t("div",ul,[t("button",{onClick:s[0]||(s[0]=x=>k.value="all"),class:j(["tab-btn mr-2 px-4 py-2 rounded-lg",k.value==="all"?"bg-primary text-white":"bg-gray-100"])}," 全部交易 ",2),t("button",{onClick:s[1]||(s[1]=x=>k.value="tw"),class:j(["tab-btn mr-2 px-4 py-2 rounded-lg",k.value==="tw"?"bg-primary text-white":"bg-gray-100"])}," 台股 ",2),t("button",{onClick:s[2]||(s[2]=x=>k.value="us"),class:j(["tab-btn px-4 py-2 rounded-lg",k.value==="us"?"bg-primary text-white":"bg-gray-100"])}," 美股 ",2)]),t("button",{onClick:s[3]||(s[3]=x=>c.value=!0),class:"btn btn-primary"}," + 新增已實現收益 ")]),t("div",cl,[P.value.length===0?(v(),g("div",dl,i(k.value==="all"?"尚未新增已實現收益資料，請點擊「新增已實現收益」按鈕進行新增。":`尚無${k.value==="tw"?"台股":"美股"}已實現交易資料。`),1)):(v(),g("div",ml,[t("table",vl,[s[22]||(s[22]=t("thead",null,[t("tr",null,[t("th",null,"日期"),t("th",null,"代碼"),t("th",null,"名稱"),t("th",null,"市場"),t("th",null,"賣出價格"),t("th",null,"數量"),t("th",null,"總成本"),t("th",null,"實現損益"),t("th",null,"報酬率"),t("th",null,"操作")])],-1)),t("tbody",null,[(v(!0),g(nt,null,rt(P.value,(x,a)=>(v(),g("tr",{key:a},[t("td",null,i(it(x.date)),1),t("td",null,i(x.symbol),1),t("td",null,i(x.name),1),t("td",null,i(x.market||(W(x,"台股")?"台股":"美股")),1),t("td",null,i(K(x.sellPrice)),1),t("td",null,i(x.quantity),1),t("td",null,i(F(x.cost)),1),t("td",{class:j(x.profit>=0?"positive":"negative")},i(x.profit>0?"+":"")+i(F(x.profit)),3),t("td",{class:j(x.profit>=0?"positive":"negative")},i(st(x)),3),t("td",null,[t("div",pl,[t("button",{onClick:e=>E(J(x)),class:"text-primary text-sm"}," 編輯 ",8,bl),t("button",{onClick:e=>h(J(x)),class:"text-danger text-sm"}," 刪除 ",8,fl)])])]))),128))])])]))]),c.value?(v(),g("div",gl,[t("div",yl,[t("h3",hl,i(T.value===null?"新增已實現收益":"編輯已實現收益"),1),t("form",{onSubmit:Rt(w,["prevent"])},[t("div",xl,[s[23]||(s[23]=t("label",{class:"block text-sm font-medium mb-1"},"股票代碼",-1)),O(t("input",{"onUpdate:modelValue":s[4]||(s[4]=x=>o.symbol=x),required:"",class:"input w-full",placeholder:"例如：2330.TW 或 AAPL",onBlur:yt},null,544),[[H,o.symbol]])]),t("div",_l,[s[24]||(s[24]=t("label",{class:"block text-sm font-medium mb-1"},"股票名稱",-1)),O(t("input",{"onUpdate:modelValue":s[5]||(s[5]=x=>o.name=x),required:"",class:"input w-full",placeholder:"自動獲取，或手動輸入",disabled:B.value},null,8,wl),[[H,o.name]]),B.value?(v(),g("div",$l," 正在獲取股票名稱... ")):L("",!0)]),t("div",kl,[s[26]||(s[26]=t("label",{class:"block text-sm font-medium mb-1"},"市場",-1)),O(t("select",{"onUpdate:modelValue":s[6]||(s[6]=x=>o.market=x),required:"",class:"input w-full"},s[25]||(s[25]=[t("option",{value:"台股"},"台股",-1),t("option",{value:"美股"},"美股",-1),t("option",{value:"其他"},"其他",-1)]),512),[[It,o.market]])]),t("div",Sl,[s[27]||(s[27]=t("label",{class:"block text-sm font-medium mb-1"},"賣出價格",-1)),O(t("input",{"onUpdate:modelValue":s[7]||(s[7]=x=>o.sellPrice=x),type:"number",step:"0.01",required:"",class:"input w-full",placeholder:"每股賣出價格"},null,512),[[H,o.sellPrice,void 0,{number:!0}]])]),t("div",Dl,[s[28]||(s[28]=t("label",{class:"block text-sm font-medium mb-1"},"數量",-1)),O(t("input",{"onUpdate:modelValue":s[8]||(s[8]=x=>o.quantity=x),type:"number",required:"",class:"input w-full",placeholder:"賣出數量"},null,512),[[H,o.quantity,void 0,{number:!0}]])]),t("div",Cl,[s[29]||(s[29]=t("label",{class:"block text-sm font-medium mb-1"},"買入價格",-1)),O(t("input",{"onUpdate:modelValue":s[9]||(s[9]=x=>o.buyPrice=x),type:"number",step:"0.01",required:"",class:"input w-full",placeholder:"每股買入價格"},null,512),[[H,o.buyPrice,void 0,{number:!0}]])]),t("div",Tl,[s[30]||(s[30]=t("label",{class:"block text-sm font-medium mb-1"},"總成本",-1)),t("input",{value:Z(),type:"number",step:"0.01",disabled:"",class:"input w-full bg-gray-100"},null,8,Pl)]),t("div",ql,[s[31]||(s[31]=t("label",{class:"block text-sm font-medium mb-1"},"賣出日期",-1)),O(t("input",{"onUpdate:modelValue":s[10]||(s[10]=x=>o.date=x),type:"date",required:"",class:"input w-full"},null,512),[[H,o.date]])]),t("div",{class:"flex justify-end space-x-3"},[t("button",{type:"button",onClick:U,class:"btn bg-gray-200 text-gray-800"}," 取消 "),s[32]||(s[32]=t("button",{type:"submit",class:"btn btn-primary"},"儲存",-1))])],32)])])):L("",!0),D.value!==null?(v(),g("div",Fl,[t("div",zl,[s[33]||(s[33]=t("h3",{class:"text-lg font-bold mb-4"},"確認刪除",-1)),t("p",Nl," 確定要刪除「"+i((I=l.value[D.value])==null?void 0:I.name)+"」的已實現收益資料嗎？ ",1),t("div",Vl,[t("button",{onClick:s[11]||(s[11]=x=>D.value=null),class:"btn bg-gray-200 text-gray-800"}," 取消 "),t("button",{onClick:s[12]||(s[12]=x=>b()),class:"btn btn-danger"}," 確認刪除 ")])])])):L("",!0)])}}},Al=[{path:"/",component:Os},{path:"/realized",component:Ul},{path:"/charts",component:Ae}],jl=Qt({history:te(),routes:Al}),Bt=ee(me);Bt.use(jl);Bt.mount("#app");
